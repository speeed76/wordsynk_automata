
2025-05-18 15:56:55 [INFO] --- Starting Booking Crawler Application --- (main.py:9)
2025-05-18 15:56:55 [INFO] Initializing Crawler Service... (crawler_service.py:36)
2025-05-18 15:56:55 [INFO] Database connection established to: /Users/pawelgiers/development/wordsynk_automata/bookings.db (connection.py:58)
2025-05-18 15:56:55 [DEBUG] Enabled WAL journal mode. (connection.py:63)
2025-05-18 15:56:55 [DEBUG] Table 'bookings' not found, creating now... (connection.py:23)
2025-05-18 15:56:55 [INFO] Table 'bookings' created successfully. (connection.py:25)
2025-05-18 15:56:55 [DEBUG] Table 'multiday_headers' not found, creating now... (connection.py:23)
2025-05-18 15:56:55 [INFO] Table 'multiday_headers' created successfully. (connection.py:25)
2025-05-18 15:56:55 [DEBUG] Table 'bookings_scrape' not found, creating now... (connection.py:23)
2025-05-18 15:56:55 [INFO] Table 'bookings_scrape' created successfully. (connection.py:25)
2025-05-18 15:56:55 [DEBUG] Table creation/check complete. (connection.py:78)
2025-05-18 15:56:55 [INFO] Database initialized. (crawler_service.py:38)
2025-05-18 15:56:55 [INFO] Attempting to start Appium session with pre-configured AppiumOptions... (crawler_service.py:42)
2025-05-18 15:56:59 [INFO] Appium session started. (crawler_service.py:48)
2025-05-18 15:56:59 [INFO] Detected displays: {'hwc_display_0': '4619827259835644672'} (display_manager.py:63)
2025-05-18 15:56:59 [INFO] Only one display detected (ID: 4619827259835644672). Using that. (display_manager.py:131)
2025-05-18 15:56:59 [INFO] Updating Appium settings to target display ID: 4619827259835644672 (crawler_service.py:57)
2025-05-18 15:57:00 [INFO] XML Dumper initialized. Dumps will be saved in: xml_capture_base (xml_dumper.py:29)
2025-05-18 15:57:00 [INFO] XML DUMP MODE IS ENABLED. XML files will be saved to 'xml_capture_base' (crawler_service.py:71)
2025-05-18 15:57:00 [INFO] Page objects initialized. (crawler_service.py:76)
2025-05-18 15:57:00 [INFO] Created new scrape session 1 (manager.py:71)
2025-05-18 15:57:00 [INFO] State manager initialized. Session: 1, Current state: NAVIGATING_TO_LIST (crawler_service.py:80)
2025-05-18 15:57:00 [INFO] Processors initialized. (crawler_service.py:87)
2025-05-18 15:57:00 [INFO] Crawler Service initialized successfully. (crawler_service.py:88)
2025-05-18 15:57:00 [INFO] Starting crawler run loop (targeting display: 4619827259835644672)... (crawler_service.py:142)
2025-05-18 15:57:00 [INFO] --- Executing State: NAVIGATING_TO_LIST (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:57:00 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:00 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: None) (manager.py:111)
2025-05-18 15:57:00 [INFO] Successfully navigated to list page. (crawler_service.py:158)
2025-05-18 15:57:00 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 15:57:00 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 15:57:00 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_155700_186362.xml (xml_dumper.py:65)
2025-05-18 15:57:00 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:00 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:57:00 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:00 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:57:00 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:57:00 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:57:00 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:57:00 [DEBUG] Processing content-desc: 'MJA00321853, WN4 8SH, 14:30 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:00 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00321853, WN4 8SH, 14:30 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00321853): Extracted MJA ID. Original full desc: 'MJA00321853, WN4 8SH, 14:30 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00321853): Parts after MJA ID: ['WN4 8SH', '14:30 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00321853): Found Duration in part '14:30 to 16:00' (mja_parser.py:72)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00321853): Found Postcode in part 'WN4 8SH' -> WN4 8SH (mja_parser.py:90)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00321853): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:00 [INFO] MJA Parse (MJA00321853): Final parsed data: {'booking_id': 'MJA00321853', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'WN4 8SH', 'start_time_raw': '14:30', 'end_time_raw': '16:00', 'calculated_duration_str': '01:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '14:30 to 16:00'} (mja_parser.py:112)
2025-05-18 15:57:00 [DEBUG] Successfully parsed card: MJA00321853, Status: Normal (list_page.py:83)
2025-05-18 15:57:00 [DEBUG] Processing content-desc: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 15:57:00 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00300916): Extracted MJA ID. Original full desc: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00300916): Parts after MJA ID: ['CH7 1AE', '09:30 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00300916): Found Duration in part '09:30 to 11:30' (mja_parser.py:72)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00300916): Found Postcode in part 'CH7 1AE' -> CH7 1AE (mja_parser.py:90)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00300916): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:00 [INFO] MJA Parse (MJA00300916): Final parsed data: {'booking_id': 'MJA00300916', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'CH7 1AE', 'start_time_raw': '09:30', 'end_time_raw': '11:30', 'calculated_duration_str': '02:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 11:30'} (mja_parser.py:112)
2025-05-18 15:57:00 [DEBUG] Successfully parsed card: MJA00300916, Status: Normal (list_page.py:83)
2025-05-18 15:57:00 [DEBUG] Processing content-desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:00 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00306282): Extracted MJA ID. Original full desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00306282): Parts after MJA ID: ['BD1 1LA', '09:30 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00306282): Found Duration in part '09:30 to 17:00' (mja_parser.py:72)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00306282): Found Postcode in part 'BD1 1LA' -> BD1 1LA (mja_parser.py:90)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00306282): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:00 [INFO] MJA Parse (MJA00306282): Final parsed data: {'booking_id': 'MJA00306282', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'BD1 1LA', 'start_time_raw': '09:30', 'end_time_raw': '17:00', 'calculated_duration_str': '07:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 17:00'} (mja_parser.py:112)
2025-05-18 15:57:00 [DEBUG] Successfully parsed card: MJA00306282, Status: Normal (list_page.py:83)
2025-05-18 15:57:00 [DEBUG] Processing content-desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:00 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00309647): Extracted MJA ID. Original full desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00309647): Parts after MJA ID: ['11:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00309647): Found Duration in part '11:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00309647): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:57:00 [DEBUG] MJA Parse (MJA00309647): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:00 [INFO] MJA Parse (MJA00309647): Final parsed data: {'booking_id': 'MJA00309647', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '11:00', 'end_time_raw': '12:00', 'calculated_duration_str': '01:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '11:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:57:00 [DEBUG] Successfully parsed card: MJA00309647, Status: Normal (list_page.py:83)
2025-05-18 15:57:00 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:57:00 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:57:00 [DEBUG] Evaluating Card MJA: MJA00321853, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:00 [DEBUG] Card MJA00321853 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:57:00 [DEBUG] Evaluating Card MJA: MJA00300916, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:00 [DEBUG] Card MJA00300916 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:57:00 [DEBUG] Evaluating Card MJA: MJA00306282, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:00 [DEBUG] Card MJA00306282 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:57:00 [DEBUG] Evaluating Card MJA: MJA00309647, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:00 [DEBUG] Card MJA00309647 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:57:00 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:57:00 [INFO] Found 4 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:57:00 [DEBUG] Visibility check for element at y=776, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:00 [DEBUG] Visibility check for element at y=1321, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:01 [DEBUG] Visibility check for element at y=1939, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:01 [DEBUG] Visibility check for element at y=2556, h=200: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:01 [ERROR] Error locating element for MJA00309647: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:57:01 [INFO] Selected card MJA00300916 (Status: Normal) to click. (list_processor.py:130)
2025-05-18 15:57:01 [INFO] Inserted/Updated base booking record for MJA00300916 with card_status: Normal, db_status: pending (repository.py:75)
2025-05-18 15:57:01 [DEBUG] State updated to SECONDARY for session 1 (MJA: MJA00300916, MJR: None, LastProcMJA: MJA00300916) (manager.py:111)
2025-05-18 15:57:01 [INFO] Attempting click on selected card MJA00300916 (list_processor.py:256)
2025-05-18 15:57:01 [INFO] Clicked card MJA00300916 (list_processor.py:258)
2025-05-18 15:57:03 [DEBUG] Processor for LIST finished. State Manager Current State: SECONDARY (crawler_service.py:198)
2025-05-18 15:57:03 [INFO] --- Executing State: SECONDARY (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:57:03 [INFO] Processing State: SECONDARY (Display 4619827259835644672, MJA: MJA00300916) (secondary_processor.py:95)
2025-05-18 15:57:03 [DEBUG] Secondary page title is displayed. (secondary_page.py:42)
2025-05-18 15:57:03 [INFO] Confirmed on Secondary Page. (secondary_processor.py:90)
2025-05-18 15:57:03 [DEBUG] --- Parsing Secondary Page XML Targeting Specific Attributes --- (secondary_parser.py:33)
2025-05-18 15:57:03 [DEBUG]   Found MJR content-desc: "MJR00225953, Face To Face, Appointments : 1" (secondary_parser.py:48)
2025-05-18 15:57:03 [DEBUG]     Extracted MJR ID: MJR00225953 (secondary_parser.py:49)
2025-05-18 15:57:03 [DEBUG]     Extracted Type Hint: Face To Face (secondary_parser.py:61)
2025-05-18 15:57:03 [DEBUG]     Extracted Appt Count: 1 (secondary_parser.py:69)
2025-05-18 15:57:03 [DEBUG]   Found MJB ID in text: MJB00237288 (secondary_parser.py:90)
2025-05-18 15:57:03 [DEBUG] --- Secondary Page Targeted Extraction Finished: {'mjb_id_raw': 'MJB00237288', 'mjr_id_raw': 'MJR00225953', 'appointment_count_hint': 1, 'type_hint_raw': 'Face To Face'} --- (secondary_parser.py:98)
2025-05-18 15:57:03 [INFO] Saved XML dump: xml_capture_base/MJA00300916/Secondary/Secondary_MJA00300916_MJB00237288_20250518_155703_718290.xml (xml_dumper.py:65)
2025-05-18 15:57:03 [INFO] Extracted from Secondary XML -> MJB: MJB00237288, MJR: MJR00225953, Appt Count: 1, Type Hint: Face To Face (secondary_processor.py:130)
2025-05-18 15:57:03 [INFO] Updated secondary IDs & hints for MJA MJA00300916 (MJR set to MJR00225953) (repository.py:124)
2025-05-18 15:57:03 [DEBUG] Attempting to click MJR link element using XPath: //android.view.ViewGroup[@content-desc and starts-with(@content-desc, "MJR00225953")] (secondary_page.py:99)
2025-05-18 15:57:03 [DEBUG] Clicked MJR link element for MJR00225953. (secondary_page.py:105)
2025-05-18 15:57:05 [DEBUG] State updated to DETAIL for session 1 (MJA: MJA00300916, MJR: MJR00225953, LastProcMJA: MJA00300916) (manager.py:111)
2025-05-18 15:57:05 [DEBUG] Processor for SECONDARY finished. State Manager Current State: DETAIL (crawler_service.py:198)
2025-05-18 15:57:05 [INFO] --- Executing State: DETAIL (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:57:05 [INFO] Processing State: DETAIL (Display 4619827259835644672, MJA_trigger: MJA00300916, MJR: MJR00225953) (detail_processor.py:94)
2025-05-18 15:57:05 [DEBUG] Waiting up to 10s for detail page title: 'Booking #MJR' (detail_page.py:50)
2025-05-18 15:57:06 [DEBUG] Detail page title is displayed. (detail_page.py:55)
2025-05-18 15:57:06 [INFO] Successfully confirmed on Detail Page for MJR MJR00225953 (detail_processor.py:98)
2025-05-18 15:57:06 [DEBUG] Header Results: MJR='MJR00225953', Total='£ 108.17', MultiDay=False, LangIdx=4, DateTimeTuple='('19-05-2025 At', '09:30 - 11:30')' (detail_parser.py:129)
2025-05-18 15:57:06 [INFO] Processing Detail for MJR: 'MJR00225953', IsMultiday=False (detail_processor.py:144)
2025-05-18 15:57:06 [INFO] Saved XML dump: xml_capture_base/MJR00225953/Detail_MJR/Detail_MJR_MJR00225953_initial_view_00_20250518_155706_894464.xml (xml_dumper.py:65)
2025-05-18 15:57:06 [DEBUG] Info block scan range: 5 to 12. Processing 7 items: ['Mold Crown Court', 'Mold Crown Court', 'County Civic Centre Mold Wales CH7 1AE', 'Crime - Crown Court | Sentence', 'Sophie Edwards', '01352 707340', '82.38 Miles'] (detail_parser.py:147)
2025-05-18 15:57:06 [DEBUG]   Client Name: 'Mold Crown Court' (detail_parser.py:154)
2025-05-18 15:57:06 [DEBUG]   Address L1: 'Mold Crown Court', L2: 'County Civic Centre Mold Wales CH7 1AE' (detail_parser.py:173)
2025-05-18 15:57:06 [DEBUG]   Booking Type: 'Crime - Crown Court | Sentence' (detail_parser.py:184)
2025-05-18 15:57:06 [DEBUG]   Contact Name: 'Sophie Edwards' (detail_parser.py:190)
2025-05-18 15:57:06 [DEBUG]   Contact Phone: '01352 707340' (detail_parser.py:196)
2025-05-18 15:57:06 [DEBUG]   Distance: '82.38 Miles' (detail_parser.py:200)
2025-05-18 15:57:06 [DEBUG] Finished parsing info block: {'language_pair_raw': 'English to Polish', 'client_name_raw': 'Mold Crown Court', 'address_line1_raw': 'Mold Crown Court', 'address_line2_raw': 'County Civic Centre Mold Wales CH7 1AE', 'booking_type_raw': 'Crime - Crown Court | Sentence', 'contact_name_raw': 'Sophie Edwards', 'contact_phone_raw': '01352 707340', 'distance_raw': '82.38 Miles', 'meeting_link_raw': None} (detail_parser.py:208)
2025-05-18 15:57:06 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:57:06 [DEBUG]   Extracting payments for MJA MJA00300916 (text index 15) up to text index 27 (detail_parser.py:268)
2025-05-18 15:57:06 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:57:06 [INFO] Skipping scroll loop: Disclaimer visible initially or all expected MJA blocks for multiday found. (detail_processor.py:196)
2025-05-18 15:57:07 [INFO] Consolidating all extracted data... (detail_processor.py:209)
2025-05-18 15:57:07 [DEBUG] --- Consolidating and Parsing Detail Data --- (detail_parser.py:333)
2025-05-18 15:57:07 [DEBUG] Final Parsed Detail Data (keys: ['is_multiday', 'mjr_id', 'header_total', 'booking_date', 'start_time', 'end_time', 'duration', 'multiday_date_range', 'multiday_appointment_info', 'mja_id', 'language_pair', 'client_name', 'booking_type', 'contact_name', 'contact_phone', 'meeting_link', 'address', 'travel_distance', 'overall_total', 'notes', 'multiday_payments', 'day_pay_sl', 'day_pay_td', 'day_pay_tt', 'day_pay_aep', 'day_pay_ooh', 'day_pay_urg', 'day_total']) for MJR MJR00225953 (detail_parser.py:483)
2025-05-18 15:57:07 [DEBUG] Final Parsed MJR Data for MJR00225953 (is_multiday: False): {'is_multiday': 0, 'mjr_id': 'MJR00225953', 'header_total': 108.17, 'booking_date': '19-05-2025', 'start_time': '09:30:00', 'end_time': '11:30:00', 'duration': '02:00', 'multiday_date_range': None, 'multiday_appointment_info': None, 'mja_id': 'MJA00300916', 'language_pair': 'English to Polish', 'client_name': 'Mold Crown Court', 'booking_type': 'Crime - Crown Court | Sentence', 'contact_name': 'Sophie Edwards', 'contact_phone': '01352 707340', 'meeting_link': None, 'address': 'Mold Crown Court\nCounty Civic Centre Mold Wales CH7 1AE', 'travel_distance': 82.38, 'overall_total': 108.17, 'notes': None, 'multiday_payments': None, 'day_pay_sl': 52.0, 'day_pay_td': 30.96, 'day_pay_tt': 10.21, 'day_pay_aep': 15.0, 'day_pay_ooh': None, 'day_pay_urg': None, 'day_total': 108.17000000000002}... (detail_processor.py:218)
2025-05-18 15:57:07 [INFO] Processing SINGLE DAY save for MJA: MJA00300916 (MJR: MJR00225953) (detail_processor.py:278)
2025-05-18 15:57:07 [INFO] Saved/Updated details for booking MJA MJA00300916 (MJR: MJR00225953) (repository.py:189)
2025-05-18 15:57:07 [INFO] Navigating back to list page (Detail -> Secondary -> List)... (detail_processor.py:50)
2025-05-18 15:57:07 [DEBUG] Executing first back() command. (detail_processor.py:51)
2025-05-18 15:57:08 [DEBUG] Executing second back() command. (detail_processor.py:52)
2025-05-18 15:57:09 [INFO] Navigation successful: Confirmed back on list page. (detail_processor.py:55)
2025-05-18 15:57:09 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00300916) (manager.py:111)
2025-05-18 15:57:09 [DEBUG] Processor for DETAIL finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:57:10 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 15:57:10 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 15:57:10 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_155710_582140.xml (xml_dumper.py:65)
2025-05-18 15:57:10 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:10 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:57:10 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:10 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:57:10 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:57:10 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:57:10 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:57:10 [DEBUG] Processing content-desc: 'MJA00321853, WN4 8SH, 14:30 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:10 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00321853, WN4 8SH, 14:30 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00321853): Extracted MJA ID. Original full desc: 'MJA00321853, WN4 8SH, 14:30 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00321853): Parts after MJA ID: ['WN4 8SH', '14:30 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00321853): Found Duration in part '14:30 to 16:00' (mja_parser.py:72)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00321853): Found Postcode in part 'WN4 8SH' -> WN4 8SH (mja_parser.py:90)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00321853): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:10 [INFO] MJA Parse (MJA00321853): Final parsed data: {'booking_id': 'MJA00321853', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'WN4 8SH', 'start_time_raw': '14:30', 'end_time_raw': '16:00', 'calculated_duration_str': '01:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '14:30 to 16:00'} (mja_parser.py:112)
2025-05-18 15:57:10 [DEBUG] Successfully parsed card: MJA00321853, Status: Normal (list_page.py:83)
2025-05-18 15:57:10 [DEBUG] Processing content-desc: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 15:57:10 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00300916): Extracted MJA ID. Original full desc: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00300916): Parts after MJA ID: ['CH7 1AE', '09:30 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00300916): Found Duration in part '09:30 to 11:30' (mja_parser.py:72)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00300916): Found Postcode in part 'CH7 1AE' -> CH7 1AE (mja_parser.py:90)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00300916): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:10 [INFO] MJA Parse (MJA00300916): Final parsed data: {'booking_id': 'MJA00300916', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'CH7 1AE', 'start_time_raw': '09:30', 'end_time_raw': '11:30', 'calculated_duration_str': '02:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 11:30'} (mja_parser.py:112)
2025-05-18 15:57:10 [DEBUG] Successfully parsed card: MJA00300916, Status: Normal (list_page.py:83)
2025-05-18 15:57:10 [DEBUG] Processing content-desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:10 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00306282): Extracted MJA ID. Original full desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00306282): Parts after MJA ID: ['BD1 1LA', '09:30 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00306282): Found Duration in part '09:30 to 17:00' (mja_parser.py:72)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00306282): Found Postcode in part 'BD1 1LA' -> BD1 1LA (mja_parser.py:90)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00306282): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:10 [INFO] MJA Parse (MJA00306282): Final parsed data: {'booking_id': 'MJA00306282', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'BD1 1LA', 'start_time_raw': '09:30', 'end_time_raw': '17:00', 'calculated_duration_str': '07:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 17:00'} (mja_parser.py:112)
2025-05-18 15:57:10 [DEBUG] Successfully parsed card: MJA00306282, Status: Normal (list_page.py:83)
2025-05-18 15:57:10 [DEBUG] Processing content-desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:10 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00309647): Extracted MJA ID. Original full desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00309647): Parts after MJA ID: ['11:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00309647): Found Duration in part '11:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00309647): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:57:10 [DEBUG] MJA Parse (MJA00309647): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:10 [INFO] MJA Parse (MJA00309647): Final parsed data: {'booking_id': 'MJA00309647', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '11:00', 'end_time_raw': '12:00', 'calculated_duration_str': '01:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '11:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:57:10 [DEBUG] Successfully parsed card: MJA00309647, Status: Normal (list_page.py:83)
2025-05-18 15:57:10 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:57:10 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:57:10 [DEBUG] Evaluating Card MJA: MJA00321853, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:10 [DEBUG] Card MJA00321853 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:57:10 [DEBUG] Evaluating Card MJA: MJA00300916, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:10 [DEBUG] Card MJA00300916 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:57:10 [DEBUG] Visibility check for element at y=1321, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:10 [DEBUG] Evaluating Card MJA: MJA00306282, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:10 [DEBUG] Card MJA00306282 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:57:10 [DEBUG] Evaluating Card MJA: MJA00309647, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:10 [DEBUG] Card MJA00309647 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:57:10 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:57:10 [INFO] Found 3 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:57:10 [DEBUG] Visibility check for element at y=776, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:11 [DEBUG] Visibility check for element at y=1939, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:11 [DEBUG] Visibility check for element at y=2556, h=200: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:11 [ERROR] Error locating element for MJA00309647: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:57:11 [INFO] Selected card MJA00321853 (Status: Normal) to click. (list_processor.py:130)
2025-05-18 15:57:11 [INFO] Inserted/Updated base booking record for MJA00321853 with card_status: Normal, db_status: pending (repository.py:75)
2025-05-18 15:57:11 [DEBUG] State updated to SECONDARY for session 1 (MJA: MJA00321853, MJR: None, LastProcMJA: MJA00321853) (manager.py:111)
2025-05-18 15:57:11 [INFO] Attempting click on selected card MJA00321853 (list_processor.py:256)
2025-05-18 15:57:11 [INFO] Clicked card MJA00321853 (list_processor.py:258)
2025-05-18 15:57:12 [DEBUG] Processor for LIST finished. State Manager Current State: SECONDARY (crawler_service.py:198)
2025-05-18 15:57:13 [INFO] --- Executing State: SECONDARY (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:57:13 [INFO] Processing State: SECONDARY (Display 4619827259835644672, MJA: MJA00321853) (secondary_processor.py:95)
2025-05-18 15:57:13 [DEBUG] Secondary page title is displayed. (secondary_page.py:42)
2025-05-18 15:57:13 [INFO] Confirmed on Secondary Page. (secondary_processor.py:90)
2025-05-18 15:57:13 [DEBUG] --- Parsing Secondary Page XML Targeting Specific Attributes --- (secondary_parser.py:33)
2025-05-18 15:57:13 [DEBUG]   Found MJR content-desc: "MJR00243420, Face To Face, Appointments : 1" (secondary_parser.py:48)
2025-05-18 15:57:13 [DEBUG]     Extracted MJR ID: MJR00243420 (secondary_parser.py:49)
2025-05-18 15:57:13 [DEBUG]     Extracted Type Hint: Face To Face (secondary_parser.py:61)
2025-05-18 15:57:13 [DEBUG]     Extracted Appt Count: 1 (secondary_parser.py:69)
2025-05-18 15:57:13 [DEBUG]   Found MJB ID in text: MJB00255317 (secondary_parser.py:90)
2025-05-18 15:57:13 [DEBUG] --- Secondary Page Targeted Extraction Finished: {'mjb_id_raw': 'MJB00255317', 'mjr_id_raw': 'MJR00243420', 'appointment_count_hint': 1, 'type_hint_raw': 'Face To Face'} --- (secondary_parser.py:98)
2025-05-18 15:57:13 [INFO] Saved XML dump: xml_capture_base/MJA00321853/Secondary/Secondary_MJA00321853_MJB00255317_20250518_155713_290909.xml (xml_dumper.py:65)
2025-05-18 15:57:13 [INFO] Extracted from Secondary XML -> MJB: MJB00255317, MJR: MJR00243420, Appt Count: 1, Type Hint: Face To Face (secondary_processor.py:130)
2025-05-18 15:57:13 [INFO] Updated secondary IDs & hints for MJA MJA00321853 (MJR set to MJR00243420) (repository.py:124)
2025-05-18 15:57:13 [DEBUG] Attempting to click MJR link element using XPath: //android.view.ViewGroup[@content-desc and starts-with(@content-desc, "MJR00243420")] (secondary_page.py:99)
2025-05-18 15:57:13 [DEBUG] Clicked MJR link element for MJR00243420. (secondary_page.py:105)
2025-05-18 15:57:15 [DEBUG] State updated to DETAIL for session 1 (MJA: MJA00321853, MJR: MJR00243420, LastProcMJA: MJA00321853) (manager.py:111)
2025-05-18 15:57:15 [DEBUG] Processor for SECONDARY finished. State Manager Current State: DETAIL (crawler_service.py:198)
2025-05-18 15:57:15 [INFO] --- Executing State: DETAIL (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:57:15 [INFO] Processing State: DETAIL (Display 4619827259835644672, MJA_trigger: MJA00321853, MJR: MJR00243420) (detail_processor.py:94)
2025-05-18 15:57:15 [DEBUG] Waiting up to 10s for detail page title: 'Booking #MJR' (detail_page.py:50)
2025-05-18 15:57:16 [DEBUG] Detail page title is displayed. (detail_page.py:55)
2025-05-18 15:57:16 [INFO] Successfully confirmed on Detail Page for MJR MJR00243420 (detail_processor.py:98)
2025-05-18 15:57:16 [DEBUG] Header Results: MJR='MJR00243420', Total='£ 62.19', MultiDay=False, LangIdx=4, DateTimeTuple='('19-05-2025 At', '14:30 - 16:00')' (detail_parser.py:129)
2025-05-18 15:57:16 [INFO] Processing Detail for MJR: 'MJR00243420', IsMultiday=False (detail_processor.py:144)
2025-05-18 15:57:16 [INFO] Saved XML dump: xml_capture_base/MJR00243420/Detail_MJR/Detail_MJR_MJR00243420_initial_view_00_20250518_155716_622977.xml (xml_dumper.py:65)
2025-05-18 15:57:16 [DEBUG] Info block scan range: 5 to 12. Processing 7 items: ['Cafcass Manchester (132)', '212 Bolton Road', 'Wigan England WN4 8SH', 'Cafcass | Interview', 'Claire Halstead', '07785 571035', '46.81 Miles'] (detail_parser.py:147)
2025-05-18 15:57:16 [DEBUG]   Client Name: 'Cafcass Manchester (132)' (detail_parser.py:154)
2025-05-18 15:57:16 [DEBUG]   Address L1: '212 Bolton Road', L2: 'Wigan England WN4 8SH' (detail_parser.py:173)
2025-05-18 15:57:16 [DEBUG]   Booking Type: 'Cafcass | Interview' (detail_parser.py:184)
2025-05-18 15:57:16 [DEBUG]   Contact Name: 'Claire Halstead' (detail_parser.py:190)
2025-05-18 15:57:16 [DEBUG]   Contact Phone: '07785 571035' (detail_parser.py:196)
2025-05-18 15:57:16 [DEBUG]   Distance: '46.81 Miles' (detail_parser.py:200)
2025-05-18 15:57:16 [DEBUG] Finished parsing info block: {'language_pair_raw': 'English to Polish', 'client_name_raw': 'Cafcass Manchester (132)', 'address_line1_raw': '212 Bolton Road', 'address_line2_raw': 'Wigan England WN4 8SH', 'booking_type_raw': 'Cafcass | Interview', 'contact_name_raw': 'Claire Halstead', 'contact_phone_raw': '07785 571035', 'distance_raw': '46.81 Miles', 'meeting_link_raw': None} (detail_parser.py:208)
2025-05-18 15:57:16 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:57:16 [DEBUG]   Extracting payments for MJA MJA00321853 (text index 15) up to text index 27 (detail_parser.py:268)
2025-05-18 15:57:16 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:57:16 [INFO] Skipping scroll loop: Disclaimer visible initially or all expected MJA blocks for multiday found. (detail_processor.py:196)
2025-05-18 15:57:16 [INFO] Consolidating all extracted data... (detail_processor.py:209)
2025-05-18 15:57:16 [DEBUG] --- Consolidating and Parsing Detail Data --- (detail_parser.py:333)
2025-05-18 15:57:16 [DEBUG] Final Parsed Detail Data (keys: ['is_multiday', 'mjr_id', 'header_total', 'booking_date', 'start_time', 'end_time', 'duration', 'multiday_date_range', 'multiday_appointment_info', 'mja_id', 'language_pair', 'client_name', 'booking_type', 'contact_name', 'contact_phone', 'meeting_link', 'address', 'travel_distance', 'overall_total', 'notes', 'multiday_payments', 'day_pay_sl', 'day_pay_td', 'day_pay_tt', 'day_pay_aep', 'day_pay_ooh', 'day_pay_urg', 'day_total']) for MJR MJR00243420 (detail_parser.py:483)
2025-05-18 15:57:16 [DEBUG] Final Parsed MJR Data for MJR00243420 (is_multiday: False): {'is_multiday': 0, 'mjr_id': 'MJR00243420', 'header_total': 62.19, 'booking_date': '19-05-2025', 'start_time': '14:30:00', 'end_time': '16:00:00', 'duration': '01:30', 'multiday_date_range': None, 'multiday_appointment_info': None, 'mja_id': 'MJA00321853', 'language_pair': 'English to Polish', 'client_name': 'Cafcass Manchester (132)', 'booking_type': 'Cafcass | Interview', 'contact_name': 'Claire Halstead', 'contact_phone': '07785 571035', 'meeting_link': None, 'address': '212 Bolton Road\nWigan England WN4 8SH', 'travel_distance': 46.81, 'overall_total': 62.19, 'notes': None, 'multiday_payments': None, 'day_pay_sl': 30.0, 'day_pay_td': 16.72, 'day_pay_tt': 0.47, 'day_pay_aep': 15.0, 'day_pay_ooh': None, 'day_pay_urg': None, 'day_total': 62.19}... (detail_processor.py:218)
2025-05-18 15:57:16 [INFO] Processing SINGLE DAY save for MJA: MJA00321853 (MJR: MJR00243420) (detail_processor.py:278)
2025-05-18 15:57:16 [INFO] Saved/Updated details for booking MJA MJA00321853 (MJR: MJR00243420) (repository.py:189)
2025-05-18 15:57:16 [INFO] Navigating back to list page (Detail -> Secondary -> List)... (detail_processor.py:50)
2025-05-18 15:57:16 [DEBUG] Executing first back() command. (detail_processor.py:51)
2025-05-18 15:57:17 [DEBUG] Executing second back() command. (detail_processor.py:52)
2025-05-18 15:57:19 [INFO] Navigation successful: Confirmed back on list page. (detail_processor.py:55)
2025-05-18 15:57:19 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00321853) (manager.py:111)
2025-05-18 15:57:19 [DEBUG] Processor for DETAIL finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:57:20 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 15:57:20 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 15:57:20 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_155720_273851.xml (xml_dumper.py:65)
2025-05-18 15:57:20 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:20 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:57:20 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:20 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:57:20 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:57:20 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:57:20 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:57:20 [DEBUG] Processing content-desc: 'MJA00321853, WN4 8SH, 14:30 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:20 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00321853, WN4 8SH, 14:30 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00321853): Extracted MJA ID. Original full desc: 'MJA00321853, WN4 8SH, 14:30 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00321853): Parts after MJA ID: ['WN4 8SH', '14:30 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00321853): Found Duration in part '14:30 to 16:00' (mja_parser.py:72)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00321853): Found Postcode in part 'WN4 8SH' -> WN4 8SH (mja_parser.py:90)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00321853): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:20 [INFO] MJA Parse (MJA00321853): Final parsed data: {'booking_id': 'MJA00321853', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'WN4 8SH', 'start_time_raw': '14:30', 'end_time_raw': '16:00', 'calculated_duration_str': '01:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '14:30 to 16:00'} (mja_parser.py:112)
2025-05-18 15:57:20 [DEBUG] Successfully parsed card: MJA00321853, Status: Normal (list_page.py:83)
2025-05-18 15:57:20 [DEBUG] Processing content-desc: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 15:57:20 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00300916): Extracted MJA ID. Original full desc: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00300916): Parts after MJA ID: ['CH7 1AE', '09:30 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00300916): Found Duration in part '09:30 to 11:30' (mja_parser.py:72)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00300916): Found Postcode in part 'CH7 1AE' -> CH7 1AE (mja_parser.py:90)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00300916): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:20 [INFO] MJA Parse (MJA00300916): Final parsed data: {'booking_id': 'MJA00300916', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'CH7 1AE', 'start_time_raw': '09:30', 'end_time_raw': '11:30', 'calculated_duration_str': '02:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 11:30'} (mja_parser.py:112)
2025-05-18 15:57:20 [DEBUG] Successfully parsed card: MJA00300916, Status: Normal (list_page.py:83)
2025-05-18 15:57:20 [DEBUG] Processing content-desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:20 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00306282): Extracted MJA ID. Original full desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00306282): Parts after MJA ID: ['BD1 1LA', '09:30 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00306282): Found Duration in part '09:30 to 17:00' (mja_parser.py:72)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00306282): Found Postcode in part 'BD1 1LA' -> BD1 1LA (mja_parser.py:90)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00306282): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:20 [INFO] MJA Parse (MJA00306282): Final parsed data: {'booking_id': 'MJA00306282', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'BD1 1LA', 'start_time_raw': '09:30', 'end_time_raw': '17:00', 'calculated_duration_str': '07:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 17:00'} (mja_parser.py:112)
2025-05-18 15:57:20 [DEBUG] Successfully parsed card: MJA00306282, Status: Normal (list_page.py:83)
2025-05-18 15:57:20 [DEBUG] Processing content-desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:20 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00309647): Extracted MJA ID. Original full desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00309647): Parts after MJA ID: ['11:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00309647): Found Duration in part '11:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00309647): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:57:20 [DEBUG] MJA Parse (MJA00309647): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:20 [INFO] MJA Parse (MJA00309647): Final parsed data: {'booking_id': 'MJA00309647', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '11:00', 'end_time_raw': '12:00', 'calculated_duration_str': '01:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '11:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:57:20 [DEBUG] Successfully parsed card: MJA00309647, Status: Normal (list_page.py:83)
2025-05-18 15:57:20 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:57:20 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:57:20 [DEBUG] Evaluating Card MJA: MJA00321853, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:20 [DEBUG] Card MJA00321853 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:57:20 [DEBUG] Visibility check for element at y=776, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:20 [DEBUG] Evaluating Card MJA: MJA00300916, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:20 [DEBUG] Card MJA00300916 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:57:20 [DEBUG] Visibility check for element at y=1321, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:20 [DEBUG] Evaluating Card MJA: MJA00306282, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:20 [DEBUG] Card MJA00306282 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:57:20 [DEBUG] Evaluating Card MJA: MJA00309647, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:20 [DEBUG] Card MJA00309647 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:57:20 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:57:20 [INFO] Found 2 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:57:20 [DEBUG] Visibility check for element at y=1939, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:20 [DEBUG] Visibility check for element at y=2556, h=200: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:20 [ERROR] Error locating element for MJA00309647: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:57:20 [INFO] Selected card MJA00306282 (Status: Normal) to click. (list_processor.py:130)
2025-05-18 15:57:20 [INFO] Inserted/Updated base booking record for MJA00306282 with card_status: Normal, db_status: pending (repository.py:75)
2025-05-18 15:57:20 [DEBUG] State updated to SECONDARY for session 1 (MJA: MJA00306282, MJR: None, LastProcMJA: MJA00306282) (manager.py:111)
2025-05-18 15:57:20 [INFO] Attempting click on selected card MJA00306282 (list_processor.py:256)
2025-05-18 15:57:20 [INFO] Clicked card MJA00306282 (list_processor.py:258)
2025-05-18 15:57:22 [DEBUG] Processor for LIST finished. State Manager Current State: SECONDARY (crawler_service.py:198)
2025-05-18 15:57:22 [INFO] --- Executing State: SECONDARY (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:57:22 [INFO] Processing State: SECONDARY (Display 4619827259835644672, MJA: MJA00306282) (secondary_processor.py:95)
2025-05-18 15:57:22 [DEBUG] Secondary page title is displayed. (secondary_page.py:42)
2025-05-18 15:57:22 [INFO] Confirmed on Secondary Page. (secondary_processor.py:90)
2025-05-18 15:57:22 [DEBUG] --- Parsing Secondary Page XML Targeting Specific Attributes --- (secondary_parser.py:33)
2025-05-18 15:57:22 [DEBUG]   Found MJR content-desc: "MJR00230541, Face To Face, Appointments : 1" (secondary_parser.py:48)
2025-05-18 15:57:22 [DEBUG]     Extracted MJR ID: MJR00230541 (secondary_parser.py:49)
2025-05-18 15:57:22 [DEBUG]     Extracted Type Hint: Face To Face (secondary_parser.py:61)
2025-05-18 15:57:22 [DEBUG]     Extracted Appt Count: 1 (secondary_parser.py:69)
2025-05-18 15:57:22 [DEBUG]   Found MJB ID in text: MJB00241981 (secondary_parser.py:90)
2025-05-18 15:57:22 [DEBUG] --- Secondary Page Targeted Extraction Finished: {'mjb_id_raw': 'MJB00241981', 'mjr_id_raw': 'MJR00230541', 'appointment_count_hint': 1, 'type_hint_raw': 'Face To Face'} --- (secondary_parser.py:98)
2025-05-18 15:57:23 [INFO] Saved XML dump: xml_capture_base/MJA00306282/Secondary/Secondary_MJA00306282_MJB00241981_20250518_155723_000475.xml (xml_dumper.py:65)
2025-05-18 15:57:23 [INFO] Extracted from Secondary XML -> MJB: MJB00241981, MJR: MJR00230541, Appt Count: 1, Type Hint: Face To Face (secondary_processor.py:130)
2025-05-18 15:57:23 [INFO] Updated secondary IDs & hints for MJA MJA00306282 (MJR set to MJR00230541) (repository.py:124)
2025-05-18 15:57:23 [DEBUG] Attempting to click MJR link element using XPath: //android.view.ViewGroup[@content-desc and starts-with(@content-desc, "MJR00230541")] (secondary_page.py:99)
2025-05-18 15:57:23 [DEBUG] Clicked MJR link element for MJR00230541. (secondary_page.py:105)
2025-05-18 15:57:24 [DEBUG] State updated to DETAIL for session 1 (MJA: MJA00306282, MJR: MJR00230541, LastProcMJA: MJA00306282) (manager.py:111)
2025-05-18 15:57:24 [DEBUG] Processor for SECONDARY finished. State Manager Current State: DETAIL (crawler_service.py:198)
2025-05-18 15:57:25 [INFO] --- Executing State: DETAIL (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:57:25 [INFO] Processing State: DETAIL (Display 4619827259835644672, MJA_trigger: MJA00306282, MJR: MJR00230541) (detail_processor.py:94)
2025-05-18 15:57:25 [DEBUG] Waiting up to 10s for detail page title: 'Booking #MJR' (detail_page.py:50)
2025-05-18 15:57:26 [DEBUG] Detail page title is displayed. (detail_page.py:55)
2025-05-18 15:57:26 [INFO] Successfully confirmed on Detail Page for MJR MJR00230541 (detail_processor.py:98)
2025-05-18 15:57:26 [DEBUG] Header Results: MJR='MJR00230541', Total='£ 192.32', MultiDay=False, LangIdx=4, DateTimeTuple='('20-05-2025 At', '09:30 - 17:00')' (detail_parser.py:129)
2025-05-18 15:57:26 [INFO] Processing Detail for MJR: 'MJR00230541', IsMultiday=False (detail_processor.py:144)
2025-05-18 15:57:26 [INFO] Saved XML dump: xml_capture_base/MJR00230541/Detail_MJR/Detail_MJR_MJR00230541_initial_view_00_20250518_155726_255858.xml (xml_dumper.py:65)
2025-05-18 15:57:26 [DEBUG] Info block scan range: 5 to 12. Processing 7 items: ["Bradford Magistrates' Court - Crime", "Bradford Magistrates' Court", 'The Tyrls The Tyrls Bradford England BD1 1LA', "Crime - Magistrates' Court | Trial", 'Damita West', '0', '5.79 Miles'] (detail_parser.py:147)
2025-05-18 15:57:26 [DEBUG]   Client Name: 'Bradford Magistrates' Court - Crime' (detail_parser.py:154)
2025-05-18 15:57:26 [DEBUG]   Address L1: 'Bradford Magistrates' Court', L2: 'The Tyrls The Tyrls Bradford England BD1 1LA' (detail_parser.py:173)
2025-05-18 15:57:26 [DEBUG]   Booking Type: 'Crime - Magistrates' Court | Trial' (detail_parser.py:184)
2025-05-18 15:57:26 [DEBUG]   Contact Name: 'Damita West' (detail_parser.py:190)
2025-05-18 15:57:26 [DEBUG]   Contact Phone: '0' (detail_parser.py:196)
2025-05-18 15:57:26 [DEBUG]   Distance: '5.79 Miles' (detail_parser.py:200)
2025-05-18 15:57:26 [DEBUG] Sanitized 'contact_phone_raw' from '0' to None. (detail_parser.py:207)
2025-05-18 15:57:26 [DEBUG] Finished parsing info block: {'language_pair_raw': 'English to Polish', 'client_name_raw': "Bradford Magistrates' Court - Crime", 'address_line1_raw': "Bradford Magistrates' Court", 'address_line2_raw': 'The Tyrls The Tyrls Bradford England BD1 1LA', 'booking_type_raw': "Crime - Magistrates' Court | Trial", 'contact_name_raw': 'Damita West', 'contact_phone_raw': None, 'distance_raw': '5.79 Miles', 'meeting_link_raw': None} (detail_parser.py:208)
2025-05-18 15:57:26 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:57:26 [DEBUG]   Extracting payments for MJA MJA00306282 (text index 15) up to text index 27 (detail_parser.py:268)
2025-05-18 15:57:26 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:57:26 [INFO] Starting scroll loop for more payments or disclaimer... (detail_processor.py:163)
2025-05-18 15:57:26 [INFO] Saved XML dump: xml_capture_base/MJR00230541/Detail_MJR/Detail_MJR_MJR00230541_scroll_01_20250518_155726_937761.xml (xml_dumper.py:65)
2025-05-18 15:57:26 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:57:26 [DEBUG]   Extracting payments for MJA MJA00306282 (text index 15) up to text index 27 (detail_parser.py:268)
2025-05-18 15:57:26 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:57:27 [DEBUG] Scrolling detail page (attempt 1)... (detail_processor.py:186)
2025-05-18 15:57:30 [INFO] Saved XML dump: xml_capture_base/MJR00230541/Detail_MJR/Detail_MJR_MJR00230541_scroll_02_20250518_155730_377073.xml (xml_dumper.py:65)
2025-05-18 15:57:30 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:57:30 [DEBUG]   Extracting payments for MJA MJA00306282 (text index 14) up to text index 27 (detail_parser.py:268)
2025-05-18 15:57:30 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:57:30 [INFO] Disclaimer found after 2 scrolls. (detail_processor.py:178)
2025-05-18 15:57:30 [INFO] Saved XML dump: xml_capture_base/MJR00230541/Detail_MJR/Detail_MJR_MJR00230541_final_view_01_20250518_155730_481090.xml (xml_dumper.py:65)
2025-05-18 15:57:30 [INFO] Consolidating all extracted data... (detail_processor.py:209)
2025-05-18 15:57:30 [DEBUG] --- Consolidating and Parsing Detail Data --- (detail_parser.py:333)
2025-05-18 15:57:30 [DEBUG] Final Parsed Detail Data (keys: ['is_multiday', 'mjr_id', 'header_total', 'booking_date', 'start_time', 'end_time', 'duration', 'multiday_date_range', 'multiday_appointment_info', 'mja_id', 'language_pair', 'client_name', 'booking_type', 'contact_name', 'contact_phone', 'meeting_link', 'address', 'travel_distance', 'overall_total', 'notes', 'multiday_payments', 'day_pay_sl', 'day_pay_td', 'day_pay_tt', 'day_pay_aep', 'day_pay_ooh', 'day_pay_urg', 'day_total']) for MJR MJR00230541 (detail_parser.py:483)
2025-05-18 15:57:30 [DEBUG] Final Parsed MJR Data for MJR00230541 (is_multiday: False): {'is_multiday': 0, 'mjr_id': 'MJR00230541', 'header_total': 192.32, 'booking_date': '20-05-2025', 'start_time': '09:30:00', 'end_time': '17:00:00', 'duration': '07:30', 'multiday_date_range': None, 'multiday_appointment_info': None, 'mja_id': 'MJA00306282', 'language_pair': 'English to Polish', 'client_name': "Bradford Magistrates' Court - Crime", 'booking_type': "Crime - Magistrates' Court | Trial", 'contact_name': 'Damita West', 'contact_phone': None, 'meeting_link': None, 'address': "Bradford Magistrates' Court\nThe Tyrls The Tyrls Bradford England BD1 1LA", 'travel_distance': 5.79, 'overall_total': 192.32, 'notes': "20 May 2025\nHearing type: Trial\nHearing venue: Bradford Magistrates' Court, Courtroom 03, 10:00 AM", 'multiday_payments': None, 'day_pay_sl': 182.0, 'day_pay_td': 0.32, 'day_pay_tt': None, 'day_pay_aep': 10.0, 'day_pay_ooh': None, 'day_pay_urg': None, 'day_total': 192.32}... (detail_processor.py:218)
2025-05-18 15:57:30 [INFO] Processing SINGLE DAY save for MJA: MJA00306282 (MJR: MJR00230541) (detail_processor.py:278)
2025-05-18 15:57:30 [INFO] Saved/Updated details for booking MJA MJA00306282 (MJR: MJR00230541) (repository.py:189)
2025-05-18 15:57:30 [INFO] Navigating back to list page (Detail -> Secondary -> List)... (detail_processor.py:50)
2025-05-18 15:57:30 [DEBUG] Executing first back() command. (detail_processor.py:51)
2025-05-18 15:57:31 [DEBUG] Executing second back() command. (detail_processor.py:52)
2025-05-18 15:57:33 [INFO] Navigation successful: Confirmed back on list page. (detail_processor.py:55)
2025-05-18 15:57:33 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00306282) (manager.py:111)
2025-05-18 15:57:33 [DEBUG] Processor for DETAIL finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:57:33 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 15:57:33 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 15:57:34 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_155734_023944.xml (xml_dumper.py:65)
2025-05-18 15:57:34 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:34 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:57:34 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:34 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:57:34 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:57:34 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:57:34 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:57:34 [DEBUG] Processing content-desc: 'MJA00321853, WN4 8SH, 14:30 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:34 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00321853, WN4 8SH, 14:30 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00321853): Extracted MJA ID. Original full desc: 'MJA00321853, WN4 8SH, 14:30 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00321853): Parts after MJA ID: ['WN4 8SH', '14:30 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00321853): Found Duration in part '14:30 to 16:00' (mja_parser.py:72)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00321853): Found Postcode in part 'WN4 8SH' -> WN4 8SH (mja_parser.py:90)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00321853): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:34 [INFO] MJA Parse (MJA00321853): Final parsed data: {'booking_id': 'MJA00321853', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'WN4 8SH', 'start_time_raw': '14:30', 'end_time_raw': '16:00', 'calculated_duration_str': '01:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '14:30 to 16:00'} (mja_parser.py:112)
2025-05-18 15:57:34 [DEBUG] Successfully parsed card: MJA00321853, Status: Normal (list_page.py:83)
2025-05-18 15:57:34 [DEBUG] Processing content-desc: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 15:57:34 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00300916): Extracted MJA ID. Original full desc: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00300916): Parts after MJA ID: ['CH7 1AE', '09:30 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00300916): Found Duration in part '09:30 to 11:30' (mja_parser.py:72)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00300916): Found Postcode in part 'CH7 1AE' -> CH7 1AE (mja_parser.py:90)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00300916): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:34 [INFO] MJA Parse (MJA00300916): Final parsed data: {'booking_id': 'MJA00300916', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'CH7 1AE', 'start_time_raw': '09:30', 'end_time_raw': '11:30', 'calculated_duration_str': '02:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 11:30'} (mja_parser.py:112)
2025-05-18 15:57:34 [DEBUG] Successfully parsed card: MJA00300916, Status: Normal (list_page.py:83)
2025-05-18 15:57:34 [DEBUG] Processing content-desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:34 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00306282): Extracted MJA ID. Original full desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00306282): Parts after MJA ID: ['BD1 1LA', '09:30 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00306282): Found Duration in part '09:30 to 17:00' (mja_parser.py:72)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00306282): Found Postcode in part 'BD1 1LA' -> BD1 1LA (mja_parser.py:90)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00306282): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:34 [INFO] MJA Parse (MJA00306282): Final parsed data: {'booking_id': 'MJA00306282', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'BD1 1LA', 'start_time_raw': '09:30', 'end_time_raw': '17:00', 'calculated_duration_str': '07:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 17:00'} (mja_parser.py:112)
2025-05-18 15:57:34 [DEBUG] Successfully parsed card: MJA00306282, Status: Normal (list_page.py:83)
2025-05-18 15:57:34 [DEBUG] Processing content-desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:34 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00309647): Extracted MJA ID. Original full desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00309647): Parts after MJA ID: ['11:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00309647): Found Duration in part '11:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00309647): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:57:34 [DEBUG] MJA Parse (MJA00309647): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:34 [INFO] MJA Parse (MJA00309647): Final parsed data: {'booking_id': 'MJA00309647', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '11:00', 'end_time_raw': '12:00', 'calculated_duration_str': '01:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '11:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:57:34 [DEBUG] Successfully parsed card: MJA00309647, Status: Normal (list_page.py:83)
2025-05-18 15:57:34 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:57:34 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:57:34 [DEBUG] Evaluating Card MJA: MJA00321853, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:34 [DEBUG] Card MJA00321853 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:57:34 [DEBUG] Visibility check for element at y=776, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:34 [DEBUG] Evaluating Card MJA: MJA00300916, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:34 [DEBUG] Card MJA00300916 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:57:34 [DEBUG] Visibility check for element at y=1321, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:34 [DEBUG] Evaluating Card MJA: MJA00306282, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:34 [DEBUG] Card MJA00306282 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:57:34 [DEBUG] Visibility check for element at y=1939, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:34 [DEBUG] Evaluating Card MJA: MJA00309647, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:34 [DEBUG] Card MJA00309647 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:57:34 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:57:34 [INFO] Found 1 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:57:34 [DEBUG] Visibility check for element at y=2556, h=200: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:34 [ERROR] Error locating element for MJA00309647: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:57:34 [INFO] No suitable (fully visible, clickable) 'Normal' unprocessed cards found. (list_processor.py:125)
2025-05-18 15:57:34 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 15:57:34 [INFO] Attempting scroll (current attempt: 1/3) (list_processor.py:297)
2025-05-18 15:57:34 [DEBUG] Using anchor 'MJA00306282' for scroll. (list_processor.py:299)
2025-05-18 15:57:34 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 15:57:34 [DEBUG] Found element containing MJA00306282 to use as scroll anchor. (list_page.py:121)
2025-05-18 15:57:35 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001a5fd with percent: 0.6 (list_page.py:146)
2025-05-18 15:57:37 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_01_20250518_155737_037449.xml (xml_dumper.py:65)
2025-05-18 15:57:37 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 15:57:37 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 15:57:37 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 15:57:37 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_1.png (crawler_service.py:120)
2025-05-18 15:57:37 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 15:57:37 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (crawler_service.py:127)
2025-05-18 15:57:37 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 15:57:39 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00306282) (manager.py:111)
2025-05-18 15:57:39 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:57:40 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 15:57:40 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 15:57:40 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:40 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:57:40 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:40 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:57:40 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:57:40 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:57:40 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:57:40 [DEBUG] Processing content-desc: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 15:57:40 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00300916): Extracted MJA ID. Original full desc: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00300916): Parts after MJA ID: ['CH7 1AE', '09:30 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00300916): Found Duration in part '09:30 to 11:30' (mja_parser.py:72)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00300916): Found Postcode in part 'CH7 1AE' -> CH7 1AE (mja_parser.py:90)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00300916): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:40 [INFO] MJA Parse (MJA00300916): Final parsed data: {'booking_id': 'MJA00300916', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'CH7 1AE', 'start_time_raw': '09:30', 'end_time_raw': '11:30', 'calculated_duration_str': '02:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 11:30'} (mja_parser.py:112)
2025-05-18 15:57:40 [DEBUG] Successfully parsed card: MJA00300916, Status: Normal (list_page.py:83)
2025-05-18 15:57:40 [DEBUG] Processing content-desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:40 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00306282): Extracted MJA ID. Original full desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00306282): Parts after MJA ID: ['BD1 1LA', '09:30 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00306282): Found Duration in part '09:30 to 17:00' (mja_parser.py:72)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00306282): Found Postcode in part 'BD1 1LA' -> BD1 1LA (mja_parser.py:90)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00306282): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:40 [INFO] MJA Parse (MJA00306282): Final parsed data: {'booking_id': 'MJA00306282', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'BD1 1LA', 'start_time_raw': '09:30', 'end_time_raw': '17:00', 'calculated_duration_str': '07:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 17:00'} (mja_parser.py:112)
2025-05-18 15:57:40 [DEBUG] Successfully parsed card: MJA00306282, Status: Normal (list_page.py:83)
2025-05-18 15:57:40 [DEBUG] Processing content-desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:40 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00309647): Extracted MJA ID. Original full desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00309647): Parts after MJA ID: ['11:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00309647): Found Duration in part '11:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00309647): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00309647): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:40 [INFO] MJA Parse (MJA00309647): Final parsed data: {'booking_id': 'MJA00309647', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '11:00', 'end_time_raw': '12:00', 'calculated_duration_str': '01:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '11:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:57:40 [DEBUG] Successfully parsed card: MJA00309647, Status: Normal (list_page.py:83)
2025-05-18 15:57:40 [DEBUG] Processing content-desc: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:40 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00218128): Extracted MJA ID. Original full desc: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00218128): Parts after MJA ID: ['LS1 3BG', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00218128): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00218128): Found Postcode in part 'LS1 3BG' -> LS1 3BG (mja_parser.py:90)
2025-05-18 15:57:40 [DEBUG] MJA Parse (MJA00218128): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:40 [INFO] MJA Parse (MJA00218128): Final parsed data: {'booking_id': 'MJA00218128', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'LS1 3BG', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:57:40 [DEBUG] Successfully parsed card: MJA00218128, Status: Normal (list_page.py:83)
2025-05-18 15:57:40 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:57:40 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:57:40 [DEBUG] Evaluating Card MJA: MJA00300916, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:40 [DEBUG] Card MJA00300916 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:57:40 [DEBUG] Visibility check for element at y=663, h=343: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:40 [DEBUG] Evaluating Card MJA: MJA00306282, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:40 [DEBUG] Card MJA00306282 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:57:40 [DEBUG] Visibility check for element at y=1160, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:40 [DEBUG] Evaluating Card MJA: MJA00309647, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:40 [DEBUG] Card MJA00309647 already in processed_ids_this_cycle. Not re-adding to click candidates unless forced. (list_processor.py:193)
2025-05-18 15:57:40 [DEBUG] Card MJA00309647 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:57:40 [DEBUG] Evaluating Card MJA: MJA00218128, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:40 [DEBUG] Card MJA00218128 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:57:40 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:57:40 [INFO] Found 2 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:57:40 [DEBUG] Visibility check for element at y=1777, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:40 [DEBUG] Visibility check for element at y=2395, h=361: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:40 [ERROR] Error locating element for MJA00218128: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:57:40 [INFO] Selected card MJA00309647 (Status: Normal) to click. (list_processor.py:130)
2025-05-18 15:57:40 [INFO] Inserted/Updated base booking record for MJA00309647 with card_status: Normal, db_status: pending (repository.py:75)
2025-05-18 15:57:40 [DEBUG] State updated to SECONDARY for session 1 (MJA: MJA00309647, MJR: None, LastProcMJA: MJA00309647) (manager.py:111)
2025-05-18 15:57:40 [INFO] Attempting click on selected card MJA00309647 (list_processor.py:256)
2025-05-18 15:57:40 [INFO] Clicked card MJA00309647 (list_processor.py:258)
2025-05-18 15:57:42 [DEBUG] Processor for LIST finished. State Manager Current State: SECONDARY (crawler_service.py:198)
2025-05-18 15:57:42 [INFO] --- Executing State: SECONDARY (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:57:42 [INFO] Processing State: SECONDARY (Display 4619827259835644672, MJA: MJA00309647) (secondary_processor.py:95)
2025-05-18 15:57:42 [DEBUG] Secondary page title is displayed. (secondary_page.py:42)
2025-05-18 15:57:42 [INFO] Confirmed on Secondary Page. (secondary_processor.py:90)
2025-05-18 15:57:43 [DEBUG] --- Parsing Secondary Page XML Targeting Specific Attributes --- (secondary_parser.py:33)
2025-05-18 15:57:43 [DEBUG]   Found MJR content-desc: "MJR00233330, Video Remote Interpreting, Appointments : 1" (secondary_parser.py:48)
2025-05-18 15:57:43 [DEBUG]     Extracted MJR ID: MJR00233330 (secondary_parser.py:49)
2025-05-18 15:57:43 [DEBUG]     Extracted Type Hint: Video Remote Interpreting (secondary_parser.py:61)
2025-05-18 15:57:43 [DEBUG]     Extracted Appt Count: 1 (secondary_parser.py:69)
2025-05-18 15:57:43 [DEBUG]   Found MJB ID in text: MJB00244876 (secondary_parser.py:90)
2025-05-18 15:57:43 [DEBUG] --- Secondary Page Targeted Extraction Finished: {'mjb_id_raw': 'MJB00244876', 'mjr_id_raw': 'MJR00233330', 'appointment_count_hint': 1, 'type_hint_raw': 'Video Remote Interpreting'} --- (secondary_parser.py:98)
2025-05-18 15:57:43 [INFO] Saved XML dump: xml_capture_base/MJA00309647/Secondary/Secondary_MJA00309647_MJB00244876_20250518_155743_031207.xml (xml_dumper.py:65)
2025-05-18 15:57:43 [INFO] Extracted from Secondary XML -> MJB: MJB00244876, MJR: MJR00233330, Appt Count: 1, Type Hint: Video Remote Interpreting (secondary_processor.py:130)
2025-05-18 15:57:43 [INFO] Updated secondary IDs & hints for MJA MJA00309647 (MJR set to MJR00233330) (repository.py:124)
2025-05-18 15:57:43 [DEBUG] Attempting to click MJR link element using XPath: //android.view.ViewGroup[@content-desc and starts-with(@content-desc, "MJR00233330")] (secondary_page.py:99)
2025-05-18 15:57:43 [DEBUG] Clicked MJR link element for MJR00233330. (secondary_page.py:105)
2025-05-18 15:57:44 [DEBUG] State updated to DETAIL for session 1 (MJA: MJA00309647, MJR: MJR00233330, LastProcMJA: MJA00309647) (manager.py:111)
2025-05-18 15:57:44 [DEBUG] Processor for SECONDARY finished. State Manager Current State: DETAIL (crawler_service.py:198)
2025-05-18 15:57:45 [INFO] --- Executing State: DETAIL (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:57:45 [INFO] Processing State: DETAIL (Display 4619827259835644672, MJA_trigger: MJA00309647, MJR: MJR00233330) (detail_processor.py:94)
2025-05-18 15:57:45 [DEBUG] Waiting up to 10s for detail page title: 'Booking #MJR' (detail_page.py:50)
2025-05-18 15:57:46 [DEBUG] Detail page title is displayed. (detail_page.py:55)
2025-05-18 15:57:46 [INFO] Successfully confirmed on Detail Page for MJR MJR00233330 (detail_processor.py:98)
2025-05-18 15:57:46 [DEBUG] Header Results: MJR='MJR00233330', Total='£ 44.00', MultiDay=False, LangIdx=4, DateTimeTuple='('21-05-2025 At', '11:00 - 12:00')' (detail_parser.py:129)
2025-05-18 15:57:46 [INFO] Processing Detail for MJR: 'MJR00233330', IsMultiday=False (detail_processor.py:144)
2025-05-18 15:57:46 [INFO] Saved XML dump: xml_capture_base/MJR00233330/Detail_MJR/Detail_MJR_MJR00233330_initial_view_00_20250518_155746_337709.xml (xml_dumper.py:65)
2025-05-18 15:57:46 [DEBUG] Info block scan range: 5 to 10. Processing 5 items: ['Bradford & Calderdale (TPS)', 'Meeting Link', 'NPS | Face to Face Interviews which take place within custodial', 'undefined undefined', 'undefined'] (detail_parser.py:147)
2025-05-18 15:57:46 [DEBUG]   Client Name: 'Bradford & Calderdale (TPS)' (detail_parser.py:154)
2025-05-18 15:57:46 [DEBUG]   Found 'Meeting Link'. (detail_parser.py:156)
2025-05-18 15:57:46 [DEBUG]   No valid URL after Meeting Link label. Next: NPS | Face to Face Interviews which take place within custodial (detail_parser.py:163)
2025-05-18 15:57:46 [DEBUG]   Booking Type: 'NPS | Face to Face Interviews which take place within custodial' (detail_parser.py:184)
2025-05-18 15:57:46 [DEBUG]   Contact Name: 'undefined undefined' (detail_parser.py:190)
2025-05-18 15:57:46 [DEBUG]   Contact Phone: 'undefined' (detail_parser.py:196)
2025-05-18 15:57:46 [DEBUG] Sanitized 'contact_name_raw' from 'undefined undefined' to None. (detail_parser.py:207)
2025-05-18 15:57:46 [DEBUG] Sanitized 'contact_phone_raw' from 'undefined' to None. (detail_parser.py:207)
2025-05-18 15:57:46 [DEBUG] Finished parsing info block: {'language_pair_raw': 'English to Polish', 'client_name_raw': 'Bradford & Calderdale (TPS)', 'address_line1_raw': None, 'address_line2_raw': None, 'booking_type_raw': 'NPS | Face to Face Interviews which take place within custodial', 'contact_name_raw': None, 'contact_phone_raw': None, 'distance_raw': None, 'meeting_link_raw': None} (detail_parser.py:208)
2025-05-18 15:57:46 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:57:46 [DEBUG]   Extracting payments for MJA MJA00309647 (text index 12) up to text index 24 (detail_parser.py:268)
2025-05-18 15:57:46 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:57:46 [INFO] Starting scroll loop for more payments or disclaimer... (detail_processor.py:163)
2025-05-18 15:57:46 [INFO] Saved XML dump: xml_capture_base/MJR00233330/Detail_MJR/Detail_MJR_MJR00233330_scroll_01_20250518_155746_994711.xml (xml_dumper.py:65)
2025-05-18 15:57:46 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:57:46 [DEBUG]   Extracting payments for MJA MJA00309647 (text index 12) up to text index 24 (detail_parser.py:268)
2025-05-18 15:57:46 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:57:47 [DEBUG] Scrolling detail page (attempt 1)... (detail_processor.py:186)
2025-05-18 15:57:50 [INFO] Saved XML dump: xml_capture_base/MJR00233330/Detail_MJR/Detail_MJR_MJR00233330_scroll_02_20250518_155750_339112.xml (xml_dumper.py:65)
2025-05-18 15:57:50 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:57:50 [DEBUG]   Extracting payments for MJA MJA00309647 (text index 9) up to text index 22 (detail_parser.py:268)
2025-05-18 15:57:50 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:57:50 [INFO] Disclaimer found after 2 scrolls. (detail_processor.py:178)
2025-05-18 15:57:50 [INFO] Saved XML dump: xml_capture_base/MJR00233330/Detail_MJR/Detail_MJR_MJR00233330_final_view_01_20250518_155750_430297.xml (xml_dumper.py:65)
2025-05-18 15:57:50 [INFO] Consolidating all extracted data... (detail_processor.py:209)
2025-05-18 15:57:50 [DEBUG] --- Consolidating and Parsing Detail Data --- (detail_parser.py:333)
2025-05-18 15:57:50 [INFO] Extracted meeting link from notes: vcchmpleeds4@meet.video.justice.gov.uk (detail_parser.py:479)
2025-05-18 15:57:50 [DEBUG] Final Parsed Detail Data (keys: ['is_multiday', 'mjr_id', 'header_total', 'booking_date', 'start_time', 'end_time', 'duration', 'multiday_date_range', 'multiday_appointment_info', 'mja_id', 'language_pair', 'client_name', 'booking_type', 'contact_name', 'contact_phone', 'meeting_link', 'address', 'travel_distance', 'overall_total', 'notes', 'multiday_payments', 'day_pay_sl', 'day_pay_td', 'day_pay_tt', 'day_pay_aep', 'day_pay_ooh', 'day_pay_urg', 'day_total']) for MJR MJR00233330 (detail_parser.py:483)
2025-05-18 15:57:50 [DEBUG] Final Parsed MJR Data for MJR00233330 (is_multiday: False): {'is_multiday': 0, 'mjr_id': 'MJR00233330', 'header_total': 44.0, 'booking_date': '21-05-2025', 'start_time': '11:00:00', 'end_time': '12:00:00', 'duration': '01:00', 'multiday_date_range': None, 'multiday_appointment_info': None, 'mja_id': 'MJA00309647', 'language_pair': 'English to Polish', 'client_name': 'Bradford & Calderdale (TPS)', 'booking_type': 'NPS | Face to Face Interviews which take place within custodial', 'contact_name': None, 'contact_phone': None, 'meeting_link': 'vcchmpleeds4@meet.video.justice.gov.uk', 'address': None, 'travel_distance': None, 'overall_total': 44.0, 'notes': 'VIDEO LINK IS ONLY FOR PROFESSIONAL VISITS. NO FAMILY, NO FRIENDS AND NO CHILDERN ARE ALLOWED ON THE LINK.\nPHOTO ID MUST BE SHOWN WHEN JOINING THE LINK.\nALL ATTENDING THE LINK MUST BE IN A SECURE LOCATION.\nFAILURE TO COMPLY COULD LEAD TO TERMINATION OF THE LINK.\nvcchmpleeds4@meet.video.justice.gov.uk', 'multiday_payments': None, 'day_pay_sl': 24.0, 'day_pay_td': None, 'day_pay_tt': None, 'day... (detail_processor.py:218)
2025-05-18 15:57:50 [INFO] Processing SINGLE DAY save for MJA: MJA00309647 (MJR: MJR00233330) (detail_processor.py:278)
2025-05-18 15:57:50 [INFO] Saved/Updated details for booking MJA MJA00309647 (MJR: MJR00233330) (repository.py:189)
2025-05-18 15:57:50 [INFO] Navigating back to list page (Detail -> Secondary -> List)... (detail_processor.py:50)
2025-05-18 15:57:50 [DEBUG] Executing first back() command. (detail_processor.py:51)
2025-05-18 15:57:51 [DEBUG] Executing second back() command. (detail_processor.py:52)
2025-05-18 15:57:53 [INFO] Navigation successful: Confirmed back on list page. (detail_processor.py:55)
2025-05-18 15:57:53 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00309647) (manager.py:111)
2025-05-18 15:57:53 [DEBUG] Processor for DETAIL finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:57:53 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 15:57:53 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 15:57:53 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_155753_986489.xml (xml_dumper.py:65)
2025-05-18 15:57:54 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:54 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:57:54 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:54 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:57:54 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:57:54 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:57:54 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:57:54 [DEBUG] Processing content-desc: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 15:57:54 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00300916): Extracted MJA ID. Original full desc: 'MJA00300916, CH7 1AE, 09:30 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00300916): Parts after MJA ID: ['CH7 1AE', '09:30 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00300916): Found Duration in part '09:30 to 11:30' (mja_parser.py:72)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00300916): Found Postcode in part 'CH7 1AE' -> CH7 1AE (mja_parser.py:90)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00300916): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:54 [INFO] MJA Parse (MJA00300916): Final parsed data: {'booking_id': 'MJA00300916', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'CH7 1AE', 'start_time_raw': '09:30', 'end_time_raw': '11:30', 'calculated_duration_str': '02:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 11:30'} (mja_parser.py:112)
2025-05-18 15:57:54 [DEBUG] Successfully parsed card: MJA00300916, Status: Normal (list_page.py:83)
2025-05-18 15:57:54 [DEBUG] Processing content-desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:54 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00306282): Extracted MJA ID. Original full desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00306282): Parts after MJA ID: ['BD1 1LA', '09:30 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00306282): Found Duration in part '09:30 to 17:00' (mja_parser.py:72)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00306282): Found Postcode in part 'BD1 1LA' -> BD1 1LA (mja_parser.py:90)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00306282): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:54 [INFO] MJA Parse (MJA00306282): Final parsed data: {'booking_id': 'MJA00306282', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'BD1 1LA', 'start_time_raw': '09:30', 'end_time_raw': '17:00', 'calculated_duration_str': '07:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 17:00'} (mja_parser.py:112)
2025-05-18 15:57:54 [DEBUG] Successfully parsed card: MJA00306282, Status: Normal (list_page.py:83)
2025-05-18 15:57:54 [DEBUG] Processing content-desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:54 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00309647): Extracted MJA ID. Original full desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00309647): Parts after MJA ID: ['11:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00309647): Found Duration in part '11:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00309647): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00309647): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:54 [INFO] MJA Parse (MJA00309647): Final parsed data: {'booking_id': 'MJA00309647', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '11:00', 'end_time_raw': '12:00', 'calculated_duration_str': '01:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '11:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:57:54 [DEBUG] Successfully parsed card: MJA00309647, Status: Normal (list_page.py:83)
2025-05-18 15:57:54 [DEBUG] Processing content-desc: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:57:54 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00218128): Extracted MJA ID. Original full desc: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00218128): Parts after MJA ID: ['LS1 3BG', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00218128): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00218128): Found Postcode in part 'LS1 3BG' -> LS1 3BG (mja_parser.py:90)
2025-05-18 15:57:54 [DEBUG] MJA Parse (MJA00218128): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:57:54 [INFO] MJA Parse (MJA00218128): Final parsed data: {'booking_id': 'MJA00218128', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'LS1 3BG', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:57:54 [DEBUG] Successfully parsed card: MJA00218128, Status: Normal (list_page.py:83)
2025-05-18 15:57:54 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:57:54 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:57:54 [DEBUG] Evaluating Card MJA: MJA00300916, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:54 [DEBUG] Card MJA00300916 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:57:54 [DEBUG] Visibility check for element at y=663, h=343: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:54 [DEBUG] Evaluating Card MJA: MJA00306282, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:54 [DEBUG] Card MJA00306282 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:57:54 [DEBUG] Visibility check for element at y=1160, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:54 [DEBUG] Evaluating Card MJA: MJA00309647, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:54 [DEBUG] Card MJA00309647 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:57:54 [DEBUG] Visibility check for element at y=1777, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:54 [DEBUG] Evaluating Card MJA: MJA00218128, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:57:54 [DEBUG] Card MJA00218128 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:57:54 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:57:54 [INFO] Found 1 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:57:54 [DEBUG] Visibility check for element at y=2395, h=361: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:57:54 [ERROR] Error locating element for MJA00218128: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:57:54 [INFO] No suitable (fully visible, clickable) 'Normal' unprocessed cards found. (list_processor.py:125)
2025-05-18 15:57:54 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 15:57:54 [INFO] Attempting scroll (current attempt: 1/3) (list_processor.py:297)
2025-05-18 15:57:54 [DEBUG] Using anchor 'MJA00309647' for scroll. (list_processor.py:299)
2025-05-18 15:57:54 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 15:57:54 [DEBUG] Found element containing MJA00309647 to use as scroll anchor. (list_page.py:121)
2025-05-18 15:57:55 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001a80b with percent: 0.6 (list_page.py:146)
2025-05-18 15:57:57 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_01_20250518_155757_016540.xml (xml_dumper.py:65)
2025-05-18 15:57:57 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 15:57:57 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 15:57:57 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 15:57:57 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_1.png (crawler_service.py:120)
2025-05-18 15:57:57 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 15:57:57 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (crawler_service.py:127)
2025-05-18 15:57:57 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 15:57:59 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00309647) (manager.py:111)
2025-05-18 15:57:59 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:57:59 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 15:57:59 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 15:57:59 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:57:59 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:57:59 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:58:00 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:58:00 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:58:00 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:58:00 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:58:00 [DEBUG] Processing content-desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:00 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00306282): Extracted MJA ID. Original full desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00306282): Parts after MJA ID: ['BD1 1LA', '09:30 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00306282): Found Duration in part '09:30 to 17:00' (mja_parser.py:72)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00306282): Found Postcode in part 'BD1 1LA' -> BD1 1LA (mja_parser.py:90)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00306282): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:00 [INFO] MJA Parse (MJA00306282): Final parsed data: {'booking_id': 'MJA00306282', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'BD1 1LA', 'start_time_raw': '09:30', 'end_time_raw': '17:00', 'calculated_duration_str': '07:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 17:00'} (mja_parser.py:112)
2025-05-18 15:58:00 [DEBUG] Successfully parsed card: MJA00306282, Status: Normal (list_page.py:83)
2025-05-18 15:58:00 [DEBUG] Processing content-desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:00 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00309647): Extracted MJA ID. Original full desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00309647): Parts after MJA ID: ['11:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00309647): Found Duration in part '11:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00309647): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00309647): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:00 [INFO] MJA Parse (MJA00309647): Final parsed data: {'booking_id': 'MJA00309647', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '11:00', 'end_time_raw': '12:00', 'calculated_duration_str': '01:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '11:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:58:00 [DEBUG] Successfully parsed card: MJA00309647, Status: Normal (list_page.py:83)
2025-05-18 15:58:00 [DEBUG] Processing content-desc: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:00 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00218128): Extracted MJA ID. Original full desc: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00218128): Parts after MJA ID: ['LS1 3BG', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00218128): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00218128): Found Postcode in part 'LS1 3BG' -> LS1 3BG (mja_parser.py:90)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00218128): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:00 [INFO] MJA Parse (MJA00218128): Final parsed data: {'booking_id': 'MJA00218128', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'LS1 3BG', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:58:00 [DEBUG] Successfully parsed card: MJA00218128, Status: Normal (list_page.py:83)
2025-05-18 15:58:00 [DEBUG] Processing content-desc: 'Viewed, MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:00 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Viewed, MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:00 [INFO] MJA Parse: Found card status 'Viewed' (Prefix: 'Viewed,'). Remaining desc for MJA ID: 'MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:35)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00323444): Extracted MJA ID. Original full desc: 'Viewed, MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00323444): Parts after MJA ID: ['BD1 1LB', '09:30 to 10:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00323444): Found Duration in part '09:30 to 10:00' (mja_parser.py:72)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00323444): Found Postcode in part 'BD1 1LB' -> BD1 1LB (mja_parser.py:90)
2025-05-18 15:58:00 [DEBUG] MJA Parse (MJA00323444): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:00 [INFO] MJA Parse (MJA00323444): Final parsed data: {'booking_id': 'MJA00323444', 'card_status': <BookingCardStatus.VIEWED: 'Viewed'>, 'postcode': 'BD1 1LB', 'start_time_raw': '09:30', 'end_time_raw': '10:00', 'calculated_duration_str': '00:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 10:00'} (mja_parser.py:112)
2025-05-18 15:58:00 [DEBUG] Successfully parsed card: MJA00323444, Status: Viewed (list_page.py:83)
2025-05-18 15:58:00 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:58:00 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:58:00 [DEBUG] Evaluating Card MJA: MJA00306282, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:00 [DEBUG] Card MJA00306282 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:00 [DEBUG] Visibility check for element at y=663, h=295: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:00 [DEBUG] Evaluating Card MJA: MJA00309647, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:00 [DEBUG] Card MJA00309647 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:00 [DEBUG] Visibility check for element at y=1111, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:00 [DEBUG] Evaluating Card MJA: MJA00218128, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:00 [DEBUG] Card MJA00218128 already in processed_ids_this_cycle. Not re-adding to click candidates unless forced. (list_processor.py:193)
2025-05-18 15:58:00 [DEBUG] Card MJA00218128 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:58:00 [DEBUG] Evaluating Card MJA: MJA00323444, Parsed List Status: Viewed (list_processor.py:169)
2025-05-18 15:58:00 [INFO] Booking MJA00323444 is 'Viewed' on list. Saving base info, status, and skipping detail scrape. (list_processor.py:220)
2025-05-18 15:58:00 [INFO] Inserted/Updated base booking record for MJA00323444 with card_status: Viewed, db_status: skipped_offer_viewed (repository.py:75)
2025-05-18 15:58:00 [DEBUG] Booking MJA00323444 status already 'skipped_offer_viewed' or not found. (repository.py:307)
2025-05-18 15:58:00 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:58:00 [INFO] Found 1 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:58:00 [DEBUG] Visibility check for element at y=1729, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:00 [INFO] Selected card MJA00218128 (Status: Normal) to click. (list_processor.py:130)
2025-05-18 15:58:00 [INFO] Inserted/Updated base booking record for MJA00218128 with card_status: Normal, db_status: pending (repository.py:75)
2025-05-18 15:58:00 [DEBUG] State updated to SECONDARY for session 1 (MJA: MJA00218128, MJR: None, LastProcMJA: MJA00218128) (manager.py:111)
2025-05-18 15:58:00 [INFO] Attempting click on selected card MJA00218128 (list_processor.py:256)
2025-05-18 15:58:00 [INFO] Clicked card MJA00218128 (list_processor.py:258)
2025-05-18 15:58:01 [DEBUG] Processor for LIST finished. State Manager Current State: SECONDARY (crawler_service.py:198)
2025-05-18 15:58:02 [INFO] --- Executing State: SECONDARY (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:58:02 [INFO] Processing State: SECONDARY (Display 4619827259835644672, MJA: MJA00218128) (secondary_processor.py:95)
2025-05-18 15:58:02 [DEBUG] Secondary page title is displayed. (secondary_page.py:42)
2025-05-18 15:58:02 [INFO] Confirmed on Secondary Page. (secondary_processor.py:90)
2025-05-18 15:58:02 [DEBUG] --- Parsing Secondary Page XML Targeting Specific Attributes --- (secondary_parser.py:33)
2025-05-18 15:58:02 [DEBUG]   Found MJR content-desc: "MJR00158465, Face To Face, Appointments : 1" (secondary_parser.py:48)
2025-05-18 15:58:02 [DEBUG]     Extracted MJR ID: MJR00158465 (secondary_parser.py:49)
2025-05-18 15:58:02 [DEBUG]     Extracted Type Hint: Face To Face (secondary_parser.py:61)
2025-05-18 15:58:02 [DEBUG]     Extracted Appt Count: 1 (secondary_parser.py:69)
2025-05-18 15:58:02 [DEBUG]   Found MJB ID in text: MJB00165492 (secondary_parser.py:90)
2025-05-18 15:58:02 [DEBUG] --- Secondary Page Targeted Extraction Finished: {'mjb_id_raw': 'MJB00165492', 'mjr_id_raw': 'MJR00158465', 'appointment_count_hint': 1, 'type_hint_raw': 'Face To Face'} --- (secondary_parser.py:98)
2025-05-18 15:58:02 [INFO] Saved XML dump: xml_capture_base/MJA00218128/Secondary/Secondary_MJA00218128_MJB00165492_20250518_155802_451306.xml (xml_dumper.py:65)
2025-05-18 15:58:02 [INFO] Extracted from Secondary XML -> MJB: MJB00165492, MJR: MJR00158465, Appt Count: 1, Type Hint: Face To Face (secondary_processor.py:130)
2025-05-18 15:58:02 [INFO] Updated secondary IDs & hints for MJA MJA00218128 (MJR set to MJR00158465) (repository.py:124)
2025-05-18 15:58:02 [DEBUG] Attempting to click MJR link element using XPath: //android.view.ViewGroup[@content-desc and starts-with(@content-desc, "MJR00158465")] (secondary_page.py:99)
2025-05-18 15:58:02 [DEBUG] Clicked MJR link element for MJR00158465. (secondary_page.py:105)
2025-05-18 15:58:04 [DEBUG] State updated to DETAIL for session 1 (MJA: MJA00218128, MJR: MJR00158465, LastProcMJA: MJA00218128) (manager.py:111)
2025-05-18 15:58:04 [DEBUG] Processor for SECONDARY finished. State Manager Current State: DETAIL (crawler_service.py:198)
2025-05-18 15:58:04 [INFO] --- Executing State: DETAIL (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:58:04 [INFO] Processing State: DETAIL (Display 4619827259835644672, MJA_trigger: MJA00218128, MJR: MJR00158465) (detail_processor.py:94)
2025-05-18 15:58:04 [DEBUG] Waiting up to 10s for detail page title: 'Booking #MJR' (detail_page.py:50)
2025-05-18 15:58:05 [DEBUG] Detail page title is displayed. (detail_page.py:55)
2025-05-18 15:58:05 [INFO] Successfully confirmed on Detail Page for MJR MJR00158465 (detail_processor.py:98)
2025-05-18 15:58:05 [DEBUG] Header Results: MJR='MJR00158465', Total='£ 154.95', MultiDay=False, LangIdx=4, DateTimeTuple='('22-05-2025 At', '10:00 - 16:00')' (detail_parser.py:129)
2025-05-18 15:58:05 [INFO] Processing Detail for MJR: 'MJR00158465', IsMultiday=False (detail_processor.py:144)
2025-05-18 15:58:05 [INFO] Saved XML dump: xml_capture_base/MJR00158465/Detail_MJR/Detail_MJR_MJR00158465_initial_view_00_20250518_155805_705542.xml (xml_dumper.py:65)
2025-05-18 15:58:05 [DEBUG] Info block scan range: 5 to 12. Processing 7 items: ['Leeds Combined Court - Crown Court', 'Leeds Combined Court Centre', '1 Oxford Row Leeds England LS1 3BG', 'Crime - Crown Court | Trial', 'Holly Irving', 'null', '9.87 Miles'] (detail_parser.py:147)
2025-05-18 15:58:05 [DEBUG]   Client Name: 'Leeds Combined Court - Crown Court' (detail_parser.py:154)
2025-05-18 15:58:05 [DEBUG]   Address L1: 'Leeds Combined Court Centre', L2: '1 Oxford Row Leeds England LS1 3BG' (detail_parser.py:173)
2025-05-18 15:58:05 [DEBUG]   Booking Type: 'Crime - Crown Court | Trial' (detail_parser.py:184)
2025-05-18 15:58:05 [DEBUG]   Contact Name: 'Holly Irving' (detail_parser.py:190)
2025-05-18 15:58:05 [DEBUG]   Contact Phone: 'null' (detail_parser.py:196)
2025-05-18 15:58:05 [DEBUG]   Distance: '9.87 Miles' (detail_parser.py:200)
2025-05-18 15:58:05 [DEBUG] Sanitized 'contact_phone_raw' from 'null' to None. (detail_parser.py:207)
2025-05-18 15:58:05 [DEBUG] Finished parsing info block: {'language_pair_raw': 'English to Polish', 'client_name_raw': 'Leeds Combined Court - Crown Court', 'address_line1_raw': 'Leeds Combined Court Centre', 'address_line2_raw': '1 Oxford Row Leeds England LS1 3BG', 'booking_type_raw': 'Crime - Crown Court | Trial', 'contact_name_raw': 'Holly Irving', 'contact_phone_raw': None, 'distance_raw': '9.87 Miles', 'meeting_link_raw': None} (detail_parser.py:208)
2025-05-18 15:58:05 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:58:05 [DEBUG]   Extracting payments for MJA MJA00218128 (text index 15) up to text index 25 (detail_parser.py:268)
2025-05-18 15:58:05 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:58:06 [INFO] Starting scroll loop for more payments or disclaimer... (detail_processor.py:163)
2025-05-18 15:58:06 [INFO] Saved XML dump: xml_capture_base/MJR00158465/Detail_MJR/Detail_MJR_MJR00158465_scroll_01_20250518_155806_380569.xml (xml_dumper.py:65)
2025-05-18 15:58:06 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:58:06 [DEBUG]   Extracting payments for MJA MJA00218128 (text index 15) up to text index 25 (detail_parser.py:268)
2025-05-18 15:58:06 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:58:06 [DEBUG] Scrolling detail page (attempt 1)... (detail_processor.py:186)
2025-05-18 15:58:09 [INFO] Saved XML dump: xml_capture_base/MJR00158465/Detail_MJR/Detail_MJR_MJR00158465_scroll_02_20250518_155809_638755.xml (xml_dumper.py:65)
2025-05-18 15:58:09 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:58:09 [DEBUG]   Extracting payments for MJA MJA00218128 (text index 14) up to text index 25 (detail_parser.py:268)
2025-05-18 15:58:09 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:58:09 [INFO] Disclaimer found after 2 scrolls. (detail_processor.py:178)
2025-05-18 15:58:09 [INFO] Saved XML dump: xml_capture_base/MJR00158465/Detail_MJR/Detail_MJR_MJR00158465_final_view_01_20250518_155809_736944.xml (xml_dumper.py:65)
2025-05-18 15:58:09 [INFO] Consolidating all extracted data... (detail_processor.py:209)
2025-05-18 15:58:09 [DEBUG] --- Consolidating and Parsing Detail Data --- (detail_parser.py:333)
2025-05-18 15:58:09 [DEBUG] Final Parsed Detail Data (keys: ['is_multiday', 'mjr_id', 'header_total', 'booking_date', 'start_time', 'end_time', 'duration', 'multiday_date_range', 'multiday_appointment_info', 'mja_id', 'language_pair', 'client_name', 'booking_type', 'contact_name', 'contact_phone', 'meeting_link', 'address', 'travel_distance', 'overall_total', 'notes', 'multiday_payments', 'day_pay_sl', 'day_pay_td', 'day_pay_tt', 'day_pay_aep', 'day_pay_ooh', 'day_pay_urg', 'day_total']) for MJR MJR00158465 (detail_parser.py:483)
2025-05-18 15:58:09 [DEBUG] Final Parsed MJR Data for MJR00158465 (is_multiday: False): {'is_multiday': 0, 'mjr_id': 'MJR00158465', 'header_total': 154.95, 'booking_date': '22-05-2025', 'start_time': '10:00:00', 'end_time': '16:00:00', 'duration': '06:00', 'multiday_date_range': None, 'multiday_appointment_info': None, 'mja_id': 'MJA00218128', 'language_pair': 'English to Polish', 'client_name': 'Leeds Combined Court - Crown Court', 'booking_type': 'Crime - Crown Court | Trial', 'contact_name': 'Holly Irving', 'contact_phone': None, 'meeting_link': None, 'address': 'Leeds Combined Court Centre\n1 Oxford Row Leeds England LS1 3BG', 'travel_distance': 9.87, 'overall_total': 154.95, 'notes': 'Please report to the courtroom at the start of the hearing and at the end ask the court clerk to complete your timesheet then bring this up to the first floor enquiries counter.', 'multiday_payments': None, 'day_pay_sl': 143.0, 'day_pay_td': 1.95, 'day_pay_tt': None, 'day_pay_aep': 10.0, 'day_pay_ooh': None, 'day_pay_urg': None, 'day_total': 154.95}... (detail_processor.py:218)
2025-05-18 15:58:09 [INFO] Processing SINGLE DAY save for MJA: MJA00218128 (MJR: MJR00158465) (detail_processor.py:278)
2025-05-18 15:58:09 [INFO] Saved/Updated details for booking MJA MJA00218128 (MJR: MJR00158465) (repository.py:189)
2025-05-18 15:58:09 [INFO] Navigating back to list page (Detail -> Secondary -> List)... (detail_processor.py:50)
2025-05-18 15:58:09 [DEBUG] Executing first back() command. (detail_processor.py:51)
2025-05-18 15:58:10 [DEBUG] Executing second back() command. (detail_processor.py:52)
2025-05-18 15:58:12 [INFO] Navigation successful: Confirmed back on list page. (detail_processor.py:55)
2025-05-18 15:58:12 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00218128) (manager.py:111)
2025-05-18 15:58:12 [DEBUG] Processor for DETAIL finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:58:13 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 15:58:13 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 15:58:13 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_155813_350537.xml (xml_dumper.py:65)
2025-05-18 15:58:13 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:58:13 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:58:13 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:58:13 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:58:13 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:58:13 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:58:13 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:58:13 [DEBUG] Processing content-desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:13 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00306282): Extracted MJA ID. Original full desc: 'MJA00306282, BD1 1LA, 09:30 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00306282): Parts after MJA ID: ['BD1 1LA', '09:30 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00306282): Found Duration in part '09:30 to 17:00' (mja_parser.py:72)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00306282): Found Postcode in part 'BD1 1LA' -> BD1 1LA (mja_parser.py:90)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00306282): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:13 [INFO] MJA Parse (MJA00306282): Final parsed data: {'booking_id': 'MJA00306282', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'BD1 1LA', 'start_time_raw': '09:30', 'end_time_raw': '17:00', 'calculated_duration_str': '07:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 17:00'} (mja_parser.py:112)
2025-05-18 15:58:13 [DEBUG] Successfully parsed card: MJA00306282, Status: Normal (list_page.py:83)
2025-05-18 15:58:13 [DEBUG] Processing content-desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:13 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00309647): Extracted MJA ID. Original full desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00309647): Parts after MJA ID: ['11:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00309647): Found Duration in part '11:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00309647): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00309647): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:13 [INFO] MJA Parse (MJA00309647): Final parsed data: {'booking_id': 'MJA00309647', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '11:00', 'end_time_raw': '12:00', 'calculated_duration_str': '01:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '11:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:58:13 [DEBUG] Successfully parsed card: MJA00309647, Status: Normal (list_page.py:83)
2025-05-18 15:58:13 [DEBUG] Processing content-desc: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:13 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00218128): Extracted MJA ID. Original full desc: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00218128): Parts after MJA ID: ['LS1 3BG', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00218128): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00218128): Found Postcode in part 'LS1 3BG' -> LS1 3BG (mja_parser.py:90)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00218128): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:13 [INFO] MJA Parse (MJA00218128): Final parsed data: {'booking_id': 'MJA00218128', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'LS1 3BG', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:58:13 [DEBUG] Successfully parsed card: MJA00218128, Status: Normal (list_page.py:83)
2025-05-18 15:58:13 [DEBUG] Processing content-desc: 'Viewed, MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:13 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Viewed, MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:13 [INFO] MJA Parse: Found card status 'Viewed' (Prefix: 'Viewed,'). Remaining desc for MJA ID: 'MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:35)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00323444): Extracted MJA ID. Original full desc: 'Viewed, MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00323444): Parts after MJA ID: ['BD1 1LB', '09:30 to 10:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00323444): Found Duration in part '09:30 to 10:00' (mja_parser.py:72)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00323444): Found Postcode in part 'BD1 1LB' -> BD1 1LB (mja_parser.py:90)
2025-05-18 15:58:13 [DEBUG] MJA Parse (MJA00323444): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:13 [INFO] MJA Parse (MJA00323444): Final parsed data: {'booking_id': 'MJA00323444', 'card_status': <BookingCardStatus.VIEWED: 'Viewed'>, 'postcode': 'BD1 1LB', 'start_time_raw': '09:30', 'end_time_raw': '10:00', 'calculated_duration_str': '00:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 10:00'} (mja_parser.py:112)
2025-05-18 15:58:13 [DEBUG] Successfully parsed card: MJA00323444, Status: Viewed (list_page.py:83)
2025-05-18 15:58:13 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:58:13 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:58:13 [DEBUG] Evaluating Card MJA: MJA00306282, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:13 [DEBUG] Card MJA00306282 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:13 [DEBUG] Visibility check for element at y=663, h=295: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:13 [DEBUG] Evaluating Card MJA: MJA00309647, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:13 [DEBUG] Card MJA00309647 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:13 [DEBUG] Visibility check for element at y=1111, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:13 [DEBUG] Evaluating Card MJA: MJA00218128, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:13 [DEBUG] Card MJA00218128 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:13 [DEBUG] Visibility check for element at y=1729, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:13 [DEBUG] Evaluating Card MJA: MJA00323444, Parsed List Status: Viewed (list_processor.py:169)
2025-05-18 15:58:13 [DEBUG] Card MJA00323444 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:13 [DEBUG] Visibility check for element at y=2347, h=409: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:13 [INFO] Found 0 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:58:13 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 15:58:13 [DEBUG] Incremented scroll_attempts to 1 as no new processable cards were found. (list_processor.py:277)
2025-05-18 15:58:13 [INFO] Attempting scroll (current attempt: 1/3) (list_processor.py:297)
2025-05-18 15:58:13 [DEBUG] Using anchor 'MJA00218128' for scroll. (list_processor.py:299)
2025-05-18 15:58:13 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 15:58:13 [DEBUG] Found element containing MJA00218128 to use as scroll anchor. (list_page.py:121)
2025-05-18 15:58:15 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001a9dd with percent: 0.6 (list_page.py:146)
2025-05-18 15:58:16 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_01_20250518_155816_380963.xml (xml_dumper.py:65)
2025-05-18 15:58:16 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 15:58:16 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 15:58:16 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 15:58:16 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_1.png (crawler_service.py:120)
2025-05-18 15:58:16 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 15:58:16 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (crawler_service.py:127)
2025-05-18 15:58:16 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 15:58:18 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00218128) (manager.py:111)
2025-05-18 15:58:18 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:58:19 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 15:58:19 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 15:58:19 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:58:19 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:58:19 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:58:19 [DEBUG] Found 8 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:58:19 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:58:19 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:58:19 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:58:19 [DEBUG] Processing content-desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:19 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00309647): Extracted MJA ID. Original full desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00309647): Parts after MJA ID: ['11:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00309647): Found Duration in part '11:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00309647): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00309647): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:19 [INFO] MJA Parse (MJA00309647): Final parsed data: {'booking_id': 'MJA00309647', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '11:00', 'end_time_raw': '12:00', 'calculated_duration_str': '01:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '11:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:58:19 [DEBUG] Successfully parsed card: MJA00309647, Status: Normal (list_page.py:83)
2025-05-18 15:58:19 [DEBUG] Processing content-desc: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:19 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00218128): Extracted MJA ID. Original full desc: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00218128): Parts after MJA ID: ['LS1 3BG', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00218128): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00218128): Found Postcode in part 'LS1 3BG' -> LS1 3BG (mja_parser.py:90)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00218128): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:19 [INFO] MJA Parse (MJA00218128): Final parsed data: {'booking_id': 'MJA00218128', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'LS1 3BG', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:58:19 [DEBUG] Successfully parsed card: MJA00218128, Status: Normal (list_page.py:83)
2025-05-18 15:58:19 [DEBUG] Processing content-desc: 'Viewed, MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:19 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Viewed, MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:19 [INFO] MJA Parse: Found card status 'Viewed' (Prefix: 'Viewed,'). Remaining desc for MJA ID: 'MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:35)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00323444): Extracted MJA ID. Original full desc: 'Viewed, MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00323444): Parts after MJA ID: ['BD1 1LB', '09:30 to 10:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00323444): Found Duration in part '09:30 to 10:00' (mja_parser.py:72)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00323444): Found Postcode in part 'BD1 1LB' -> BD1 1LB (mja_parser.py:90)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00323444): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:19 [INFO] MJA Parse (MJA00323444): Final parsed data: {'booking_id': 'MJA00323444', 'card_status': <BookingCardStatus.VIEWED: 'Viewed'>, 'postcode': 'BD1 1LB', 'start_time_raw': '09:30', 'end_time_raw': '10:00', 'calculated_duration_str': '00:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 10:00'} (mja_parser.py:112)
2025-05-18 15:58:19 [DEBUG] Successfully parsed card: MJA00323444, Status: Viewed (list_page.py:83)
2025-05-18 15:58:19 [DEBUG] Processing content-desc: 'MJA00317866, 10:00 to 12:30, English to Polish' (list_page.py:77)
2025-05-18 15:58:19 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00317866, 10:00 to 12:30, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00317866): Extracted MJA ID. Original full desc: 'MJA00317866, 10:00 to 12:30, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00317866): Parts after MJA ID: ['10:00 to 12:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00317866): Found Duration in part '10:00 to 12:30' (mja_parser.py:72)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00317866): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00317866): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:19 [INFO] MJA Parse (MJA00317866): Final parsed data: {'booking_id': 'MJA00317866', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '12:30', 'calculated_duration_str': '02:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 12:30'} (mja_parser.py:112)
2025-05-18 15:58:19 [DEBUG] Successfully parsed card: MJA00317866, Status: Normal (list_page.py:83)
2025-05-18 15:58:19 [DEBUG] Processing content-desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:19 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00285172): Extracted MJA ID. Original full desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00285172): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00285172): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00285172): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:58:19 [DEBUG] MJA Parse (MJA00285172): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:19 [WARNING] MJA Parse (MJA00285172): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:58:19 [INFO] MJA Parse (MJA00285172): Final parsed data: {'booking_id': 'MJA00285172', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:58:19 [DEBUG] Successfully parsed card: MJA00285172, Status: Normal (list_page.py:83)
2025-05-18 15:58:19 [INFO] Successfully extracted data for 5 cards from list page XML source. (list_page.py:100)
2025-05-18 15:58:19 [INFO] Found data for 5 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:58:19 [DEBUG] Evaluating Card MJA: MJA00309647, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:19 [DEBUG] Card MJA00309647 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:19 [DEBUG] Visibility check for element at y=663, h=70: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:19 [DEBUG] Evaluating Card MJA: MJA00218128, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:19 [DEBUG] Card MJA00218128 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:19 [DEBUG] Visibility check for element at y=887, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:19 [DEBUG] Evaluating Card MJA: MJA00323444, Parsed List Status: Viewed (list_processor.py:169)
2025-05-18 15:58:19 [DEBUG] Card MJA00323444 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:19 [DEBUG] Visibility check for element at y=1505, h=465: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:19 [DEBUG] Evaluating Card MJA: MJA00317866, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:19 [DEBUG] Card MJA00317866 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:58:19 [DEBUG] Evaluating Card MJA: MJA00285172, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:19 [DEBUG] Card MJA00285172 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:58:19 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:58:19 [INFO] Found 2 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:58:19 [DEBUG] Visibility check for element at y=2050, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:20 [DEBUG] Visibility check for element at y=2668, h=88: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:20 [ERROR] Error locating element for MJA00285172: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:58:20 [INFO] Selected card MJA00317866 (Status: Normal) to click. (list_processor.py:130)
2025-05-18 15:58:20 [INFO] Inserted/Updated base booking record for MJA00317866 with card_status: Normal, db_status: pending (repository.py:75)
2025-05-18 15:58:20 [DEBUG] State updated to SECONDARY for session 1 (MJA: MJA00317866, MJR: None, LastProcMJA: MJA00317866) (manager.py:111)
2025-05-18 15:58:20 [INFO] Attempting click on selected card MJA00317866 (list_processor.py:256)
2025-05-18 15:58:20 [INFO] Clicked card MJA00317866 (list_processor.py:258)
2025-05-18 15:58:21 [DEBUG] Processor for LIST finished. State Manager Current State: SECONDARY (crawler_service.py:198)
2025-05-18 15:58:22 [INFO] --- Executing State: SECONDARY (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:58:22 [INFO] Processing State: SECONDARY (Display 4619827259835644672, MJA: MJA00317866) (secondary_processor.py:95)
2025-05-18 15:58:22 [DEBUG] Secondary page title is displayed. (secondary_page.py:42)
2025-05-18 15:58:22 [INFO] Confirmed on Secondary Page. (secondary_processor.py:90)
2025-05-18 15:58:22 [DEBUG] --- Parsing Secondary Page XML Targeting Specific Attributes --- (secondary_parser.py:33)
2025-05-18 15:58:22 [DEBUG]   Found MJR content-desc: "MJR00240056, Video Remote Interpreting, Appointments : 1" (secondary_parser.py:48)
2025-05-18 15:58:22 [DEBUG]     Extracted MJR ID: MJR00240056 (secondary_parser.py:49)
2025-05-18 15:58:22 [DEBUG]     Extracted Type Hint: Video Remote Interpreting (secondary_parser.py:61)
2025-05-18 15:58:22 [DEBUG]     Extracted Appt Count: 1 (secondary_parser.py:69)
2025-05-18 15:58:22 [DEBUG]   Found MJB ID in text: MJB00251813 (secondary_parser.py:90)
2025-05-18 15:58:22 [DEBUG] --- Secondary Page Targeted Extraction Finished: {'mjb_id_raw': 'MJB00251813', 'mjr_id_raw': 'MJR00240056', 'appointment_count_hint': 1, 'type_hint_raw': 'Video Remote Interpreting'} --- (secondary_parser.py:98)
2025-05-18 15:58:22 [INFO] Saved XML dump: xml_capture_base/MJA00317866/Secondary/Secondary_MJA00317866_MJB00251813_20250518_155822_239804.xml (xml_dumper.py:65)
2025-05-18 15:58:22 [INFO] Extracted from Secondary XML -> MJB: MJB00251813, MJR: MJR00240056, Appt Count: 1, Type Hint: Video Remote Interpreting (secondary_processor.py:130)
2025-05-18 15:58:22 [INFO] Updated secondary IDs & hints for MJA MJA00317866 (MJR set to MJR00240056) (repository.py:124)
2025-05-18 15:58:22 [DEBUG] Attempting to click MJR link element using XPath: //android.view.ViewGroup[@content-desc and starts-with(@content-desc, "MJR00240056")] (secondary_page.py:99)
2025-05-18 15:58:22 [DEBUG] Clicked MJR link element for MJR00240056. (secondary_page.py:105)
2025-05-18 15:58:23 [DEBUG] State updated to DETAIL for session 1 (MJA: MJA00317866, MJR: MJR00240056, LastProcMJA: MJA00317866) (manager.py:111)
2025-05-18 15:58:23 [DEBUG] Processor for SECONDARY finished. State Manager Current State: DETAIL (crawler_service.py:198)
2025-05-18 15:58:24 [INFO] --- Executing State: DETAIL (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:58:24 [INFO] Processing State: DETAIL (Display 4619827259835644672, MJA_trigger: MJA00317866, MJR: MJR00240056) (detail_processor.py:94)
2025-05-18 15:58:24 [DEBUG] Waiting up to 10s for detail page title: 'Booking #MJR' (detail_page.py:50)
2025-05-18 15:58:25 [DEBUG] Detail page title is displayed. (detail_page.py:55)
2025-05-18 15:58:25 [INFO] Successfully confirmed on Detail Page for MJR MJR00240056 (detail_processor.py:98)
2025-05-18 15:58:25 [DEBUG] Header Results: MJR='MJR00240056', Total='£ 55.00', MultiDay=False, LangIdx=4, DateTimeTuple='('23-05-2025 At', '10:00 - 12:30')' (detail_parser.py:129)
2025-05-18 15:58:25 [INFO] Processing Detail for MJR: 'MJR00240056', IsMultiday=False (detail_processor.py:144)
2025-05-18 15:58:25 [INFO] Saved XML dump: xml_capture_base/MJR00240056/Detail_MJR/Detail_MJR_MJR00240056_initial_view_00_20250518_155825_437348.xml (xml_dumper.py:65)
2025-05-18 15:58:25 [DEBUG] Info block scan range: 5 to 9. Processing 4 items: ['Relate London North West (PTC)', 'Cafcass | Interview', 'Faye Webb', '0'] (detail_parser.py:147)
2025-05-18 15:58:25 [DEBUG]   Client Name: 'Relate London North West (PTC)' (detail_parser.py:154)
2025-05-18 15:58:25 [DEBUG]   Booking Type: 'Cafcass | Interview' (detail_parser.py:184)
2025-05-18 15:58:25 [DEBUG]   Contact Name: 'Faye Webb' (detail_parser.py:190)
2025-05-18 15:58:25 [DEBUG]   Contact Phone: '0' (detail_parser.py:196)
2025-05-18 15:58:25 [DEBUG] Sanitized 'contact_phone_raw' from '0' to None. (detail_parser.py:207)
2025-05-18 15:58:25 [DEBUG] Finished parsing info block: {'language_pair_raw': 'English to Polish', 'client_name_raw': 'Relate London North West (PTC)', 'address_line1_raw': None, 'address_line2_raw': None, 'booking_type_raw': 'Cafcass | Interview', 'contact_name_raw': 'Faye Webb', 'contact_phone_raw': None, 'distance_raw': None, 'meeting_link_raw': None} (detail_parser.py:208)
2025-05-18 15:58:25 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:58:25 [DEBUG]   Extracting payments for MJA MJA00317866 (text index 11) up to text index 20 (detail_parser.py:268)
2025-05-18 15:58:25 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:58:25 [INFO] Skipping scroll loop: Disclaimer visible initially or all expected MJA blocks for multiday found. (detail_processor.py:196)
2025-05-18 15:58:25 [INFO] Consolidating all extracted data... (detail_processor.py:209)
2025-05-18 15:58:25 [DEBUG] --- Consolidating and Parsing Detail Data --- (detail_parser.py:333)
2025-05-18 15:58:25 [DEBUG] Final Parsed Detail Data (keys: ['is_multiday', 'mjr_id', 'header_total', 'booking_date', 'start_time', 'end_time', 'duration', 'multiday_date_range', 'multiday_appointment_info', 'mja_id', 'language_pair', 'client_name', 'booking_type', 'contact_name', 'contact_phone', 'meeting_link', 'address', 'travel_distance', 'overall_total', 'notes', 'multiday_payments', 'day_pay_sl', 'day_pay_td', 'day_pay_tt', 'day_pay_aep', 'day_pay_ooh', 'day_pay_urg', 'day_total']) for MJR MJR00240056 (detail_parser.py:483)
2025-05-18 15:58:25 [DEBUG] Final Parsed MJR Data for MJR00240056 (is_multiday: False): {'is_multiday': 0, 'mjr_id': 'MJR00240056', 'header_total': 55.0, 'booking_date': '23-05-2025', 'start_time': '10:00:00', 'end_time': '12:30:00', 'duration': '02:30', 'multiday_date_range': None, 'multiday_appointment_info': None, 'mja_id': 'MJA00317866', 'language_pair': 'English to Polish', 'client_name': 'Relate London North West (PTC)', 'booking_type': 'Cafcass | Interview', 'contact_name': 'Faye Webb', 'contact_phone': None, 'meeting_link': None, 'address': None, 'travel_distance': None, 'overall_total': 55.0, 'notes': 'The session is for separated parents and looks at how their behaviours can impact on their child’s wellbeing following a divorce or separation. It involves a PowerPoint presentation and short videos facilitated by a trainer.', 'multiday_payments': None, 'day_pay_sl': 45.0, 'day_pay_td': None, 'day_pay_tt': None, 'day_pay_aep': 10.0, 'day_pay_ooh': None, 'day_pay_urg': None, 'day_total': 55.0}... (detail_processor.py:218)
2025-05-18 15:58:25 [INFO] Processing SINGLE DAY save for MJA: MJA00317866 (MJR: MJR00240056) (detail_processor.py:278)
2025-05-18 15:58:25 [INFO] Saved/Updated details for booking MJA MJA00317866 (MJR: MJR00240056) (repository.py:189)
2025-05-18 15:58:25 [INFO] Navigating back to list page (Detail -> Secondary -> List)... (detail_processor.py:50)
2025-05-18 15:58:25 [DEBUG] Executing first back() command. (detail_processor.py:51)
2025-05-18 15:58:26 [DEBUG] Executing second back() command. (detail_processor.py:52)
2025-05-18 15:58:28 [INFO] Navigation successful: Confirmed back on list page. (detail_processor.py:55)
2025-05-18 15:58:28 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00317866) (manager.py:111)
2025-05-18 15:58:28 [DEBUG] Processor for DETAIL finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:58:28 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 15:58:28 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 15:58:29 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_155829_084448.xml (xml_dumper.py:65)
2025-05-18 15:58:29 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:58:29 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:58:29 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:58:29 [DEBUG] Found 8 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:58:29 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:58:29 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:58:29 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:58:29 [DEBUG] Processing content-desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:29 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00309647): Extracted MJA ID. Original full desc: 'MJA00309647, 11:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00309647): Parts after MJA ID: ['11:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00309647): Found Duration in part '11:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00309647): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00309647): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:29 [INFO] MJA Parse (MJA00309647): Final parsed data: {'booking_id': 'MJA00309647', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '11:00', 'end_time_raw': '12:00', 'calculated_duration_str': '01:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '11:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:58:29 [DEBUG] Successfully parsed card: MJA00309647, Status: Normal (list_page.py:83)
2025-05-18 15:58:29 [DEBUG] Processing content-desc: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:29 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00218128): Extracted MJA ID. Original full desc: 'MJA00218128, LS1 3BG, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00218128): Parts after MJA ID: ['LS1 3BG', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00218128): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00218128): Found Postcode in part 'LS1 3BG' -> LS1 3BG (mja_parser.py:90)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00218128): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:29 [INFO] MJA Parse (MJA00218128): Final parsed data: {'booking_id': 'MJA00218128', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'LS1 3BG', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:58:29 [DEBUG] Successfully parsed card: MJA00218128, Status: Normal (list_page.py:83)
2025-05-18 15:58:29 [DEBUG] Processing content-desc: 'Viewed, MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:29 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Viewed, MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:29 [INFO] MJA Parse: Found card status 'Viewed' (Prefix: 'Viewed,'). Remaining desc for MJA ID: 'MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:35)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00323444): Extracted MJA ID. Original full desc: 'Viewed, MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00323444): Parts after MJA ID: ['BD1 1LB', '09:30 to 10:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00323444): Found Duration in part '09:30 to 10:00' (mja_parser.py:72)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00323444): Found Postcode in part 'BD1 1LB' -> BD1 1LB (mja_parser.py:90)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00323444): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:29 [INFO] MJA Parse (MJA00323444): Final parsed data: {'booking_id': 'MJA00323444', 'card_status': <BookingCardStatus.VIEWED: 'Viewed'>, 'postcode': 'BD1 1LB', 'start_time_raw': '09:30', 'end_time_raw': '10:00', 'calculated_duration_str': '00:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 10:00'} (mja_parser.py:112)
2025-05-18 15:58:29 [DEBUG] Successfully parsed card: MJA00323444, Status: Viewed (list_page.py:83)
2025-05-18 15:58:29 [DEBUG] Processing content-desc: 'MJA00317866, 10:00 to 12:30, English to Polish' (list_page.py:77)
2025-05-18 15:58:29 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00317866, 10:00 to 12:30, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00317866): Extracted MJA ID. Original full desc: 'MJA00317866, 10:00 to 12:30, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00317866): Parts after MJA ID: ['10:00 to 12:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00317866): Found Duration in part '10:00 to 12:30' (mja_parser.py:72)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00317866): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00317866): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:29 [INFO] MJA Parse (MJA00317866): Final parsed data: {'booking_id': 'MJA00317866', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '12:30', 'calculated_duration_str': '02:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 12:30'} (mja_parser.py:112)
2025-05-18 15:58:29 [DEBUG] Successfully parsed card: MJA00317866, Status: Normal (list_page.py:83)
2025-05-18 15:58:29 [DEBUG] Processing content-desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:29 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00285172): Extracted MJA ID. Original full desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00285172): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00285172): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00285172): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:58:29 [DEBUG] MJA Parse (MJA00285172): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:29 [WARNING] MJA Parse (MJA00285172): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:58:29 [INFO] MJA Parse (MJA00285172): Final parsed data: {'booking_id': 'MJA00285172', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:58:29 [DEBUG] Successfully parsed card: MJA00285172, Status: Normal (list_page.py:83)
2025-05-18 15:58:29 [INFO] Successfully extracted data for 5 cards from list page XML source. (list_page.py:100)
2025-05-18 15:58:29 [INFO] Found data for 5 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:58:29 [DEBUG] Evaluating Card MJA: MJA00309647, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:29 [DEBUG] Card MJA00309647 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:29 [DEBUG] Visibility check for element at y=663, h=70: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:29 [DEBUG] Evaluating Card MJA: MJA00218128, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:29 [DEBUG] Card MJA00218128 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:29 [DEBUG] Visibility check for element at y=887, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:29 [DEBUG] Evaluating Card MJA: MJA00323444, Parsed List Status: Viewed (list_processor.py:169)
2025-05-18 15:58:29 [DEBUG] Card MJA00323444 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:29 [DEBUG] Visibility check for element at y=1505, h=465: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:29 [DEBUG] Evaluating Card MJA: MJA00317866, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:29 [DEBUG] Card MJA00317866 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:29 [DEBUG] Visibility check for element at y=2050, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:29 [DEBUG] Evaluating Card MJA: MJA00285172, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:29 [DEBUG] Card MJA00285172 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:58:29 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:58:29 [INFO] Found 1 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:58:29 [DEBUG] Visibility check for element at y=2668, h=88: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:29 [ERROR] Error locating element for MJA00285172: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:58:29 [INFO] No suitable (fully visible, clickable) 'Normal' unprocessed cards found. (list_processor.py:125)
2025-05-18 15:58:29 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 15:58:29 [INFO] Attempting scroll (current attempt: 1/3) (list_processor.py:297)
2025-05-18 15:58:29 [DEBUG] Using anchor 'MJA00317866' for scroll. (list_processor.py:299)
2025-05-18 15:58:29 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 15:58:29 [DEBUG] Found element containing MJA00317866 to use as scroll anchor. (list_page.py:121)
2025-05-18 15:58:31 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001abad with percent: 0.6 (list_page.py:146)
2025-05-18 15:58:32 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_01_20250518_155832_228861.xml (xml_dumper.py:65)
2025-05-18 15:58:32 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 15:58:32 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 15:58:32 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 15:58:32 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_1.png (crawler_service.py:120)
2025-05-18 15:58:32 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 15:58:32 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (crawler_service.py:127)
2025-05-18 15:58:32 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 15:58:34 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00317866) (manager.py:111)
2025-05-18 15:58:34 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:58:35 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 15:58:35 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 15:58:35 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:58:35 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:58:35 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:58:35 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:58:35 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:58:35 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:58:35 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:58:35 [DEBUG] Processing content-desc: 'MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:35 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00323444): Extracted MJA ID. Original full desc: 'MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00323444): Parts after MJA ID: ['BD1 1LB', '09:30 to 10:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00323444): Found Duration in part '09:30 to 10:00' (mja_parser.py:72)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00323444): Found Postcode in part 'BD1 1LB' -> BD1 1LB (mja_parser.py:90)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00323444): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:35 [INFO] MJA Parse (MJA00323444): Final parsed data: {'booking_id': 'MJA00323444', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'BD1 1LB', 'start_time_raw': '09:30', 'end_time_raw': '10:00', 'calculated_duration_str': '00:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 10:00'} (mja_parser.py:112)
2025-05-18 15:58:35 [DEBUG] Successfully parsed card: MJA00323444, Status: Normal (list_page.py:83)
2025-05-18 15:58:35 [DEBUG] Processing content-desc: 'MJA00317866, 10:00 to 12:30, English to Polish' (list_page.py:77)
2025-05-18 15:58:35 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00317866, 10:00 to 12:30, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00317866): Extracted MJA ID. Original full desc: 'MJA00317866, 10:00 to 12:30, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00317866): Parts after MJA ID: ['10:00 to 12:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00317866): Found Duration in part '10:00 to 12:30' (mja_parser.py:72)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00317866): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00317866): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:35 [INFO] MJA Parse (MJA00317866): Final parsed data: {'booking_id': 'MJA00317866', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '12:30', 'calculated_duration_str': '02:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 12:30'} (mja_parser.py:112)
2025-05-18 15:58:35 [DEBUG] Successfully parsed card: MJA00317866, Status: Normal (list_page.py:83)
2025-05-18 15:58:35 [DEBUG] Processing content-desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:35 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00285172): Extracted MJA ID. Original full desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00285172): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00285172): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00285172): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00285172): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:35 [WARNING] MJA Parse (MJA00285172): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:58:35 [INFO] MJA Parse (MJA00285172): Final parsed data: {'booking_id': 'MJA00285172', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:58:35 [DEBUG] Successfully parsed card: MJA00285172, Status: Normal (list_page.py:83)
2025-05-18 15:58:35 [DEBUG] Processing content-desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:35 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00285173): Extracted MJA ID. Original full desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00285173): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00285173): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00285173): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:58:35 [DEBUG] MJA Parse (MJA00285173): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:35 [WARNING] MJA Parse (MJA00285173): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:58:35 [INFO] MJA Parse (MJA00285173): Final parsed data: {'booking_id': 'MJA00285173', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:58:35 [DEBUG] Successfully parsed card: MJA00285173, Status: Normal (list_page.py:83)
2025-05-18 15:58:35 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:58:35 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:58:35 [DEBUG] Evaluating Card MJA: MJA00323444, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:35 [DEBUG] Card MJA00323444 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:35 [DEBUG] Visibility check for element at y=663, h=322: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:35 [DEBUG] Evaluating Card MJA: MJA00317866, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:35 [DEBUG] Card MJA00317866 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:35 [DEBUG] Visibility check for element at y=1065, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:35 [DEBUG] Evaluating Card MJA: MJA00285172, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:35 [DEBUG] Card MJA00285172 already in processed_ids_this_cycle. Not re-adding to click candidates unless forced. (list_processor.py:193)
2025-05-18 15:58:35 [DEBUG] Card MJA00285172 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:58:35 [DEBUG] Evaluating Card MJA: MJA00285173, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:35 [DEBUG] Card MJA00285173 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:58:35 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:58:35 [INFO] Found 2 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:58:35 [DEBUG] Visibility check for element at y=1683, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:35 [DEBUG] Visibility check for element at y=2301, h=455: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:35 [ERROR] Error locating element for MJA00285173: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:58:35 [INFO] Selected card MJA00285172 (Status: Normal) to click. (list_processor.py:130)
2025-05-18 15:58:35 [INFO] Inserted/Updated base booking record for MJA00285172 with card_status: Normal, db_status: pending (repository.py:75)
2025-05-18 15:58:35 [DEBUG] State updated to SECONDARY for session 1 (MJA: MJA00285172, MJR: None, LastProcMJA: MJA00285172) (manager.py:111)
2025-05-18 15:58:35 [INFO] Attempting click on selected card MJA00285172 (list_processor.py:256)
2025-05-18 15:58:35 [INFO] Clicked card MJA00285172 (list_processor.py:258)
2025-05-18 15:58:37 [DEBUG] Processor for LIST finished. State Manager Current State: SECONDARY (crawler_service.py:198)
2025-05-18 15:58:37 [INFO] --- Executing State: SECONDARY (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:58:37 [INFO] Processing State: SECONDARY (Display 4619827259835644672, MJA: MJA00285172) (secondary_processor.py:95)
2025-05-18 15:58:37 [DEBUG] Secondary page title is displayed. (secondary_page.py:42)
2025-05-18 15:58:37 [INFO] Confirmed on Secondary Page. (secondary_processor.py:90)
2025-05-18 15:58:37 [DEBUG] --- Parsing Secondary Page XML Targeting Specific Attributes --- (secondary_parser.py:33)
2025-05-18 15:58:37 [DEBUG]   Found MJR content-desc: "MJR00212994, Face To Face, Appointments : 4" (secondary_parser.py:48)
2025-05-18 15:58:37 [DEBUG]     Extracted MJR ID: MJR00212994 (secondary_parser.py:49)
2025-05-18 15:58:37 [DEBUG]     Extracted Type Hint: Face To Face (secondary_parser.py:61)
2025-05-18 15:58:37 [DEBUG]     Extracted Appt Count: 4 (secondary_parser.py:69)
2025-05-18 15:58:37 [DEBUG]   Found MJB ID in text: MJB00224128 (secondary_parser.py:90)
2025-05-18 15:58:37 [DEBUG] --- Secondary Page Targeted Extraction Finished: {'mjb_id_raw': 'MJB00224128', 'mjr_id_raw': 'MJR00212994', 'appointment_count_hint': 4, 'type_hint_raw': 'Face To Face'} --- (secondary_parser.py:98)
2025-05-18 15:58:37 [INFO] Saved XML dump: xml_capture_base/MJA00285172/Secondary/Secondary_MJA00285172_MJB00224128_20250518_155837_835153.xml (xml_dumper.py:65)
2025-05-18 15:58:37 [INFO] Extracted from Secondary XML -> MJB: MJB00224128, MJR: MJR00212994, Appt Count: 4, Type Hint: Face To Face (secondary_processor.py:130)
2025-05-18 15:58:37 [INFO] Updated secondary IDs & hints for MJA MJA00285172 (MJR set to MJR00212994) (repository.py:124)
2025-05-18 15:58:37 [DEBUG] Attempting to click MJR link element using XPath: //android.view.ViewGroup[@content-desc and starts-with(@content-desc, "MJR00212994")] (secondary_page.py:99)
2025-05-18 15:58:38 [DEBUG] Clicked MJR link element for MJR00212994. (secondary_page.py:105)
2025-05-18 15:58:39 [DEBUG] State updated to DETAIL for session 1 (MJA: MJA00285172, MJR: MJR00212994, LastProcMJA: MJA00285172) (manager.py:111)
2025-05-18 15:58:39 [DEBUG] Processor for SECONDARY finished. State Manager Current State: DETAIL (crawler_service.py:198)
2025-05-18 15:58:40 [INFO] --- Executing State: DETAIL (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:58:40 [INFO] Processing State: DETAIL (Display 4619827259835644672, MJA_trigger: MJA00285172, MJR: MJR00212994) (detail_processor.py:94)
2025-05-18 15:58:40 [DEBUG] Waiting up to 10s for detail page title: 'Booking #MJR' (detail_page.py:50)
2025-05-18 15:58:41 [DEBUG] Detail page title is displayed. (detail_page.py:55)
2025-05-18 15:58:41 [INFO] Successfully confirmed on Detail Page for MJR MJR00212994 (detail_processor.py:98)
2025-05-18 15:58:41 [DEBUG] Header Results: MJR='MJR00212994', Total='£ 1116.00', MultiDay=True, LangIdx=5, DateTimeTuple='None' (detail_parser.py:129)
2025-05-18 15:58:41 [INFO] Processing Detail for MJR: 'MJR00212994', IsMultiday=True (detail_processor.py:144)
2025-05-18 15:58:41 [INFO] Saved XML dump: xml_capture_base/MJR00212994/Detail_MJR/Detail_MJR_MJR00212994_initial_view_00_20250518_155841_146199.xml (xml_dumper.py:65)
2025-05-18 15:58:41 [DEBUG] Info block scan range: 6 to 13. Processing 7 items: ['Glasgow ET (Dundee)', 'Tribunals Service', 'Endeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'Tribunals - ET | Full hearing', 'Jennifer Paterson', '0300 790 6234', '309.01 Miles'] (detail_parser.py:147)
2025-05-18 15:58:41 [DEBUG]   Client Name: 'Glasgow ET (Dundee)' (detail_parser.py:154)
2025-05-18 15:58:41 [DEBUG]   Address L1: 'Tribunals Service', L2: 'Endeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB' (detail_parser.py:173)
2025-05-18 15:58:41 [DEBUG]   Booking Type: 'Tribunals - ET | Full hearing' (detail_parser.py:184)
2025-05-18 15:58:41 [DEBUG]   Contact Name: 'Jennifer Paterson' (detail_parser.py:190)
2025-05-18 15:58:41 [DEBUG]   Contact Phone: '0300 790 6234' (detail_parser.py:196)
2025-05-18 15:58:41 [DEBUG]   Distance: '309.01 Miles' (detail_parser.py:200)
2025-05-18 15:58:41 [DEBUG] Finished parsing info block: {'language_pair_raw': 'English to Polish', 'client_name_raw': 'Glasgow ET (Dundee)', 'address_line1_raw': 'Tribunals Service', 'address_line2_raw': 'Endeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'booking_type_raw': 'Tribunals - ET | Full hearing', 'contact_name_raw': 'Jennifer Paterson', 'contact_phone_raw': '0300 790 6234', 'distance_raw': '309.01 Miles', 'meeting_link_raw': None} (detail_parser.py:208)
2025-05-18 15:58:41 [DEBUG] Found 2 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:58:41 [DEBUG]   Extracting payments for MJA MJA00285172 (text index 16) up to text index 25 (detail_parser.py:268)
2025-05-18 15:58:41 [DEBUG]   Extracting payments for MJA MJA00285173 (text index 25) up to text index 32 (detail_parser.py:268)
2025-05-18 15:58:41 [DEBUG] Extracted 2 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:58:41 [INFO] Skipping scroll loop: Disclaimer visible initially or all expected MJA blocks for multiday found. (detail_processor.py:196)
2025-05-18 15:58:41 [WARNING] Grand TOTAL anchor for payment not found before disclaimer. (detail_parser.py:324)
2025-05-18 15:58:41 [INFO] Consolidating all extracted data... (detail_processor.py:209)
2025-05-18 15:58:41 [DEBUG] --- Consolidating and Parsing Detail Data --- (detail_parser.py:333)
2025-05-18 15:58:41 [DEBUG] Final Parsed Detail Data (keys: ['is_multiday', 'mjr_id', 'header_total', 'booking_date', 'start_time', 'end_time', 'duration', 'multiday_date_range', 'multiday_appointment_info', 'mja_id', 'language_pair', 'client_name', 'booking_type', 'contact_name', 'contact_phone', 'meeting_link', 'address', 'travel_distance', 'overall_total', 'notes', 'multiday_payments', 'day_pay_sl', 'day_pay_td', 'day_pay_tt', 'day_pay_aep', 'day_pay_ooh', 'day_pay_urg', 'day_total']) for MJR MJR00212994 (detail_parser.py:483)
2025-05-18 15:58:41 [DEBUG] Final Parsed MJR Data for MJR00212994 (is_multiday: True): {'is_multiday': 1, 'mjr_id': 'MJR00212994', 'header_total': 1116.0, 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'multiday_date_range': '27-05-2025 - 30-05-2025', 'multiday_appointment_info': '4 Appointments / 4 Days', 'mja_id': None, 'language_pair': 'English to Polish', 'client_name': 'Glasgow ET (Dundee)', 'booking_type': 'Tribunals - ET | Full hearing', 'contact_name': 'Jennifer Paterson', 'contact_phone': '0300 790 6234', 'meeting_link': None, 'address': 'Tribunals Service\nEndeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'travel_distance': 309.01, 'overall_total': None, 'notes': None, 'multiday_payments': [{'mja': 'MJA00285172', 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'pay_sl': 169.0, 'pay_td': 80.0, 'pay_tt': 20.0, 'pay_aep': 10.0, 'pay_ooh': None, 'pay_urg': None, 'day_total': 279.0}, {'mja': 'MJA00285173', 'booking_date': None, 'start_time': None, 'end_time': N... (detail_processor.py:218)
2025-05-18 15:58:41 [INFO] Processing MULTIDAY save for MJR ID: MJR00212994 (detail_processor.py:221)
2025-05-18 15:58:41 [INFO] Saving 2 MJA entries for MJR MJR00212994. (detail_processor.py:230)
2025-05-18 15:58:41 [ERROR] Cannot save details: 'mja_id' is missing from parsed_data. Data: {'is_multiday': 1, 'mjr_id': 'MJR00212994', 'header_total': 1116.0, 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'multiday_date_range': '27-05-2025 - 30-05-2025', 'multiday_appointment_info': '4 Appointments / 4 Days', 'language_pair': 'English to Polish', 'client_name': 'Glasgow ET (Dundee)', 'booking_type': 'Tribunals - ET | Full hearing', 'contact_name': 'Jennifer Paterson', 'contact_phone': '0300 790 6234', 'meeting_link': None, 'address': 'Tribunals Service\nEndeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'travel_distance': 309.01, 'overall_total': None, 'notes': None, 'mja': 'MJA00285172', 'pay_sl': 169.0, 'pay_td': 80.0, 'pay_tt': 20.0, 'pay_aep': 10.0, 'pay_ooh': None, 'pay_urg': None, 'day_total': 279.0, 'processing_id': 'MJR00212994', 'status': 'scraped', 'scrape_attempt': 0, 'appointment_sequence': 1} (repository.py:136)
2025-05-18 15:58:41 [ERROR] Cannot save details: 'mja_id' is missing from parsed_data. Data: {'is_multiday': 1, 'mjr_id': 'MJR00212994', 'header_total': 1116.0, 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'multiday_date_range': '27-05-2025 - 30-05-2025', 'multiday_appointment_info': '4 Appointments / 4 Days', 'language_pair': 'English to Polish', 'client_name': 'Glasgow ET (Dundee)', 'booking_type': 'Tribunals - ET | Full hearing', 'contact_name': 'Jennifer Paterson', 'contact_phone': '0300 790 6234', 'meeting_link': None, 'address': 'Tribunals Service\nEndeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'travel_distance': 309.01, 'overall_total': None, 'notes': None, 'mja': 'MJA00285173', 'pay_sl': 169.0, 'pay_td': 80.0, 'pay_tt': 20.0, 'pay_aep': None, 'pay_ooh': None, 'pay_urg': None, 'day_total': 269.0, 'processing_id': 'MJR00212994', 'status': 'scraped', 'scrape_attempt': 0, 'appointment_sequence': 2} (repository.py:136)
2025-05-18 15:58:41 [INFO] All MJA days for MJR MJR00212994 processed. (detail_processor.py:263)
2025-05-18 15:58:41 [INFO] Marked MJR MJR00212994 as fully processed for this session (efficiency). (detail_processor.py:269)
2025-05-18 15:58:41 [INFO] Updated status to 'scraped' for 1 MJA records of MJR MJR00212994 (repository.py:270)
2025-05-18 15:58:41 [INFO] Navigating back to list page (Detail -> Secondary -> List)... (detail_processor.py:50)
2025-05-18 15:58:41 [DEBUG] Executing first back() command. (detail_processor.py:51)
2025-05-18 15:58:43 [DEBUG] Executing second back() command. (detail_processor.py:52)
2025-05-18 15:58:44 [INFO] Navigation successful: Confirmed back on list page. (detail_processor.py:55)
2025-05-18 15:58:44 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00285172) (manager.py:111)
2025-05-18 15:58:44 [DEBUG] Processor for DETAIL finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:58:45 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 15:58:45 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 15:58:45 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_155845_487739.xml (xml_dumper.py:65)
2025-05-18 15:58:45 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:58:45 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:58:45 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:58:45 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:58:45 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:58:45 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:58:45 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:58:45 [DEBUG] Processing content-desc: 'MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:45 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00323444): Extracted MJA ID. Original full desc: 'MJA00323444, BD1 1LB, 09:30 to 10:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00323444): Parts after MJA ID: ['BD1 1LB', '09:30 to 10:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00323444): Found Duration in part '09:30 to 10:00' (mja_parser.py:72)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00323444): Found Postcode in part 'BD1 1LB' -> BD1 1LB (mja_parser.py:90)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00323444): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:45 [INFO] MJA Parse (MJA00323444): Final parsed data: {'booking_id': 'MJA00323444', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'BD1 1LB', 'start_time_raw': '09:30', 'end_time_raw': '10:00', 'calculated_duration_str': '00:30', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '09:30 to 10:00'} (mja_parser.py:112)
2025-05-18 15:58:45 [DEBUG] Successfully parsed card: MJA00323444, Status: Normal (list_page.py:83)
2025-05-18 15:58:45 [DEBUG] Processing content-desc: 'MJA00317866, 10:00 to 12:30, English to Polish' (list_page.py:77)
2025-05-18 15:58:45 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00317866, 10:00 to 12:30, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00317866): Extracted MJA ID. Original full desc: 'MJA00317866, 10:00 to 12:30, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00317866): Parts after MJA ID: ['10:00 to 12:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00317866): Found Duration in part '10:00 to 12:30' (mja_parser.py:72)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00317866): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00317866): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:45 [INFO] MJA Parse (MJA00317866): Final parsed data: {'booking_id': 'MJA00317866', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '12:30', 'calculated_duration_str': '02:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 12:30'} (mja_parser.py:112)
2025-05-18 15:58:45 [DEBUG] Successfully parsed card: MJA00317866, Status: Normal (list_page.py:83)
2025-05-18 15:58:45 [DEBUG] Processing content-desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:45 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00285172): Extracted MJA ID. Original full desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00285172): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00285172): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00285172): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00285172): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:45 [WARNING] MJA Parse (MJA00285172): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:58:45 [INFO] MJA Parse (MJA00285172): Final parsed data: {'booking_id': 'MJA00285172', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:58:45 [DEBUG] Successfully parsed card: MJA00285172, Status: Normal (list_page.py:83)
2025-05-18 15:58:45 [DEBUG] Processing content-desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:45 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00285173): Extracted MJA ID. Original full desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00285173): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00285173): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00285173): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:58:45 [DEBUG] MJA Parse (MJA00285173): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:45 [WARNING] MJA Parse (MJA00285173): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:58:45 [INFO] MJA Parse (MJA00285173): Final parsed data: {'booking_id': 'MJA00285173', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:58:45 [DEBUG] Successfully parsed card: MJA00285173, Status: Normal (list_page.py:83)
2025-05-18 15:58:45 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:58:45 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:58:45 [DEBUG] Evaluating Card MJA: MJA00323444, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:45 [DEBUG] Card MJA00323444 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:45 [DEBUG] Visibility check for element at y=663, h=322: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:45 [DEBUG] Evaluating Card MJA: MJA00317866, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:45 [DEBUG] Card MJA00317866 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:45 [DEBUG] Visibility check for element at y=1065, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:45 [DEBUG] Evaluating Card MJA: MJA00285172, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:45 [DEBUG] Card MJA00285172 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:45 [DEBUG] Visibility check for element at y=1683, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:45 [DEBUG] Evaluating Card MJA: MJA00285173, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:45 [DEBUG] Card MJA00285173 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:58:45 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:58:45 [INFO] Found 1 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:58:45 [DEBUG] Visibility check for element at y=2301, h=455: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:45 [ERROR] Error locating element for MJA00285173: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:58:45 [INFO] No suitable (fully visible, clickable) 'Normal' unprocessed cards found. (list_processor.py:125)
2025-05-18 15:58:45 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 15:58:45 [INFO] Attempting scroll (current attempt: 1/3) (list_processor.py:297)
2025-05-18 15:58:45 [DEBUG] Using anchor 'MJA00285172' for scroll. (list_processor.py:299)
2025-05-18 15:58:45 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 15:58:46 [DEBUG] Found element containing MJA00285172 to use as scroll anchor. (list_page.py:121)
2025-05-18 15:58:47 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001adff with percent: 0.6 (list_page.py:146)
2025-05-18 15:58:48 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_01_20250518_155848_532240.xml (xml_dumper.py:65)
2025-05-18 15:58:48 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 15:58:48 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 15:58:48 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 15:58:48 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_1.png (crawler_service.py:120)
2025-05-18 15:58:48 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 15:58:48 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (crawler_service.py:127)
2025-05-18 15:58:48 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 15:58:50 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00285172) (manager.py:111)
2025-05-18 15:58:50 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:58:51 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 15:58:51 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 15:58:51 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:58:51 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:58:51 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:58:51 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:58:51 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:58:51 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:58:51 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:58:51 [DEBUG] Processing content-desc: 'MJA00317866, 10:00 to 12:30, English to Polish' (list_page.py:77)
2025-05-18 15:58:51 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00317866, 10:00 to 12:30, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00317866): Extracted MJA ID. Original full desc: 'MJA00317866, 10:00 to 12:30, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00317866): Parts after MJA ID: ['10:00 to 12:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00317866): Found Duration in part '10:00 to 12:30' (mja_parser.py:72)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00317866): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00317866): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:51 [INFO] MJA Parse (MJA00317866): Final parsed data: {'booking_id': 'MJA00317866', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '12:30', 'calculated_duration_str': '02:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 12:30'} (mja_parser.py:112)
2025-05-18 15:58:51 [DEBUG] Successfully parsed card: MJA00317866, Status: Normal (list_page.py:83)
2025-05-18 15:58:51 [DEBUG] Processing content-desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:51 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285172): Extracted MJA ID. Original full desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285172): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285172): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285172): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285172): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:51 [WARNING] MJA Parse (MJA00285172): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:58:51 [INFO] MJA Parse (MJA00285172): Final parsed data: {'booking_id': 'MJA00285172', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:58:51 [DEBUG] Successfully parsed card: MJA00285172, Status: Normal (list_page.py:83)
2025-05-18 15:58:51 [DEBUG] Processing content-desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:51 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285173): Extracted MJA ID. Original full desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285173): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285173): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285173): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285173): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:51 [WARNING] MJA Parse (MJA00285173): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:58:51 [INFO] MJA Parse (MJA00285173): Final parsed data: {'booking_id': 'MJA00285173', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:58:51 [DEBUG] Successfully parsed card: MJA00285173, Status: Normal (list_page.py:83)
2025-05-18 15:58:51 [DEBUG] Processing content-desc: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:58:51 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285174): Extracted MJA ID. Original full desc: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285174): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285174): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285174): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:58:51 [DEBUG] MJA Parse (MJA00285174): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:58:51 [WARNING] MJA Parse (MJA00285174): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:58:51 [INFO] MJA Parse (MJA00285174): Final parsed data: {'booking_id': 'MJA00285174', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:58:51 [DEBUG] Successfully parsed card: MJA00285174, Status: Normal (list_page.py:83)
2025-05-18 15:58:51 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:58:51 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:58:51 [DEBUG] Evaluating Card MJA: MJA00317866, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:51 [DEBUG] Card MJA00317866 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:51 [DEBUG] Visibility check for element at y=663, h=149: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:51 [DEBUG] Evaluating Card MJA: MJA00285172, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:51 [DEBUG] Card MJA00285172 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:58:51 [DEBUG] Visibility check for element at y=966, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:51 [DEBUG] Evaluating Card MJA: MJA00285173, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:51 [DEBUG] Card MJA00285173 already in processed_ids_this_cycle. Not re-adding to click candidates unless forced. (list_processor.py:193)
2025-05-18 15:58:51 [DEBUG] Card MJA00285173 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:58:51 [DEBUG] Evaluating Card MJA: MJA00285174, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:58:51 [DEBUG] Card MJA00285174 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:58:51 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:58:51 [INFO] Found 2 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:58:51 [DEBUG] Visibility check for element at y=1584, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:51 [DEBUG] Visibility check for element at y=2202, h=464: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:58:51 [ERROR] Error locating element for MJA00285174: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:58:51 [INFO] Selected card MJA00285173 (Status: Normal) to click. (list_processor.py:130)
2025-05-18 15:58:51 [INFO] Inserted/Updated base booking record for MJA00285173 with card_status: Normal, db_status: pending (repository.py:75)
2025-05-18 15:58:51 [DEBUG] State updated to SECONDARY for session 1 (MJA: MJA00285173, MJR: None, LastProcMJA: MJA00285173) (manager.py:111)
2025-05-18 15:58:51 [INFO] Attempting click on selected card MJA00285173 (list_processor.py:256)
2025-05-18 15:58:51 [INFO] Clicked card MJA00285173 (list_processor.py:258)
2025-05-18 15:58:53 [DEBUG] Processor for LIST finished. State Manager Current State: SECONDARY (crawler_service.py:198)
2025-05-18 15:58:53 [INFO] --- Executing State: SECONDARY (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:58:53 [INFO] Processing State: SECONDARY (Display 4619827259835644672, MJA: MJA00285173) (secondary_processor.py:95)
2025-05-18 15:58:54 [DEBUG] Secondary page title is displayed. (secondary_page.py:42)
2025-05-18 15:58:54 [INFO] Confirmed on Secondary Page. (secondary_processor.py:90)
2025-05-18 15:58:54 [DEBUG] --- Parsing Secondary Page XML Targeting Specific Attributes --- (secondary_parser.py:33)
2025-05-18 15:58:54 [DEBUG]   Found MJR content-desc: "MJR00212994, Face To Face, Appointments : 4" (secondary_parser.py:48)
2025-05-18 15:58:54 [DEBUG]     Extracted MJR ID: MJR00212994 (secondary_parser.py:49)
2025-05-18 15:58:54 [DEBUG]     Extracted Type Hint: Face To Face (secondary_parser.py:61)
2025-05-18 15:58:54 [DEBUG]     Extracted Appt Count: 4 (secondary_parser.py:69)
2025-05-18 15:58:54 [DEBUG]   Found MJB ID in text: MJB00224128 (secondary_parser.py:90)
2025-05-18 15:58:54 [DEBUG] --- Secondary Page Targeted Extraction Finished: {'mjb_id_raw': 'MJB00224128', 'mjr_id_raw': 'MJR00212994', 'appointment_count_hint': 4, 'type_hint_raw': 'Face To Face'} --- (secondary_parser.py:98)
2025-05-18 15:58:54 [INFO] Saved XML dump: xml_capture_base/MJA00285173/Secondary/Secondary_MJA00285173_MJB00224128_20250518_155854_067890.xml (xml_dumper.py:65)
2025-05-18 15:58:54 [INFO] Extracted from Secondary XML -> MJB: MJB00224128, MJR: MJR00212994, Appt Count: 4, Type Hint: Face To Face (secondary_processor.py:130)
2025-05-18 15:58:54 [INFO] Updated secondary IDs & hints for MJA MJA00285173 (MJR set to MJR00212994) (repository.py:124)
2025-05-18 15:58:54 [DEBUG] Attempting to click MJR link element using XPath: //android.view.ViewGroup[@content-desc and starts-with(@content-desc, "MJR00212994")] (secondary_page.py:99)
2025-05-18 15:58:54 [DEBUG] Clicked MJR link element for MJR00212994. (secondary_page.py:105)
2025-05-18 15:58:55 [DEBUG] State updated to DETAIL for session 1 (MJA: MJA00285173, MJR: MJR00212994, LastProcMJA: MJA00285173) (manager.py:111)
2025-05-18 15:58:55 [DEBUG] Processor for SECONDARY finished. State Manager Current State: DETAIL (crawler_service.py:198)
2025-05-18 15:58:56 [INFO] --- Executing State: DETAIL (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:58:56 [INFO] Processing State: DETAIL (Display 4619827259835644672, MJA_trigger: MJA00285173, MJR: MJR00212994) (detail_processor.py:94)
2025-05-18 15:58:56 [DEBUG] Waiting up to 10s for detail page title: 'Booking #MJR' (detail_page.py:50)
2025-05-18 15:58:57 [DEBUG] Detail page title is displayed. (detail_page.py:55)
2025-05-18 15:58:57 [INFO] Successfully confirmed on Detail Page for MJR MJR00212994 (detail_processor.py:98)
2025-05-18 15:58:57 [DEBUG] Header Results: MJR='MJR00212994', Total='£ 1116.00', MultiDay=True, LangIdx=5, DateTimeTuple='None' (detail_parser.py:129)
2025-05-18 15:58:57 [INFO] Processing Detail for MJR: 'MJR00212994', IsMultiday=True (detail_processor.py:144)
2025-05-18 15:58:57 [INFO] Saved XML dump: xml_capture_base/MJR00212994/Detail_MJR/Detail_MJR_MJR00212994_initial_view_00_20250518_155857_478424.xml (xml_dumper.py:65)
2025-05-18 15:58:57 [DEBUG] Info block scan range: 6 to 13. Processing 7 items: ['Glasgow ET (Dundee)', 'Tribunals Service', 'Endeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'Tribunals - ET | Full hearing', 'Jennifer Paterson', '0300 790 6234', '309.01 Miles'] (detail_parser.py:147)
2025-05-18 15:58:57 [DEBUG]   Client Name: 'Glasgow ET (Dundee)' (detail_parser.py:154)
2025-05-18 15:58:57 [DEBUG]   Address L1: 'Tribunals Service', L2: 'Endeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB' (detail_parser.py:173)
2025-05-18 15:58:57 [DEBUG]   Booking Type: 'Tribunals - ET | Full hearing' (detail_parser.py:184)
2025-05-18 15:58:57 [DEBUG]   Contact Name: 'Jennifer Paterson' (detail_parser.py:190)
2025-05-18 15:58:57 [DEBUG]   Contact Phone: '0300 790 6234' (detail_parser.py:196)
2025-05-18 15:58:57 [DEBUG]   Distance: '309.01 Miles' (detail_parser.py:200)
2025-05-18 15:58:57 [DEBUG] Finished parsing info block: {'language_pair_raw': 'English to Polish', 'client_name_raw': 'Glasgow ET (Dundee)', 'address_line1_raw': 'Tribunals Service', 'address_line2_raw': 'Endeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'booking_type_raw': 'Tribunals - ET | Full hearing', 'contact_name_raw': 'Jennifer Paterson', 'contact_phone_raw': '0300 790 6234', 'distance_raw': '309.01 Miles', 'meeting_link_raw': None} (detail_parser.py:208)
2025-05-18 15:58:57 [DEBUG] Found 2 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:58:57 [DEBUG]   Extracting payments for MJA MJA00285172 (text index 16) up to text index 25 (detail_parser.py:268)
2025-05-18 15:58:57 [DEBUG]   Extracting payments for MJA MJA00285173 (text index 25) up to text index 32 (detail_parser.py:268)
2025-05-18 15:58:57 [DEBUG] Extracted 2 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:58:58 [INFO] Skipping scroll loop: Disclaimer visible initially or all expected MJA blocks for multiday found. (detail_processor.py:196)
2025-05-18 15:58:58 [WARNING] Grand TOTAL anchor for payment not found before disclaimer. (detail_parser.py:324)
2025-05-18 15:58:58 [INFO] Consolidating all extracted data... (detail_processor.py:209)
2025-05-18 15:58:58 [DEBUG] --- Consolidating and Parsing Detail Data --- (detail_parser.py:333)
2025-05-18 15:58:58 [DEBUG] Final Parsed Detail Data (keys: ['is_multiday', 'mjr_id', 'header_total', 'booking_date', 'start_time', 'end_time', 'duration', 'multiday_date_range', 'multiday_appointment_info', 'mja_id', 'language_pair', 'client_name', 'booking_type', 'contact_name', 'contact_phone', 'meeting_link', 'address', 'travel_distance', 'overall_total', 'notes', 'multiday_payments', 'day_pay_sl', 'day_pay_td', 'day_pay_tt', 'day_pay_aep', 'day_pay_ooh', 'day_pay_urg', 'day_total']) for MJR MJR00212994 (detail_parser.py:483)
2025-05-18 15:58:58 [DEBUG] Final Parsed MJR Data for MJR00212994 (is_multiday: True): {'is_multiday': 1, 'mjr_id': 'MJR00212994', 'header_total': 1116.0, 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'multiday_date_range': '27-05-2025 - 30-05-2025', 'multiday_appointment_info': '4 Appointments / 4 Days', 'mja_id': None, 'language_pair': 'English to Polish', 'client_name': 'Glasgow ET (Dundee)', 'booking_type': 'Tribunals - ET | Full hearing', 'contact_name': 'Jennifer Paterson', 'contact_phone': '0300 790 6234', 'meeting_link': None, 'address': 'Tribunals Service\nEndeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'travel_distance': 309.01, 'overall_total': None, 'notes': None, 'multiday_payments': [{'mja': 'MJA00285172', 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'pay_sl': 169.0, 'pay_td': 80.0, 'pay_tt': 20.0, 'pay_aep': 10.0, 'pay_ooh': None, 'pay_urg': None, 'day_total': 279.0}, {'mja': 'MJA00285173', 'booking_date': None, 'start_time': None, 'end_time': N... (detail_processor.py:218)
2025-05-18 15:58:58 [INFO] Processing MULTIDAY save for MJR ID: MJR00212994 (detail_processor.py:221)
2025-05-18 15:58:58 [INFO] Saving 2 MJA entries for MJR MJR00212994. (detail_processor.py:230)
2025-05-18 15:58:58 [ERROR] Cannot save details: 'mja_id' is missing from parsed_data. Data: {'is_multiday': 1, 'mjr_id': 'MJR00212994', 'header_total': 1116.0, 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'multiday_date_range': '27-05-2025 - 30-05-2025', 'multiday_appointment_info': '4 Appointments / 4 Days', 'language_pair': 'English to Polish', 'client_name': 'Glasgow ET (Dundee)', 'booking_type': 'Tribunals - ET | Full hearing', 'contact_name': 'Jennifer Paterson', 'contact_phone': '0300 790 6234', 'meeting_link': None, 'address': 'Tribunals Service\nEndeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'travel_distance': 309.01, 'overall_total': None, 'notes': None, 'mja': 'MJA00285172', 'pay_sl': 169.0, 'pay_td': 80.0, 'pay_tt': 20.0, 'pay_aep': 10.0, 'pay_ooh': None, 'pay_urg': None, 'day_total': 279.0, 'processing_id': 'MJR00212994', 'status': 'scraped', 'scrape_attempt': 0, 'appointment_sequence': 1} (repository.py:136)
2025-05-18 15:58:58 [ERROR] Cannot save details: 'mja_id' is missing from parsed_data. Data: {'is_multiday': 1, 'mjr_id': 'MJR00212994', 'header_total': 1116.0, 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'multiday_date_range': '27-05-2025 - 30-05-2025', 'multiday_appointment_info': '4 Appointments / 4 Days', 'language_pair': 'English to Polish', 'client_name': 'Glasgow ET (Dundee)', 'booking_type': 'Tribunals - ET | Full hearing', 'contact_name': 'Jennifer Paterson', 'contact_phone': '0300 790 6234', 'meeting_link': None, 'address': 'Tribunals Service\nEndeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'travel_distance': 309.01, 'overall_total': None, 'notes': None, 'mja': 'MJA00285173', 'pay_sl': 169.0, 'pay_td': 80.0, 'pay_tt': 20.0, 'pay_aep': None, 'pay_ooh': None, 'pay_urg': None, 'day_total': 269.0, 'processing_id': 'MJR00212994', 'status': 'scraped', 'scrape_attempt': 0, 'appointment_sequence': 2} (repository.py:136)
2025-05-18 15:58:58 [INFO] All MJA days for MJR MJR00212994 processed. (detail_processor.py:263)
2025-05-18 15:58:58 [INFO] Marked MJR MJR00212994 as fully processed for this session (efficiency). (detail_processor.py:269)
2025-05-18 15:58:58 [INFO] Updated status to 'scraped' for 1 MJA records of MJR MJR00212994 (repository.py:270)
2025-05-18 15:58:58 [INFO] Navigating back to list page (Detail -> Secondary -> List)... (detail_processor.py:50)
2025-05-18 15:58:58 [DEBUG] Executing first back() command. (detail_processor.py:51)
2025-05-18 15:58:59 [DEBUG] Executing second back() command. (detail_processor.py:52)
2025-05-18 15:59:01 [INFO] Navigation successful: Confirmed back on list page. (detail_processor.py:55)
2025-05-18 15:59:01 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00285173) (manager.py:111)
2025-05-18 15:59:01 [DEBUG] Processor for DETAIL finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:59:01 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 15:59:01 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 15:59:02 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_155902_054722.xml (xml_dumper.py:65)
2025-05-18 15:59:02 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:02 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:59:02 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:02 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:59:02 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:59:02 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:59:02 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:59:02 [DEBUG] Processing content-desc: 'MJA00317866, 10:00 to 12:30, English to Polish' (list_page.py:77)
2025-05-18 15:59:02 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00317866, 10:00 to 12:30, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00317866): Extracted MJA ID. Original full desc: 'MJA00317866, 10:00 to 12:30, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00317866): Parts after MJA ID: ['10:00 to 12:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00317866): Found Duration in part '10:00 to 12:30' (mja_parser.py:72)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00317866): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00317866): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:02 [INFO] MJA Parse (MJA00317866): Final parsed data: {'booking_id': 'MJA00317866', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '12:30', 'calculated_duration_str': '02:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 12:30'} (mja_parser.py:112)
2025-05-18 15:59:02 [DEBUG] Successfully parsed card: MJA00317866, Status: Normal (list_page.py:83)
2025-05-18 15:59:02 [DEBUG] Processing content-desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:02 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285172): Extracted MJA ID. Original full desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285172): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285172): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285172): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285172): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:02 [WARNING] MJA Parse (MJA00285172): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:02 [INFO] MJA Parse (MJA00285172): Final parsed data: {'booking_id': 'MJA00285172', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:02 [DEBUG] Successfully parsed card: MJA00285172, Status: Normal (list_page.py:83)
2025-05-18 15:59:02 [DEBUG] Processing content-desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:02 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285173): Extracted MJA ID. Original full desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285173): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285173): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285173): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285173): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:02 [WARNING] MJA Parse (MJA00285173): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:02 [INFO] MJA Parse (MJA00285173): Final parsed data: {'booking_id': 'MJA00285173', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:02 [DEBUG] Successfully parsed card: MJA00285173, Status: Normal (list_page.py:83)
2025-05-18 15:59:02 [DEBUG] Processing content-desc: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:02 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285174): Extracted MJA ID. Original full desc: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285174): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285174): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285174): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:02 [DEBUG] MJA Parse (MJA00285174): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:02 [WARNING] MJA Parse (MJA00285174): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:02 [INFO] MJA Parse (MJA00285174): Final parsed data: {'booking_id': 'MJA00285174', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:02 [DEBUG] Successfully parsed card: MJA00285174, Status: Normal (list_page.py:83)
2025-05-18 15:59:02 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:59:02 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:59:02 [DEBUG] Evaluating Card MJA: MJA00317866, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:02 [DEBUG] Card MJA00317866 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:02 [DEBUG] Visibility check for element at y=663, h=149: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:02 [DEBUG] Evaluating Card MJA: MJA00285172, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:02 [DEBUG] Card MJA00285172 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:02 [DEBUG] Visibility check for element at y=966, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:02 [DEBUG] Evaluating Card MJA: MJA00285173, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:02 [DEBUG] Card MJA00285173 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:02 [DEBUG] Visibility check for element at y=1584, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:02 [DEBUG] Evaluating Card MJA: MJA00285174, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:02 [DEBUG] Card MJA00285174 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:59:02 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:59:02 [INFO] Found 1 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:59:02 [DEBUG] Visibility check for element at y=2202, h=464: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:02 [ERROR] Error locating element for MJA00285174: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:59:02 [INFO] No suitable (fully visible, clickable) 'Normal' unprocessed cards found. (list_processor.py:125)
2025-05-18 15:59:02 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 15:59:02 [INFO] Attempting scroll (current attempt: 1/3) (list_processor.py:297)
2025-05-18 15:59:02 [DEBUG] Using anchor 'MJA00285173' for scroll. (list_processor.py:299)
2025-05-18 15:59:02 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 15:59:02 [DEBUG] Found element containing MJA00285173 to use as scroll anchor. (list_page.py:121)
2025-05-18 15:59:03 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001b077 with percent: 0.6 (list_page.py:146)
2025-05-18 15:59:05 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_01_20250518_155905_074400.xml (xml_dumper.py:65)
2025-05-18 15:59:05 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 15:59:05 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 15:59:05 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 15:59:05 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_1.png (crawler_service.py:120)
2025-05-18 15:59:05 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 15:59:05 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (crawler_service.py:127)
2025-05-18 15:59:05 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 15:59:07 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00285173) (manager.py:111)
2025-05-18 15:59:07 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:59:07 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 15:59:07 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 15:59:08 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:08 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:59:08 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:08 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:59:08 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:59:08 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:59:08 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:59:08 [DEBUG] Processing content-desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:08 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285172): Extracted MJA ID. Original full desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285172): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285172): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285172): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285172): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:08 [WARNING] MJA Parse (MJA00285172): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:08 [INFO] MJA Parse (MJA00285172): Final parsed data: {'booking_id': 'MJA00285172', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:08 [DEBUG] Successfully parsed card: MJA00285172, Status: Normal (list_page.py:83)
2025-05-18 15:59:08 [DEBUG] Processing content-desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:08 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285173): Extracted MJA ID. Original full desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285173): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285173): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285173): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285173): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:08 [WARNING] MJA Parse (MJA00285173): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:08 [INFO] MJA Parse (MJA00285173): Final parsed data: {'booking_id': 'MJA00285173', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:08 [DEBUG] Successfully parsed card: MJA00285173, Status: Normal (list_page.py:83)
2025-05-18 15:59:08 [DEBUG] Processing content-desc: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:08 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285174): Extracted MJA ID. Original full desc: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285174): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285174): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285174): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285174): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:08 [WARNING] MJA Parse (MJA00285174): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:08 [INFO] MJA Parse (MJA00285174): Final parsed data: {'booking_id': 'MJA00285174', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:08 [DEBUG] Successfully parsed card: MJA00285174, Status: Normal (list_page.py:83)
2025-05-18 15:59:08 [DEBUG] Processing content-desc: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:08 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285175): Extracted MJA ID. Original full desc: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285175): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285175): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285175): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:08 [DEBUG] MJA Parse (MJA00285175): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:08 [WARNING] MJA Parse (MJA00285175): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:08 [INFO] MJA Parse (MJA00285175): Final parsed data: {'booking_id': 'MJA00285175', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:08 [DEBUG] Successfully parsed card: MJA00285175, Status: Normal (list_page.py:83)
2025-05-18 15:59:08 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:59:08 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:59:08 [DEBUG] Evaluating Card MJA: MJA00285172, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:08 [DEBUG] Card MJA00285172 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:08 [DEBUG] Visibility check for element at y=663, h=250: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:08 [DEBUG] Evaluating Card MJA: MJA00285173, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:08 [DEBUG] Card MJA00285173 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:08 [DEBUG] Visibility check for element at y=1067, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:08 [DEBUG] Evaluating Card MJA: MJA00285174, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:08 [DEBUG] Card MJA00285174 already in processed_ids_this_cycle. Not re-adding to click candidates unless forced. (list_processor.py:193)
2025-05-18 15:59:08 [DEBUG] Card MJA00285174 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:59:08 [DEBUG] Evaluating Card MJA: MJA00285175, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:08 [DEBUG] Card MJA00285175 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:59:08 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:59:08 [INFO] Found 2 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:59:08 [DEBUG] Visibility check for element at y=1685, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:08 [DEBUG] Visibility check for element at y=2302, h=454: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:08 [ERROR] Error locating element for MJA00285175: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:59:08 [INFO] Selected card MJA00285174 (Status: Normal) to click. (list_processor.py:130)
2025-05-18 15:59:08 [INFO] Inserted/Updated base booking record for MJA00285174 with card_status: Normal, db_status: pending (repository.py:75)
2025-05-18 15:59:08 [DEBUG] State updated to SECONDARY for session 1 (MJA: MJA00285174, MJR: None, LastProcMJA: MJA00285174) (manager.py:111)
2025-05-18 15:59:08 [INFO] Attempting click on selected card MJA00285174 (list_processor.py:256)
2025-05-18 15:59:09 [INFO] Clicked card MJA00285174 (list_processor.py:258)
2025-05-18 15:59:10 [DEBUG] Processor for LIST finished. State Manager Current State: SECONDARY (crawler_service.py:198)
2025-05-18 15:59:11 [INFO] --- Executing State: SECONDARY (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:59:11 [INFO] Processing State: SECONDARY (Display 4619827259835644672, MJA: MJA00285174) (secondary_processor.py:95)
2025-05-18 15:59:11 [DEBUG] Secondary page title is displayed. (secondary_page.py:42)
2025-05-18 15:59:11 [INFO] Confirmed on Secondary Page. (secondary_processor.py:90)
2025-05-18 15:59:11 [DEBUG] --- Parsing Secondary Page XML Targeting Specific Attributes --- (secondary_parser.py:33)
2025-05-18 15:59:11 [DEBUG]   Found MJR content-desc: "MJR00212994, Face To Face, Appointments : 4" (secondary_parser.py:48)
2025-05-18 15:59:11 [DEBUG]     Extracted MJR ID: MJR00212994 (secondary_parser.py:49)
2025-05-18 15:59:11 [DEBUG]     Extracted Type Hint: Face To Face (secondary_parser.py:61)
2025-05-18 15:59:11 [DEBUG]     Extracted Appt Count: 4 (secondary_parser.py:69)
2025-05-18 15:59:11 [DEBUG]   Found MJB ID in text: MJB00224128 (secondary_parser.py:90)
2025-05-18 15:59:11 [DEBUG] --- Secondary Page Targeted Extraction Finished: {'mjb_id_raw': 'MJB00224128', 'mjr_id_raw': 'MJR00212994', 'appointment_count_hint': 4, 'type_hint_raw': 'Face To Face'} --- (secondary_parser.py:98)
2025-05-18 15:59:11 [INFO] Saved XML dump: xml_capture_base/MJA00285174/Secondary/Secondary_MJA00285174_MJB00224128_20250518_155911_071566.xml (xml_dumper.py:65)
2025-05-18 15:59:11 [INFO] Extracted from Secondary XML -> MJB: MJB00224128, MJR: MJR00212994, Appt Count: 4, Type Hint: Face To Face (secondary_processor.py:130)
2025-05-18 15:59:11 [INFO] Updated secondary IDs & hints for MJA MJA00285174 (MJR set to MJR00212994) (repository.py:124)
2025-05-18 15:59:11 [DEBUG] Attempting to click MJR link element using XPath: //android.view.ViewGroup[@content-desc and starts-with(@content-desc, "MJR00212994")] (secondary_page.py:99)
2025-05-18 15:59:11 [DEBUG] Clicked MJR link element for MJR00212994. (secondary_page.py:105)
2025-05-18 15:59:12 [DEBUG] State updated to DETAIL for session 1 (MJA: MJA00285174, MJR: MJR00212994, LastProcMJA: MJA00285174) (manager.py:111)
2025-05-18 15:59:12 [DEBUG] Processor for SECONDARY finished. State Manager Current State: DETAIL (crawler_service.py:198)
2025-05-18 15:59:13 [INFO] --- Executing State: DETAIL (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:59:13 [INFO] Processing State: DETAIL (Display 4619827259835644672, MJA_trigger: MJA00285174, MJR: MJR00212994) (detail_processor.py:94)
2025-05-18 15:59:13 [DEBUG] Waiting up to 10s for detail page title: 'Booking #MJR' (detail_page.py:50)
2025-05-18 15:59:14 [DEBUG] Detail page title is displayed. (detail_page.py:55)
2025-05-18 15:59:14 [INFO] Successfully confirmed on Detail Page for MJR MJR00212994 (detail_processor.py:98)
2025-05-18 15:59:14 [DEBUG] Header Results: MJR='MJR00212994', Total='£ 1116.00', MultiDay=True, LangIdx=5, DateTimeTuple='None' (detail_parser.py:129)
2025-05-18 15:59:14 [INFO] Processing Detail for MJR: 'MJR00212994', IsMultiday=True (detail_processor.py:144)
2025-05-18 15:59:14 [INFO] Saved XML dump: xml_capture_base/MJR00212994/Detail_MJR/Detail_MJR_MJR00212994_initial_view_00_20250518_155914_463936.xml (xml_dumper.py:65)
2025-05-18 15:59:14 [DEBUG] Info block scan range: 6 to 13. Processing 7 items: ['Glasgow ET (Dundee)', 'Tribunals Service', 'Endeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'Tribunals - ET | Full hearing', 'Jennifer Paterson', '0300 790 6234', '309.01 Miles'] (detail_parser.py:147)
2025-05-18 15:59:14 [DEBUG]   Client Name: 'Glasgow ET (Dundee)' (detail_parser.py:154)
2025-05-18 15:59:14 [DEBUG]   Address L1: 'Tribunals Service', L2: 'Endeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB' (detail_parser.py:173)
2025-05-18 15:59:14 [DEBUG]   Booking Type: 'Tribunals - ET | Full hearing' (detail_parser.py:184)
2025-05-18 15:59:14 [DEBUG]   Contact Name: 'Jennifer Paterson' (detail_parser.py:190)
2025-05-18 15:59:14 [DEBUG]   Contact Phone: '0300 790 6234' (detail_parser.py:196)
2025-05-18 15:59:14 [DEBUG]   Distance: '309.01 Miles' (detail_parser.py:200)
2025-05-18 15:59:14 [DEBUG] Finished parsing info block: {'language_pair_raw': 'English to Polish', 'client_name_raw': 'Glasgow ET (Dundee)', 'address_line1_raw': 'Tribunals Service', 'address_line2_raw': 'Endeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'booking_type_raw': 'Tribunals - ET | Full hearing', 'contact_name_raw': 'Jennifer Paterson', 'contact_phone_raw': '0300 790 6234', 'distance_raw': '309.01 Miles', 'meeting_link_raw': None} (detail_parser.py:208)
2025-05-18 15:59:14 [DEBUG] Found 2 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:59:14 [DEBUG]   Extracting payments for MJA MJA00285172 (text index 16) up to text index 25 (detail_parser.py:268)
2025-05-18 15:59:14 [DEBUG]   Extracting payments for MJA MJA00285173 (text index 25) up to text index 32 (detail_parser.py:268)
2025-05-18 15:59:14 [DEBUG] Extracted 2 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:59:15 [INFO] Skipping scroll loop: Disclaimer visible initially or all expected MJA blocks for multiday found. (detail_processor.py:196)
2025-05-18 15:59:15 [WARNING] Grand TOTAL anchor for payment not found before disclaimer. (detail_parser.py:324)
2025-05-18 15:59:15 [INFO] Consolidating all extracted data... (detail_processor.py:209)
2025-05-18 15:59:15 [DEBUG] --- Consolidating and Parsing Detail Data --- (detail_parser.py:333)
2025-05-18 15:59:15 [DEBUG] Final Parsed Detail Data (keys: ['is_multiday', 'mjr_id', 'header_total', 'booking_date', 'start_time', 'end_time', 'duration', 'multiday_date_range', 'multiday_appointment_info', 'mja_id', 'language_pair', 'client_name', 'booking_type', 'contact_name', 'contact_phone', 'meeting_link', 'address', 'travel_distance', 'overall_total', 'notes', 'multiday_payments', 'day_pay_sl', 'day_pay_td', 'day_pay_tt', 'day_pay_aep', 'day_pay_ooh', 'day_pay_urg', 'day_total']) for MJR MJR00212994 (detail_parser.py:483)
2025-05-18 15:59:15 [DEBUG] Final Parsed MJR Data for MJR00212994 (is_multiday: True): {'is_multiday': 1, 'mjr_id': 'MJR00212994', 'header_total': 1116.0, 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'multiday_date_range': '27-05-2025 - 30-05-2025', 'multiday_appointment_info': '4 Appointments / 4 Days', 'mja_id': None, 'language_pair': 'English to Polish', 'client_name': 'Glasgow ET (Dundee)', 'booking_type': 'Tribunals - ET | Full hearing', 'contact_name': 'Jennifer Paterson', 'contact_phone': '0300 790 6234', 'meeting_link': None, 'address': 'Tribunals Service\nEndeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'travel_distance': 309.01, 'overall_total': None, 'notes': None, 'multiday_payments': [{'mja': 'MJA00285172', 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'pay_sl': 169.0, 'pay_td': 80.0, 'pay_tt': 20.0, 'pay_aep': 10.0, 'pay_ooh': None, 'pay_urg': None, 'day_total': 279.0}, {'mja': 'MJA00285173', 'booking_date': None, 'start_time': None, 'end_time': N... (detail_processor.py:218)
2025-05-18 15:59:15 [INFO] Processing MULTIDAY save for MJR ID: MJR00212994 (detail_processor.py:221)
2025-05-18 15:59:15 [INFO] Saving 2 MJA entries for MJR MJR00212994. (detail_processor.py:230)
2025-05-18 15:59:15 [ERROR] Cannot save details: 'mja_id' is missing from parsed_data. Data: {'is_multiday': 1, 'mjr_id': 'MJR00212994', 'header_total': 1116.0, 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'multiday_date_range': '27-05-2025 - 30-05-2025', 'multiday_appointment_info': '4 Appointments / 4 Days', 'language_pair': 'English to Polish', 'client_name': 'Glasgow ET (Dundee)', 'booking_type': 'Tribunals - ET | Full hearing', 'contact_name': 'Jennifer Paterson', 'contact_phone': '0300 790 6234', 'meeting_link': None, 'address': 'Tribunals Service\nEndeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'travel_distance': 309.01, 'overall_total': None, 'notes': None, 'mja': 'MJA00285172', 'pay_sl': 169.0, 'pay_td': 80.0, 'pay_tt': 20.0, 'pay_aep': 10.0, 'pay_ooh': None, 'pay_urg': None, 'day_total': 279.0, 'processing_id': 'MJR00212994', 'status': 'scraped', 'scrape_attempt': 0, 'appointment_sequence': 1} (repository.py:136)
2025-05-18 15:59:15 [ERROR] Cannot save details: 'mja_id' is missing from parsed_data. Data: {'is_multiday': 1, 'mjr_id': 'MJR00212994', 'header_total': 1116.0, 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'multiday_date_range': '27-05-2025 - 30-05-2025', 'multiday_appointment_info': '4 Appointments / 4 Days', 'language_pair': 'English to Polish', 'client_name': 'Glasgow ET (Dundee)', 'booking_type': 'Tribunals - ET | Full hearing', 'contact_name': 'Jennifer Paterson', 'contact_phone': '0300 790 6234', 'meeting_link': None, 'address': 'Tribunals Service\nEndeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'travel_distance': 309.01, 'overall_total': None, 'notes': None, 'mja': 'MJA00285173', 'pay_sl': 169.0, 'pay_td': 80.0, 'pay_tt': 20.0, 'pay_aep': None, 'pay_ooh': None, 'pay_urg': None, 'day_total': 269.0, 'processing_id': 'MJR00212994', 'status': 'scraped', 'scrape_attempt': 0, 'appointment_sequence': 2} (repository.py:136)
2025-05-18 15:59:15 [INFO] All MJA days for MJR MJR00212994 processed. (detail_processor.py:263)
2025-05-18 15:59:15 [INFO] Marked MJR MJR00212994 as fully processed for this session (efficiency). (detail_processor.py:269)
2025-05-18 15:59:15 [INFO] Updated status to 'scraped' for 1 MJA records of MJR MJR00212994 (repository.py:270)
2025-05-18 15:59:15 [INFO] Navigating back to list page (Detail -> Secondary -> List)... (detail_processor.py:50)
2025-05-18 15:59:15 [DEBUG] Executing first back() command. (detail_processor.py:51)
2025-05-18 15:59:16 [DEBUG] Executing second back() command. (detail_processor.py:52)
2025-05-18 15:59:18 [INFO] Navigation successful: Confirmed back on list page. (detail_processor.py:55)
2025-05-18 15:59:18 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00285174) (manager.py:111)
2025-05-18 15:59:18 [DEBUG] Processor for DETAIL finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:59:18 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 15:59:18 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 15:59:18 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_155918_756915.xml (xml_dumper.py:65)
2025-05-18 15:59:18 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:18 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:59:18 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:18 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:59:18 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:59:18 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:59:18 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:59:18 [DEBUG] Processing content-desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:18 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285172): Extracted MJA ID. Original full desc: 'MJA00285172, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285172): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285172): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285172): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285172): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:18 [WARNING] MJA Parse (MJA00285172): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:18 [INFO] MJA Parse (MJA00285172): Final parsed data: {'booking_id': 'MJA00285172', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:18 [DEBUG] Successfully parsed card: MJA00285172, Status: Normal (list_page.py:83)
2025-05-18 15:59:18 [DEBUG] Processing content-desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:18 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285173): Extracted MJA ID. Original full desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285173): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285173): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285173): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285173): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:18 [WARNING] MJA Parse (MJA00285173): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:18 [INFO] MJA Parse (MJA00285173): Final parsed data: {'booking_id': 'MJA00285173', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:18 [DEBUG] Successfully parsed card: MJA00285173, Status: Normal (list_page.py:83)
2025-05-18 15:59:18 [DEBUG] Processing content-desc: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:18 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285174): Extracted MJA ID. Original full desc: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285174): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285174): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285174): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285174): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:18 [WARNING] MJA Parse (MJA00285174): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:18 [INFO] MJA Parse (MJA00285174): Final parsed data: {'booking_id': 'MJA00285174', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:18 [DEBUG] Successfully parsed card: MJA00285174, Status: Normal (list_page.py:83)
2025-05-18 15:59:18 [DEBUG] Processing content-desc: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:18 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285175): Extracted MJA ID. Original full desc: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285175): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285175): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285175): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:18 [DEBUG] MJA Parse (MJA00285175): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:18 [WARNING] MJA Parse (MJA00285175): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:18 [INFO] MJA Parse (MJA00285175): Final parsed data: {'booking_id': 'MJA00285175', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:18 [DEBUG] Successfully parsed card: MJA00285175, Status: Normal (list_page.py:83)
2025-05-18 15:59:18 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:59:18 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:59:18 [DEBUG] Evaluating Card MJA: MJA00285172, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:18 [DEBUG] Card MJA00285172 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:19 [DEBUG] Visibility check for element at y=663, h=250: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:19 [DEBUG] Evaluating Card MJA: MJA00285173, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:19 [DEBUG] Card MJA00285173 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:19 [DEBUG] Visibility check for element at y=1067, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:19 [DEBUG] Evaluating Card MJA: MJA00285174, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:19 [DEBUG] Card MJA00285174 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:19 [DEBUG] Visibility check for element at y=1685, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:19 [DEBUG] Evaluating Card MJA: MJA00285175, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:19 [DEBUG] Card MJA00285175 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:59:19 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:59:19 [INFO] Found 1 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:59:19 [DEBUG] Visibility check for element at y=2302, h=454: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:19 [ERROR] Error locating element for MJA00285175: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:59:19 [INFO] No suitable (fully visible, clickable) 'Normal' unprocessed cards found. (list_processor.py:125)
2025-05-18 15:59:19 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 15:59:19 [INFO] Attempting scroll (current attempt: 1/3) (list_processor.py:297)
2025-05-18 15:59:19 [DEBUG] Using anchor 'MJA00285174' for scroll. (list_processor.py:299)
2025-05-18 15:59:19 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 15:59:19 [DEBUG] Found element containing MJA00285174 to use as scroll anchor. (list_page.py:121)
2025-05-18 15:59:20 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001b2f2 with percent: 0.6 (list_page.py:146)
2025-05-18 15:59:21 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_01_20250518_155921_923426.xml (xml_dumper.py:65)
2025-05-18 15:59:21 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 15:59:22 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 15:59:22 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 15:59:22 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_1.png (crawler_service.py:120)
2025-05-18 15:59:22 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 15:59:22 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (crawler_service.py:127)
2025-05-18 15:59:22 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 15:59:24 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00285174) (manager.py:111)
2025-05-18 15:59:24 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:59:24 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 15:59:24 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 15:59:24 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:24 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:59:24 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:24 [DEBUG] Found 8 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:59:24 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:59:24 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:59:24 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:59:24 [DEBUG] Processing content-desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:24 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285173): Extracted MJA ID. Original full desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285173): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285173): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285173): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285173): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:24 [WARNING] MJA Parse (MJA00285173): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:24 [INFO] MJA Parse (MJA00285173): Final parsed data: {'booking_id': 'MJA00285173', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:24 [DEBUG] Successfully parsed card: MJA00285173, Status: Normal (list_page.py:83)
2025-05-18 15:59:24 [DEBUG] Processing content-desc: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:24 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285174): Extracted MJA ID. Original full desc: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285174): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285174): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285174): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285174): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:24 [WARNING] MJA Parse (MJA00285174): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:24 [INFO] MJA Parse (MJA00285174): Final parsed data: {'booking_id': 'MJA00285174', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:24 [DEBUG] Successfully parsed card: MJA00285174, Status: Normal (list_page.py:83)
2025-05-18 15:59:24 [DEBUG] Processing content-desc: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:24 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285175): Extracted MJA ID. Original full desc: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285175): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285175): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285175): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00285175): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:24 [WARNING] MJA Parse (MJA00285175): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:24 [INFO] MJA Parse (MJA00285175): Final parsed data: {'booking_id': 'MJA00285175', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:24 [DEBUG] Successfully parsed card: MJA00285175, Status: Normal (list_page.py:83)
2025-05-18 15:59:24 [DEBUG] Processing content-desc: 'MJA00302426, 10:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:24 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00302426, 10:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00302426): Extracted MJA ID. Original full desc: 'MJA00302426, 10:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00302426): Parts after MJA ID: ['10:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00302426): Found Duration in part '10:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00302426): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00302426): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:24 [INFO] MJA Parse (MJA00302426): Final parsed data: {'booking_id': 'MJA00302426', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '12:00', 'calculated_duration_str': '02:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:59:24 [DEBUG] Successfully parsed card: MJA00302426, Status: Normal (list_page.py:83)
2025-05-18 15:59:24 [DEBUG] Processing content-desc: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:24 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:24 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00202042): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00202042): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00202042): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00202042): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 15:59:24 [DEBUG] MJA Parse (MJA00202042): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:24 [INFO] MJA Parse (MJA00202042): Final parsed data: {'booking_id': 'MJA00202042', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:59:24 [DEBUG] Successfully parsed card: MJA00202042, Status: Cancelled (list_page.py:83)
2025-05-18 15:59:24 [INFO] Successfully extracted data for 5 cards from list page XML source. (list_page.py:100)
2025-05-18 15:59:24 [INFO] Found data for 5 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:59:24 [DEBUG] Evaluating Card MJA: MJA00285173, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:24 [DEBUG] Card MJA00285173 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:25 [DEBUG] Visibility check for element at y=663, h=64: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:25 [DEBUG] Evaluating Card MJA: MJA00285174, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:25 [DEBUG] Card MJA00285174 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:25 [DEBUG] Visibility check for element at y=881, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:25 [DEBUG] Evaluating Card MJA: MJA00285175, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:25 [DEBUG] Card MJA00285175 already in processed_ids_this_cycle. Not re-adding to click candidates unless forced. (list_processor.py:193)
2025-05-18 15:59:25 [DEBUG] Card MJA00285175 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:59:25 [DEBUG] Evaluating Card MJA: MJA00302426, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:25 [DEBUG] Card MJA00302426 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:59:25 [DEBUG] Evaluating Card MJA: MJA00202042, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 15:59:25 [INFO] Booking MJA00202042 is CANCELLED on list. Saving base info, status, and skipping detail scrape. (list_processor.py:213)
2025-05-18 15:59:25 [INFO] Inserted/Updated base booking record for MJA00202042 with card_status: Cancelled, db_status: cancelled_on_list (repository.py:75)
2025-05-18 15:59:25 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:59:25 [INFO] Found 2 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:59:25 [DEBUG] Visibility check for element at y=1498, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:25 [DEBUG] Visibility check for element at y=2116, h=464: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:25 [ERROR] Error locating element for MJA00302426: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:59:25 [INFO] Selected card MJA00285175 (Status: Normal) to click. (list_processor.py:130)
2025-05-18 15:59:25 [INFO] Inserted/Updated base booking record for MJA00285175 with card_status: Normal, db_status: pending (repository.py:75)
2025-05-18 15:59:25 [DEBUG] State updated to SECONDARY for session 1 (MJA: MJA00285175, MJR: None, LastProcMJA: MJA00285175) (manager.py:111)
2025-05-18 15:59:25 [INFO] Attempting click on selected card MJA00285175 (list_processor.py:256)
2025-05-18 15:59:25 [INFO] Clicked card MJA00285175 (list_processor.py:258)
2025-05-18 15:59:26 [DEBUG] Processor for LIST finished. State Manager Current State: SECONDARY (crawler_service.py:198)
2025-05-18 15:59:27 [INFO] --- Executing State: SECONDARY (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:59:27 [INFO] Processing State: SECONDARY (Display 4619827259835644672, MJA: MJA00285175) (secondary_processor.py:95)
2025-05-18 15:59:27 [DEBUG] Secondary page title is displayed. (secondary_page.py:42)
2025-05-18 15:59:27 [INFO] Confirmed on Secondary Page. (secondary_processor.py:90)
2025-05-18 15:59:27 [DEBUG] --- Parsing Secondary Page XML Targeting Specific Attributes --- (secondary_parser.py:33)
2025-05-18 15:59:27 [DEBUG]   Found MJR content-desc: "MJR00212994, Face To Face, Appointments : 4" (secondary_parser.py:48)
2025-05-18 15:59:27 [DEBUG]     Extracted MJR ID: MJR00212994 (secondary_parser.py:49)
2025-05-18 15:59:27 [DEBUG]     Extracted Type Hint: Face To Face (secondary_parser.py:61)
2025-05-18 15:59:27 [DEBUG]     Extracted Appt Count: 4 (secondary_parser.py:69)
2025-05-18 15:59:27 [DEBUG]   Found MJB ID in text: MJB00224128 (secondary_parser.py:90)
2025-05-18 15:59:27 [DEBUG] --- Secondary Page Targeted Extraction Finished: {'mjb_id_raw': 'MJB00224128', 'mjr_id_raw': 'MJR00212994', 'appointment_count_hint': 4, 'type_hint_raw': 'Face To Face'} --- (secondary_parser.py:98)
2025-05-18 15:59:27 [INFO] Saved XML dump: xml_capture_base/MJA00285175/Secondary/Secondary_MJA00285175_MJB00224128_20250518_155927_549666.xml (xml_dumper.py:65)
2025-05-18 15:59:27 [INFO] Extracted from Secondary XML -> MJB: MJB00224128, MJR: MJR00212994, Appt Count: 4, Type Hint: Face To Face (secondary_processor.py:130)
2025-05-18 15:59:27 [INFO] Updated secondary IDs & hints for MJA MJA00285175 (MJR set to MJR00212994) (repository.py:124)
2025-05-18 15:59:27 [DEBUG] Attempting to click MJR link element using XPath: //android.view.ViewGroup[@content-desc and starts-with(@content-desc, "MJR00212994")] (secondary_page.py:99)
2025-05-18 15:59:27 [DEBUG] Clicked MJR link element for MJR00212994. (secondary_page.py:105)
2025-05-18 15:59:29 [DEBUG] State updated to DETAIL for session 1 (MJA: MJA00285175, MJR: MJR00212994, LastProcMJA: MJA00285175) (manager.py:111)
2025-05-18 15:59:29 [DEBUG] Processor for SECONDARY finished. State Manager Current State: DETAIL (crawler_service.py:198)
2025-05-18 15:59:29 [INFO] --- Executing State: DETAIL (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:59:29 [INFO] Processing State: DETAIL (Display 4619827259835644672, MJA_trigger: MJA00285175, MJR: MJR00212994) (detail_processor.py:94)
2025-05-18 15:59:29 [DEBUG] Waiting up to 10s for detail page title: 'Booking #MJR' (detail_page.py:50)
2025-05-18 15:59:30 [DEBUG] Detail page title is displayed. (detail_page.py:55)
2025-05-18 15:59:30 [INFO] Successfully confirmed on Detail Page for MJR MJR00212994 (detail_processor.py:98)
2025-05-18 15:59:30 [DEBUG] Header Results: MJR='MJR00212994', Total='£ 1116.00', MultiDay=True, LangIdx=5, DateTimeTuple='None' (detail_parser.py:129)
2025-05-18 15:59:30 [INFO] Processing Detail for MJR: 'MJR00212994', IsMultiday=True (detail_processor.py:144)
2025-05-18 15:59:30 [INFO] Saved XML dump: xml_capture_base/MJR00212994/Detail_MJR/Detail_MJR_MJR00212994_initial_view_00_20250518_155930_808357.xml (xml_dumper.py:65)
2025-05-18 15:59:30 [DEBUG] Info block scan range: 6 to 13. Processing 7 items: ['Glasgow ET (Dundee)', 'Tribunals Service', 'Endeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'Tribunals - ET | Full hearing', 'Jennifer Paterson', '0300 790 6234', '309.01 Miles'] (detail_parser.py:147)
2025-05-18 15:59:30 [DEBUG]   Client Name: 'Glasgow ET (Dundee)' (detail_parser.py:154)
2025-05-18 15:59:30 [DEBUG]   Address L1: 'Tribunals Service', L2: 'Endeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB' (detail_parser.py:173)
2025-05-18 15:59:30 [DEBUG]   Booking Type: 'Tribunals - ET | Full hearing' (detail_parser.py:184)
2025-05-18 15:59:30 [DEBUG]   Contact Name: 'Jennifer Paterson' (detail_parser.py:190)
2025-05-18 15:59:30 [DEBUG]   Contact Phone: '0300 790 6234' (detail_parser.py:196)
2025-05-18 15:59:30 [DEBUG]   Distance: '309.01 Miles' (detail_parser.py:200)
2025-05-18 15:59:30 [DEBUG] Finished parsing info block: {'language_pair_raw': 'English to Polish', 'client_name_raw': 'Glasgow ET (Dundee)', 'address_line1_raw': 'Tribunals Service', 'address_line2_raw': 'Endeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'booking_type_raw': 'Tribunals - ET | Full hearing', 'contact_name_raw': 'Jennifer Paterson', 'contact_phone_raw': '0300 790 6234', 'distance_raw': '309.01 Miles', 'meeting_link_raw': None} (detail_parser.py:208)
2025-05-18 15:59:30 [DEBUG] Found 2 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:59:30 [DEBUG]   Extracting payments for MJA MJA00285172 (text index 16) up to text index 25 (detail_parser.py:268)
2025-05-18 15:59:30 [DEBUG]   Extracting payments for MJA MJA00285173 (text index 25) up to text index 32 (detail_parser.py:268)
2025-05-18 15:59:30 [DEBUG] Extracted 2 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:59:31 [INFO] Skipping scroll loop: Disclaimer visible initially or all expected MJA blocks for multiday found. (detail_processor.py:196)
2025-05-18 15:59:31 [WARNING] Grand TOTAL anchor for payment not found before disclaimer. (detail_parser.py:324)
2025-05-18 15:59:31 [INFO] Consolidating all extracted data... (detail_processor.py:209)
2025-05-18 15:59:31 [DEBUG] --- Consolidating and Parsing Detail Data --- (detail_parser.py:333)
2025-05-18 15:59:31 [DEBUG] Final Parsed Detail Data (keys: ['is_multiday', 'mjr_id', 'header_total', 'booking_date', 'start_time', 'end_time', 'duration', 'multiday_date_range', 'multiday_appointment_info', 'mja_id', 'language_pair', 'client_name', 'booking_type', 'contact_name', 'contact_phone', 'meeting_link', 'address', 'travel_distance', 'overall_total', 'notes', 'multiday_payments', 'day_pay_sl', 'day_pay_td', 'day_pay_tt', 'day_pay_aep', 'day_pay_ooh', 'day_pay_urg', 'day_total']) for MJR MJR00212994 (detail_parser.py:483)
2025-05-18 15:59:31 [DEBUG] Final Parsed MJR Data for MJR00212994 (is_multiday: True): {'is_multiday': 1, 'mjr_id': 'MJR00212994', 'header_total': 1116.0, 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'multiday_date_range': '27-05-2025 - 30-05-2025', 'multiday_appointment_info': '4 Appointments / 4 Days', 'mja_id': None, 'language_pair': 'English to Polish', 'client_name': 'Glasgow ET (Dundee)', 'booking_type': 'Tribunals - ET | Full hearing', 'contact_name': 'Jennifer Paterson', 'contact_phone': '0300 790 6234', 'meeting_link': None, 'address': 'Tribunals Service\nEndeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'travel_distance': 309.01, 'overall_total': None, 'notes': None, 'multiday_payments': [{'mja': 'MJA00285172', 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'pay_sl': 169.0, 'pay_td': 80.0, 'pay_tt': 20.0, 'pay_aep': 10.0, 'pay_ooh': None, 'pay_urg': None, 'day_total': 279.0}, {'mja': 'MJA00285173', 'booking_date': None, 'start_time': None, 'end_time': N... (detail_processor.py:218)
2025-05-18 15:59:31 [INFO] Processing MULTIDAY save for MJR ID: MJR00212994 (detail_processor.py:221)
2025-05-18 15:59:31 [INFO] Saving 2 MJA entries for MJR MJR00212994. (detail_processor.py:230)
2025-05-18 15:59:31 [ERROR] Cannot save details: 'mja_id' is missing from parsed_data. Data: {'is_multiday': 1, 'mjr_id': 'MJR00212994', 'header_total': 1116.0, 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'multiday_date_range': '27-05-2025 - 30-05-2025', 'multiday_appointment_info': '4 Appointments / 4 Days', 'language_pair': 'English to Polish', 'client_name': 'Glasgow ET (Dundee)', 'booking_type': 'Tribunals - ET | Full hearing', 'contact_name': 'Jennifer Paterson', 'contact_phone': '0300 790 6234', 'meeting_link': None, 'address': 'Tribunals Service\nEndeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'travel_distance': 309.01, 'overall_total': None, 'notes': None, 'mja': 'MJA00285172', 'pay_sl': 169.0, 'pay_td': 80.0, 'pay_tt': 20.0, 'pay_aep': 10.0, 'pay_ooh': None, 'pay_urg': None, 'day_total': 279.0, 'processing_id': 'MJR00212994', 'status': 'scraped', 'scrape_attempt': 0, 'appointment_sequence': 1} (repository.py:136)
2025-05-18 15:59:31 [ERROR] Cannot save details: 'mja_id' is missing from parsed_data. Data: {'is_multiday': 1, 'mjr_id': 'MJR00212994', 'header_total': 1116.0, 'booking_date': None, 'start_time': None, 'end_time': None, 'duration': None, 'multiday_date_range': '27-05-2025 - 30-05-2025', 'multiday_appointment_info': '4 Appointments / 4 Days', 'language_pair': 'English to Polish', 'client_name': 'Glasgow ET (Dundee)', 'booking_type': 'Tribunals - ET | Full hearing', 'contact_name': 'Jennifer Paterson', 'contact_phone': '0300 790 6234', 'meeting_link': None, 'address': 'Tribunals Service\nEndeavour House 1 Greenmarket Dundee Scotland Endeavour House, 1 Greenmarket, Dundee, DD1 4QB', 'travel_distance': 309.01, 'overall_total': None, 'notes': None, 'mja': 'MJA00285173', 'pay_sl': 169.0, 'pay_td': 80.0, 'pay_tt': 20.0, 'pay_aep': None, 'pay_ooh': None, 'pay_urg': None, 'day_total': 269.0, 'processing_id': 'MJR00212994', 'status': 'scraped', 'scrape_attempt': 0, 'appointment_sequence': 2} (repository.py:136)
2025-05-18 15:59:31 [INFO] All MJA days for MJR MJR00212994 processed. (detail_processor.py:263)
2025-05-18 15:59:31 [INFO] Marked MJR MJR00212994 as fully processed for this session (efficiency). (detail_processor.py:269)
2025-05-18 15:59:31 [INFO] Updated status to 'scraped' for 1 MJA records of MJR MJR00212994 (repository.py:270)
2025-05-18 15:59:31 [INFO] Navigating back to list page (Detail -> Secondary -> List)... (detail_processor.py:50)
2025-05-18 15:59:31 [DEBUG] Executing first back() command. (detail_processor.py:51)
2025-05-18 15:59:32 [DEBUG] Executing second back() command. (detail_processor.py:52)
2025-05-18 15:59:34 [INFO] Navigation successful: Confirmed back on list page. (detail_processor.py:55)
2025-05-18 15:59:34 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00285175) (manager.py:111)
2025-05-18 15:59:34 [DEBUG] Processor for DETAIL finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:59:34 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 15:59:34 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 15:59:35 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_155935_069719.xml (xml_dumper.py:65)
2025-05-18 15:59:35 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:35 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:59:35 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:35 [DEBUG] Found 8 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:59:35 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:59:35 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:59:35 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:59:35 [DEBUG] Processing content-desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:35 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285173): Extracted MJA ID. Original full desc: 'MJA00285173, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285173): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285173): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285173): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285173): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:35 [WARNING] MJA Parse (MJA00285173): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:35 [INFO] MJA Parse (MJA00285173): Final parsed data: {'booking_id': 'MJA00285173', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:35 [DEBUG] Successfully parsed card: MJA00285173, Status: Normal (list_page.py:83)
2025-05-18 15:59:35 [DEBUG] Processing content-desc: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:35 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285174): Extracted MJA ID. Original full desc: 'MJA00285174, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285174): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285174): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285174): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285174): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:35 [WARNING] MJA Parse (MJA00285174): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:35 [INFO] MJA Parse (MJA00285174): Final parsed data: {'booking_id': 'MJA00285174', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:35 [DEBUG] Successfully parsed card: MJA00285174, Status: Normal (list_page.py:83)
2025-05-18 15:59:35 [DEBUG] Processing content-desc: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:35 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285175): Extracted MJA ID. Original full desc: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285175): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285175): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285175): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00285175): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:35 [WARNING] MJA Parse (MJA00285175): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:35 [INFO] MJA Parse (MJA00285175): Final parsed data: {'booking_id': 'MJA00285175', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:35 [DEBUG] Successfully parsed card: MJA00285175, Status: Normal (list_page.py:83)
2025-05-18 15:59:35 [DEBUG] Processing content-desc: 'MJA00302426, 10:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:35 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00302426, 10:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00302426): Extracted MJA ID. Original full desc: 'MJA00302426, 10:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00302426): Parts after MJA ID: ['10:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00302426): Found Duration in part '10:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00302426): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00302426): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:35 [INFO] MJA Parse (MJA00302426): Final parsed data: {'booking_id': 'MJA00302426', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '12:00', 'calculated_duration_str': '02:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:59:35 [DEBUG] Successfully parsed card: MJA00302426, Status: Normal (list_page.py:83)
2025-05-18 15:59:35 [DEBUG] Processing content-desc: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:35 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:35 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00202042): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00202042): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00202042): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00202042): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 15:59:35 [DEBUG] MJA Parse (MJA00202042): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:35 [INFO] MJA Parse (MJA00202042): Final parsed data: {'booking_id': 'MJA00202042', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:59:35 [DEBUG] Successfully parsed card: MJA00202042, Status: Cancelled (list_page.py:83)
2025-05-18 15:59:35 [INFO] Successfully extracted data for 5 cards from list page XML source. (list_page.py:100)
2025-05-18 15:59:35 [INFO] Found data for 5 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:59:35 [DEBUG] Evaluating Card MJA: MJA00285173, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:35 [DEBUG] Card MJA00285173 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:35 [DEBUG] Visibility check for element at y=663, h=64: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:35 [DEBUG] Evaluating Card MJA: MJA00285174, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:35 [DEBUG] Card MJA00285174 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:35 [DEBUG] Visibility check for element at y=881, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:35 [DEBUG] Evaluating Card MJA: MJA00285175, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:35 [DEBUG] Card MJA00285175 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:35 [DEBUG] Visibility check for element at y=1498, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:35 [DEBUG] Evaluating Card MJA: MJA00302426, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:35 [DEBUG] Card MJA00302426 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:59:35 [DEBUG] Evaluating Card MJA: MJA00202042, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 15:59:35 [DEBUG] Card MJA00202042 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:35 [DEBUG] Visibility check for element at y=2661, h=95: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:35 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:59:35 [INFO] Found 1 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:59:35 [DEBUG] Visibility check for element at y=2116, h=464: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:35 [ERROR] Error locating element for MJA00302426: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 15:59:35 [INFO] No suitable (fully visible, clickable) 'Normal' unprocessed cards found. (list_processor.py:125)
2025-05-18 15:59:35 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 15:59:35 [INFO] Attempting scroll (current attempt: 1/3) (list_processor.py:297)
2025-05-18 15:59:35 [DEBUG] Using anchor 'MJA00285175' for scroll. (list_processor.py:299)
2025-05-18 15:59:35 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 15:59:35 [DEBUG] Found element containing MJA00285175 to use as scroll anchor. (list_page.py:121)
2025-05-18 15:59:37 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001b545 with percent: 0.6 (list_page.py:146)
2025-05-18 15:59:38 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_01_20250518_155938_143728.xml (xml_dumper.py:65)
2025-05-18 15:59:38 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 15:59:38 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 15:59:38 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 15:59:38 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_1.png (crawler_service.py:120)
2025-05-18 15:59:38 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 15:59:38 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (crawler_service.py:127)
2025-05-18 15:59:38 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 15:59:40 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00285175) (manager.py:111)
2025-05-18 15:59:40 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:59:40 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 15:59:40 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 15:59:41 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:41 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:59:41 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:41 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:59:41 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:59:41 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:59:41 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:59:41 [DEBUG] Processing content-desc: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:41 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00285175): Extracted MJA ID. Original full desc: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00285175): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00285175): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00285175): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00285175): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:41 [WARNING] MJA Parse (MJA00285175): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:41 [INFO] MJA Parse (MJA00285175): Final parsed data: {'booking_id': 'MJA00285175', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:41 [DEBUG] Successfully parsed card: MJA00285175, Status: Normal (list_page.py:83)
2025-05-18 15:59:41 [DEBUG] Processing content-desc: 'MJA00302426, 10:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:41 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00302426, 10:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00302426): Extracted MJA ID. Original full desc: 'MJA00302426, 10:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00302426): Parts after MJA ID: ['10:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00302426): Found Duration in part '10:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00302426): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00302426): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:41 [INFO] MJA Parse (MJA00302426): Final parsed data: {'booking_id': 'MJA00302426', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '12:00', 'calculated_duration_str': '02:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:59:41 [DEBUG] Successfully parsed card: MJA00302426, Status: Normal (list_page.py:83)
2025-05-18 15:59:41 [DEBUG] Processing content-desc: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:41 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:41 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00202042): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00202042): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00202042): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00202042): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00202042): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:41 [INFO] MJA Parse (MJA00202042): Final parsed data: {'booking_id': 'MJA00202042', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:59:41 [DEBUG] Successfully parsed card: MJA00202042, Status: Cancelled (list_page.py:83)
2025-05-18 15:59:41 [DEBUG] Processing content-desc: 'Cancelled, MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:41 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:41 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00202043): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00202043): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00202043): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00202043): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 15:59:41 [DEBUG] MJA Parse (MJA00202043): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:41 [INFO] MJA Parse (MJA00202043): Final parsed data: {'booking_id': 'MJA00202043', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:59:41 [DEBUG] Successfully parsed card: MJA00202043, Status: Cancelled (list_page.py:83)
2025-05-18 15:59:41 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:59:41 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:59:41 [DEBUG] Evaluating Card MJA: MJA00285175, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:41 [DEBUG] Card MJA00285175 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:41 [DEBUG] Visibility check for element at y=663, h=256: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:41 [DEBUG] Evaluating Card MJA: MJA00302426, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:41 [DEBUG] Card MJA00302426 already in processed_ids_this_cycle. Not re-adding to click candidates unless forced. (list_processor.py:193)
2025-05-18 15:59:41 [DEBUG] Card MJA00302426 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:59:41 [DEBUG] Evaluating Card MJA: MJA00202042, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 15:59:41 [DEBUG] Card MJA00202042 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:41 [DEBUG] Visibility check for element at y=1618, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:41 [DEBUG] Evaluating Card MJA: MJA00202043, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 15:59:41 [INFO] Booking MJA00202043 is CANCELLED on list. Saving base info, status, and skipping detail scrape. (list_processor.py:213)
2025-05-18 15:59:41 [INFO] Inserted/Updated base booking record for MJA00202043 with card_status: Cancelled, db_status: cancelled_on_list (repository.py:75)
2025-05-18 15:59:41 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:59:41 [INFO] Found 1 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:59:41 [DEBUG] Visibility check for element at y=1073, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:41 [INFO] Selected card MJA00302426 (Status: Normal) to click. (list_processor.py:130)
2025-05-18 15:59:41 [INFO] Inserted/Updated base booking record for MJA00302426 with card_status: Normal, db_status: pending (repository.py:75)
2025-05-18 15:59:41 [DEBUG] State updated to SECONDARY for session 1 (MJA: MJA00302426, MJR: None, LastProcMJA: MJA00302426) (manager.py:111)
2025-05-18 15:59:41 [INFO] Attempting click on selected card MJA00302426 (list_processor.py:256)
2025-05-18 15:59:41 [INFO] Clicked card MJA00302426 (list_processor.py:258)
2025-05-18 15:59:42 [DEBUG] Processor for LIST finished. State Manager Current State: SECONDARY (crawler_service.py:198)
2025-05-18 15:59:43 [INFO] --- Executing State: SECONDARY (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:59:43 [INFO] Processing State: SECONDARY (Display 4619827259835644672, MJA: MJA00302426) (secondary_processor.py:95)
2025-05-18 15:59:43 [DEBUG] Secondary page title is displayed. (secondary_page.py:42)
2025-05-18 15:59:43 [INFO] Confirmed on Secondary Page. (secondary_processor.py:90)
2025-05-18 15:59:43 [DEBUG] --- Parsing Secondary Page XML Targeting Specific Attributes --- (secondary_parser.py:33)
2025-05-18 15:59:43 [DEBUG]   Found MJR content-desc: "MJR00227284, Video Remote Interpreting, Appointments : 1" (secondary_parser.py:48)
2025-05-18 15:59:43 [DEBUG]     Extracted MJR ID: MJR00227284 (secondary_parser.py:49)
2025-05-18 15:59:43 [DEBUG]     Extracted Type Hint: Video Remote Interpreting (secondary_parser.py:61)
2025-05-18 15:59:43 [DEBUG]     Extracted Appt Count: 1 (secondary_parser.py:69)
2025-05-18 15:59:43 [DEBUG]   Found MJB ID in text: MJB00238645 (secondary_parser.py:90)
2025-05-18 15:59:43 [DEBUG] --- Secondary Page Targeted Extraction Finished: {'mjb_id_raw': 'MJB00238645', 'mjr_id_raw': 'MJR00227284', 'appointment_count_hint': 1, 'type_hint_raw': 'Video Remote Interpreting'} --- (secondary_parser.py:98)
2025-05-18 15:59:43 [INFO] Saved XML dump: xml_capture_base/MJA00302426/Secondary/Secondary_MJA00302426_MJB00238645_20250518_155943_606886.xml (xml_dumper.py:65)
2025-05-18 15:59:43 [INFO] Extracted from Secondary XML -> MJB: MJB00238645, MJR: MJR00227284, Appt Count: 1, Type Hint: Video Remote Interpreting (secondary_processor.py:130)
2025-05-18 15:59:43 [INFO] Updated secondary IDs & hints for MJA MJA00302426 (MJR set to MJR00227284) (repository.py:124)
2025-05-18 15:59:43 [DEBUG] Attempting to click MJR link element using XPath: //android.view.ViewGroup[@content-desc and starts-with(@content-desc, "MJR00227284")] (secondary_page.py:99)
2025-05-18 15:59:43 [DEBUG] Clicked MJR link element for MJR00227284. (secondary_page.py:105)
2025-05-18 15:59:45 [DEBUG] State updated to DETAIL for session 1 (MJA: MJA00302426, MJR: MJR00227284, LastProcMJA: MJA00302426) (manager.py:111)
2025-05-18 15:59:45 [DEBUG] Processor for SECONDARY finished. State Manager Current State: DETAIL (crawler_service.py:198)
2025-05-18 15:59:45 [INFO] --- Executing State: DETAIL (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:59:45 [INFO] Processing State: DETAIL (Display 4619827259835644672, MJA_trigger: MJA00302426, MJR: MJR00227284) (detail_processor.py:94)
2025-05-18 15:59:45 [DEBUG] Waiting up to 10s for detail page title: 'Booking #MJR' (detail_page.py:50)
2025-05-18 15:59:46 [DEBUG] Detail page title is displayed. (detail_page.py:55)
2025-05-18 15:59:46 [INFO] Successfully confirmed on Detail Page for MJR MJR00227284 (detail_processor.py:98)
2025-05-18 15:59:46 [DEBUG] Header Results: MJR='MJR00227284', Total='£ 63.00', MultiDay=False, LangIdx=4, DateTimeTuple='('02-06-2025 At', '10:00 - 12:00')' (detail_parser.py:129)
2025-05-18 15:59:46 [INFO] Processing Detail for MJR: 'MJR00227284', IsMultiday=False (detail_processor.py:144)
2025-05-18 15:59:46 [INFO] Saved XML dump: xml_capture_base/MJR00227284/Detail_MJR/Detail_MJR_MJR00227284_initial_view_00_20250518_155946_854396.xml (xml_dumper.py:65)
2025-05-18 15:59:46 [DEBUG] Info block scan range: 5 to 9. Processing 4 items: ['Glasgow ET (Aberdeen)', 'Tribunals - ET | Full hearing', 'Carly Sim', '0'] (detail_parser.py:147)
2025-05-18 15:59:46 [DEBUG]   Client Name: 'Glasgow ET (Aberdeen)' (detail_parser.py:154)
2025-05-18 15:59:46 [DEBUG]   Booking Type: 'Tribunals - ET | Full hearing' (detail_parser.py:184)
2025-05-18 15:59:46 [DEBUG]   Contact Name: 'Carly Sim' (detail_parser.py:190)
2025-05-18 15:59:46 [DEBUG]   Contact Phone: '0' (detail_parser.py:196)
2025-05-18 15:59:46 [DEBUG] Sanitized 'contact_phone_raw' from '0' to None. (detail_parser.py:207)
2025-05-18 15:59:46 [DEBUG] Finished parsing info block: {'language_pair_raw': 'English to Polish', 'client_name_raw': 'Glasgow ET (Aberdeen)', 'address_line1_raw': None, 'address_line2_raw': None, 'booking_type_raw': 'Tribunals - ET | Full hearing', 'contact_name_raw': 'Carly Sim', 'contact_phone_raw': None, 'distance_raw': None, 'meeting_link_raw': None} (detail_parser.py:208)
2025-05-18 15:59:46 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 15:59:46 [DEBUG]   Extracting payments for MJA MJA00302426 (text index 11) up to text index 20 (detail_parser.py:268)
2025-05-18 15:59:46 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 15:59:46 [INFO] Skipping scroll loop: Disclaimer visible initially or all expected MJA blocks for multiday found. (detail_processor.py:196)
2025-05-18 15:59:46 [INFO] Consolidating all extracted data... (detail_processor.py:209)
2025-05-18 15:59:46 [DEBUG] --- Consolidating and Parsing Detail Data --- (detail_parser.py:333)
2025-05-18 15:59:46 [DEBUG] Final Parsed Detail Data (keys: ['is_multiday', 'mjr_id', 'header_total', 'booking_date', 'start_time', 'end_time', 'duration', 'multiday_date_range', 'multiday_appointment_info', 'mja_id', 'language_pair', 'client_name', 'booking_type', 'contact_name', 'contact_phone', 'meeting_link', 'address', 'travel_distance', 'overall_total', 'notes', 'multiday_payments', 'day_pay_sl', 'day_pay_td', 'day_pay_tt', 'day_pay_aep', 'day_pay_ooh', 'day_pay_urg', 'day_total']) for MJR MJR00227284 (detail_parser.py:483)
2025-05-18 15:59:46 [DEBUG] Final Parsed MJR Data for MJR00227284 (is_multiday: False): {'is_multiday': 0, 'mjr_id': 'MJR00227284', 'header_total': 63.0, 'booking_date': '02-06-2025', 'start_time': '10:00:00', 'end_time': '12:00:00', 'duration': '02:00', 'multiday_date_range': None, 'multiday_appointment_info': None, 'mja_id': 'MJA00302426', 'language_pair': 'English to Polish', 'client_name': 'Glasgow ET (Aberdeen)', 'booking_type': 'Tribunals - ET | Full hearing', 'contact_name': 'Carly Sim', 'contact_phone': None, 'meeting_link': None, 'address': None, 'travel_distance': None, 'overall_total': 63.0, 'notes': 'Do not attend onsite, this booking is taking place via Kinly CVP, you will be sent an email with the link for the hearing.  The interpreter must be based in the UK.', 'multiday_payments': None, 'day_pay_sl': 48.0, 'day_pay_td': None, 'day_pay_tt': None, 'day_pay_aep': 15.0, 'day_pay_ooh': None, 'day_pay_urg': None, 'day_total': 63.0}... (detail_processor.py:218)
2025-05-18 15:59:46 [INFO] Processing SINGLE DAY save for MJA: MJA00302426 (MJR: MJR00227284) (detail_processor.py:278)
2025-05-18 15:59:46 [INFO] Saved/Updated details for booking MJA MJA00302426 (MJR: MJR00227284) (repository.py:189)
2025-05-18 15:59:46 [INFO] Navigating back to list page (Detail -> Secondary -> List)... (detail_processor.py:50)
2025-05-18 15:59:46 [DEBUG] Executing first back() command. (detail_processor.py:51)
2025-05-18 15:59:48 [DEBUG] Executing second back() command. (detail_processor.py:52)
2025-05-18 15:59:49 [INFO] Navigation successful: Confirmed back on list page. (detail_processor.py:55)
2025-05-18 15:59:49 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00302426) (manager.py:111)
2025-05-18 15:59:49 [DEBUG] Processor for DETAIL finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:59:50 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 15:59:50 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 15:59:50 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_155950_533108.xml (xml_dumper.py:65)
2025-05-18 15:59:50 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:50 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:59:50 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:50 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:59:50 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:59:50 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:59:50 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:59:50 [DEBUG] Processing content-desc: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:50 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00285175): Extracted MJA ID. Original full desc: 'MJA00285175, Endeavour House, 1 Greenmarket, Dundee, DD1 4QB, 10:00 to 17:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00285175): Parts after MJA ID: ['Endeavour House', '1 Greenmarket', 'Dundee', 'DD1 4QB', '10:00 to 17:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00285175): Found Duration in part '10:00 to 17:00' (mja_parser.py:72)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00285175): Found Postcode in part 'DD1 4QB' -> DD1 4QB (mja_parser.py:90)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00285175): Assigned Language Pair: 'English to Polish' from remaining: ['Endeavour House', '1 Greenmarket', 'Dundee', 'English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:50 [WARNING] MJA Parse (MJA00285175): Multiple unassigned parts left: ['Endeavour House', '1 Greenmarket', 'Dundee']. Using last for lang. (mja_parser.py:102)
2025-05-18 15:59:50 [INFO] MJA Parse (MJA00285175): Final parsed data: {'booking_id': 'MJA00285175', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'DD1 4QB', 'start_time_raw': '10:00', 'end_time_raw': '17:00', 'calculated_duration_str': '07:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 17:00'} (mja_parser.py:112)
2025-05-18 15:59:50 [DEBUG] Successfully parsed card: MJA00285175, Status: Normal (list_page.py:83)
2025-05-18 15:59:50 [DEBUG] Processing content-desc: 'MJA00302426, 10:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:50 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00302426, 10:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00302426): Extracted MJA ID. Original full desc: 'MJA00302426, 10:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00302426): Parts after MJA ID: ['10:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00302426): Found Duration in part '10:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00302426): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00302426): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:50 [INFO] MJA Parse (MJA00302426): Final parsed data: {'booking_id': 'MJA00302426', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '12:00', 'calculated_duration_str': '02:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:59:50 [DEBUG] Successfully parsed card: MJA00302426, Status: Normal (list_page.py:83)
2025-05-18 15:59:50 [DEBUG] Processing content-desc: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:50 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:50 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00202042): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00202042): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00202042): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00202042): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00202042): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:50 [INFO] MJA Parse (MJA00202042): Final parsed data: {'booking_id': 'MJA00202042', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:59:50 [DEBUG] Successfully parsed card: MJA00202042, Status: Cancelled (list_page.py:83)
2025-05-18 15:59:50 [DEBUG] Processing content-desc: 'Cancelled, MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:50 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:50 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00202043): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00202043): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00202043): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00202043): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 15:59:50 [DEBUG] MJA Parse (MJA00202043): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:50 [INFO] MJA Parse (MJA00202043): Final parsed data: {'booking_id': 'MJA00202043', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:59:50 [DEBUG] Successfully parsed card: MJA00202043, Status: Cancelled (list_page.py:83)
2025-05-18 15:59:50 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 15:59:50 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:59:50 [DEBUG] Evaluating Card MJA: MJA00285175, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:50 [DEBUG] Card MJA00285175 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:50 [DEBUG] Visibility check for element at y=663, h=256: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:50 [DEBUG] Evaluating Card MJA: MJA00302426, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:50 [DEBUG] Card MJA00302426 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:50 [DEBUG] Visibility check for element at y=1073, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:50 [DEBUG] Evaluating Card MJA: MJA00202042, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 15:59:50 [DEBUG] Card MJA00202042 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:50 [DEBUG] Visibility check for element at y=1618, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:50 [DEBUG] Evaluating Card MJA: MJA00202043, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 15:59:50 [DEBUG] Card MJA00202043 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:50 [DEBUG] Visibility check for element at y=2236, h=464: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:50 [INFO] Found 0 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:59:50 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 15:59:50 [DEBUG] Incremented scroll_attempts to 1 as no new processable cards were found. (list_processor.py:277)
2025-05-18 15:59:50 [INFO] Attempting scroll (current attempt: 1/3) (list_processor.py:297)
2025-05-18 15:59:50 [DEBUG] Using anchor 'MJA00202042' for scroll. (list_processor.py:299)
2025-05-18 15:59:50 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 15:59:51 [DEBUG] Found element containing MJA00202042 to use as scroll anchor. (list_page.py:121)
2025-05-18 15:59:52 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001b744 with percent: 0.6 (list_page.py:146)
2025-05-18 15:59:53 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_01_20250518_155953_522711.xml (xml_dumper.py:65)
2025-05-18 15:59:53 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 15:59:53 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 15:59:53 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 15:59:53 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_1.png (crawler_service.py:120)
2025-05-18 15:59:53 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 15:59:53 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (crawler_service.py:127)
2025-05-18 15:59:53 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 15:59:55 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00302426) (manager.py:111)
2025-05-18 15:59:55 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 15:59:56 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 15:59:56 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 15:59:56 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:56 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 15:59:56 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 15:59:56 [DEBUG] Found 8 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 15:59:56 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 15:59:56 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 15:59:56 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 15:59:56 [DEBUG] Processing content-desc: 'MJA00302426, 10:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:56 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00302426, 10:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00302426): Extracted MJA ID. Original full desc: 'MJA00302426, 10:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00302426): Parts after MJA ID: ['10:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00302426): Found Duration in part '10:00 to 12:00' (mja_parser.py:72)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00302426): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00302426): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:56 [INFO] MJA Parse (MJA00302426): Final parsed data: {'booking_id': 'MJA00302426', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '12:00', 'calculated_duration_str': '02:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 12:00'} (mja_parser.py:112)
2025-05-18 15:59:56 [DEBUG] Successfully parsed card: MJA00302426, Status: Normal (list_page.py:83)
2025-05-18 15:59:56 [DEBUG] Processing content-desc: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:56 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:56 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202042): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202042): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202042): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202042): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202042): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:56 [INFO] MJA Parse (MJA00202042): Final parsed data: {'booking_id': 'MJA00202042', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:59:56 [DEBUG] Successfully parsed card: MJA00202042, Status: Cancelled (list_page.py:83)
2025-05-18 15:59:56 [DEBUG] Processing content-desc: 'Cancelled, MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:56 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:56 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202043): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202043): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202043): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202043): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202043): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:56 [INFO] MJA Parse (MJA00202043): Final parsed data: {'booking_id': 'MJA00202043', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:59:56 [DEBUG] Successfully parsed card: MJA00202043, Status: Cancelled (list_page.py:83)
2025-05-18 15:59:56 [DEBUG] Processing content-desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 15:59:56 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00322089): Extracted MJA ID. Original full desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00322089): Parts after MJA ID: ['10:00 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00322089): Found Duration in part '10:00 to 11:30' (mja_parser.py:72)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00322089): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00322089): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:56 [INFO] MJA Parse (MJA00322089): Final parsed data: {'booking_id': 'MJA00322089', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '11:30', 'calculated_duration_str': '01:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 11:30'} (mja_parser.py:112)
2025-05-18 15:59:56 [DEBUG] Successfully parsed card: MJA00322089, Status: Normal (list_page.py:83)
2025-05-18 15:59:56 [DEBUG] Processing content-desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 15:59:56 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 15:59:56 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202044): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202044): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202044): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202044): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 15:59:56 [DEBUG] MJA Parse (MJA00202044): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 15:59:56 [INFO] MJA Parse (MJA00202044): Final parsed data: {'booking_id': 'MJA00202044', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 15:59:56 [DEBUG] Successfully parsed card: MJA00202044, Status: Cancelled (list_page.py:83)
2025-05-18 15:59:56 [INFO] Successfully extracted data for 5 cards from list page XML source. (list_page.py:100)
2025-05-18 15:59:56 [INFO] Found data for 5 cards on screen via XML. (list_processor.py:150)
2025-05-18 15:59:56 [DEBUG] Evaluating Card MJA: MJA00302426, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:56 [DEBUG] Card MJA00302426 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:56 [DEBUG] Visibility check for element at y=663, h=29: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:56 [DEBUG] Evaluating Card MJA: MJA00202042, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 15:59:56 [DEBUG] Card MJA00202042 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:56 [DEBUG] Visibility check for element at y=773, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:56 [DEBUG] Evaluating Card MJA: MJA00202043, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 15:59:56 [DEBUG] Card MJA00202043 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 15:59:56 [DEBUG] Visibility check for element at y=1391, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:56 [DEBUG] Evaluating Card MJA: MJA00322089, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 15:59:56 [DEBUG] Card MJA00322089 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 15:59:56 [DEBUG] Evaluating Card MJA: MJA00202044, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 15:59:56 [INFO] Booking MJA00202044 is CANCELLED on list. Saving base info, status, and skipping detail scrape. (list_processor.py:213)
2025-05-18 15:59:56 [INFO] Inserted/Updated base booking record for MJA00202044 with card_status: Cancelled, db_status: cancelled_on_list (repository.py:75)
2025-05-18 15:59:56 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 15:59:56 [INFO] Found 1 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 15:59:56 [DEBUG] Visibility check for element at y=2009, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 15:59:56 [INFO] Selected card MJA00322089 (Status: Normal) to click. (list_processor.py:130)
2025-05-18 15:59:56 [INFO] Inserted/Updated base booking record for MJA00322089 with card_status: Normal, db_status: pending (repository.py:75)
2025-05-18 15:59:56 [DEBUG] State updated to SECONDARY for session 1 (MJA: MJA00322089, MJR: None, LastProcMJA: MJA00322089) (manager.py:111)
2025-05-18 15:59:56 [INFO] Attempting click on selected card MJA00322089 (list_processor.py:256)
2025-05-18 15:59:56 [INFO] Clicked card MJA00322089 (list_processor.py:258)
2025-05-18 15:59:58 [DEBUG] Processor for LIST finished. State Manager Current State: SECONDARY (crawler_service.py:198)
2025-05-18 15:59:58 [INFO] --- Executing State: SECONDARY (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 15:59:58 [INFO] Processing State: SECONDARY (Display 4619827259835644672, MJA: MJA00322089) (secondary_processor.py:95)
2025-05-18 15:59:59 [DEBUG] Secondary page title is displayed. (secondary_page.py:42)
2025-05-18 15:59:59 [INFO] Confirmed on Secondary Page. (secondary_processor.py:90)
2025-05-18 15:59:59 [DEBUG] --- Parsing Secondary Page XML Targeting Specific Attributes --- (secondary_parser.py:33)
2025-05-18 15:59:59 [DEBUG]   Found MJR content-desc: "MJR00243620, Video Remote Interpreting, Appointments : 1" (secondary_parser.py:48)
2025-05-18 15:59:59 [DEBUG]     Extracted MJR ID: MJR00243620 (secondary_parser.py:49)
2025-05-18 15:59:59 [DEBUG]     Extracted Type Hint: Video Remote Interpreting (secondary_parser.py:61)
2025-05-18 15:59:59 [DEBUG]     Extracted Appt Count: 1 (secondary_parser.py:69)
2025-05-18 15:59:59 [DEBUG]   Found MJB ID in text: MJB00255558 (secondary_parser.py:90)
2025-05-18 15:59:59 [DEBUG] --- Secondary Page Targeted Extraction Finished: {'mjb_id_raw': 'MJB00255558', 'mjr_id_raw': 'MJR00243620', 'appointment_count_hint': 1, 'type_hint_raw': 'Video Remote Interpreting'} --- (secondary_parser.py:98)
2025-05-18 15:59:59 [INFO] Saved XML dump: xml_capture_base/MJA00322089/Secondary/Secondary_MJA00322089_MJB00255558_20250518_155959_063496.xml (xml_dumper.py:65)
2025-05-18 15:59:59 [INFO] Extracted from Secondary XML -> MJB: MJB00255558, MJR: MJR00243620, Appt Count: 1, Type Hint: Video Remote Interpreting (secondary_processor.py:130)
2025-05-18 15:59:59 [INFO] Updated secondary IDs & hints for MJA MJA00322089 (MJR set to MJR00243620) (repository.py:124)
2025-05-18 15:59:59 [DEBUG] Attempting to click MJR link element using XPath: //android.view.ViewGroup[@content-desc and starts-with(@content-desc, "MJR00243620")] (secondary_page.py:99)
2025-05-18 15:59:59 [DEBUG] Clicked MJR link element for MJR00243620. (secondary_page.py:105)
2025-05-18 16:00:00 [DEBUG] State updated to DETAIL for session 1 (MJA: MJA00322089, MJR: MJR00243620, LastProcMJA: MJA00322089) (manager.py:111)
2025-05-18 16:00:00 [DEBUG] Processor for SECONDARY finished. State Manager Current State: DETAIL (crawler_service.py:198)
2025-05-18 16:00:01 [INFO] --- Executing State: DETAIL (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 16:00:01 [INFO] Processing State: DETAIL (Display 4619827259835644672, MJA_trigger: MJA00322089, MJR: MJR00243620) (detail_processor.py:94)
2025-05-18 16:00:01 [DEBUG] Waiting up to 10s for detail page title: 'Booking #MJR' (detail_page.py:50)
2025-05-18 16:00:02 [DEBUG] Detail page title is displayed. (detail_page.py:55)
2025-05-18 16:00:02 [INFO] Successfully confirmed on Detail Page for MJR MJR00243620 (detail_processor.py:98)
2025-05-18 16:00:02 [DEBUG] Header Results: MJR='MJR00243620', Total='£ 51.00', MultiDay=False, LangIdx=4, DateTimeTuple='('04-06-2025 At', '10:00 - 11:30')' (detail_parser.py:129)
2025-05-18 16:00:02 [INFO] Processing Detail for MJR: 'MJR00243620', IsMultiday=False (detail_processor.py:144)
2025-05-18 16:00:02 [INFO] Saved XML dump: xml_capture_base/MJR00243620/Detail_MJR/Detail_MJR_MJR00243620_initial_view_00_20250518_160002_302977.xml (xml_dumper.py:65)
2025-05-18 16:00:02 [DEBUG] Info block scan range: 5 to 10. Processing 5 items: ['West Mercia (TPS)', 'Meeting Link', 'NPS | Interview for Court report - face to face', 'undefined undefined', 'undefined'] (detail_parser.py:147)
2025-05-18 16:00:02 [DEBUG]   Client Name: 'West Mercia (TPS)' (detail_parser.py:154)
2025-05-18 16:00:02 [DEBUG]   Found 'Meeting Link'. (detail_parser.py:156)
2025-05-18 16:00:02 [DEBUG]   No valid URL after Meeting Link label. Next: NPS | Interview for Court report - face to face (detail_parser.py:163)
2025-05-18 16:00:02 [DEBUG]   Booking Type: 'NPS | Interview for Court report - face to face' (detail_parser.py:184)
2025-05-18 16:00:02 [DEBUG]   Contact Name: 'undefined undefined' (detail_parser.py:190)
2025-05-18 16:00:02 [DEBUG]   Contact Phone: 'undefined' (detail_parser.py:196)
2025-05-18 16:00:02 [DEBUG] Sanitized 'contact_name_raw' from 'undefined undefined' to None. (detail_parser.py:207)
2025-05-18 16:00:02 [DEBUG] Sanitized 'contact_phone_raw' from 'undefined' to None. (detail_parser.py:207)
2025-05-18 16:00:02 [DEBUG] Finished parsing info block: {'language_pair_raw': 'English to Polish', 'client_name_raw': 'West Mercia (TPS)', 'address_line1_raw': None, 'address_line2_raw': None, 'booking_type_raw': 'NPS | Interview for Court report - face to face', 'contact_name_raw': None, 'contact_phone_raw': None, 'distance_raw': None, 'meeting_link_raw': None} (detail_parser.py:208)
2025-05-18 16:00:02 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 16:00:02 [DEBUG]   Extracting payments for MJA MJA00322089 (text index 12) up to text index 21 (detail_parser.py:268)
2025-05-18 16:00:02 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 16:00:02 [INFO] Starting scroll loop for more payments or disclaimer... (detail_processor.py:163)
2025-05-18 16:00:02 [INFO] Saved XML dump: xml_capture_base/MJR00243620/Detail_MJR/Detail_MJR_MJR00243620_scroll_01_20250518_160002_932297.xml (xml_dumper.py:65)
2025-05-18 16:00:02 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 16:00:02 [DEBUG]   Extracting payments for MJA MJA00322089 (text index 12) up to text index 21 (detail_parser.py:268)
2025-05-18 16:00:02 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 16:00:03 [DEBUG] Scrolling detail page (attempt 1)... (detail_processor.py:186)
2025-05-18 16:00:06 [INFO] Saved XML dump: xml_capture_base/MJR00243620/Detail_MJR/Detail_MJR_MJR00243620_scroll_02_20250518_160006_187967.xml (xml_dumper.py:65)
2025-05-18 16:00:06 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 16:00:06 [DEBUG]   Extracting payments for MJA MJA00322089 (text index 11) up to text index 21 (detail_parser.py:268)
2025-05-18 16:00:06 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 16:00:06 [INFO] Disclaimer found after 2 scrolls. (detail_processor.py:178)
2025-05-18 16:00:06 [INFO] Saved XML dump: xml_capture_base/MJR00243620/Detail_MJR/Detail_MJR_MJR00243620_final_view_01_20250518_160006_278060.xml (xml_dumper.py:65)
2025-05-18 16:00:06 [INFO] Consolidating all extracted data... (detail_processor.py:209)
2025-05-18 16:00:06 [DEBUG] --- Consolidating and Parsing Detail Data --- (detail_parser.py:333)
2025-05-18 16:00:06 [INFO] Extracted meeting link from notes: Jayne.Stewart@justice.gov.uk (detail_parser.py:479)
2025-05-18 16:00:06 [DEBUG] Final Parsed Detail Data (keys: ['is_multiday', 'mjr_id', 'header_total', 'booking_date', 'start_time', 'end_time', 'duration', 'multiday_date_range', 'multiday_appointment_info', 'mja_id', 'language_pair', 'client_name', 'booking_type', 'contact_name', 'contact_phone', 'meeting_link', 'address', 'travel_distance', 'overall_total', 'notes', 'multiday_payments', 'day_pay_sl', 'day_pay_td', 'day_pay_tt', 'day_pay_aep', 'day_pay_ooh', 'day_pay_urg', 'day_total']) for MJR MJR00243620 (detail_parser.py:483)
2025-05-18 16:00:06 [DEBUG] Final Parsed MJR Data for MJR00243620 (is_multiday: False): {'is_multiday': 0, 'mjr_id': 'MJR00243620', 'header_total': 51.0, 'booking_date': '04-06-2025', 'start_time': '10:00:00', 'end_time': '11:30:00', 'duration': '01:30', 'multiday_date_range': None, 'multiday_appointment_info': None, 'mja_id': 'MJA00322089', 'language_pair': 'English to Polish', 'client_name': 'West Mercia (TPS)', 'booking_type': 'NPS | Interview for Court report - face to face', 'contact_name': None, 'contact_phone': None, 'meeting_link': 'Jayne.Stewart@justice.gov.uk', 'address': None, 'travel_distance': None, 'overall_total': 51.0, 'notes': 'Jayne.Stewart@justice.gov.uk 07817023298 will be the Probation Officer on the call if you have any issues connecting. Secure computer connection required. No need to attend in person. Please use the CVP system link https://join.meet.video.justice.gov.uk\nEnter the following for URI reference: pcvleastwoodparkhmppb4@meet.video.justice.gov.uk', 'multiday_payments': None, 'day_pay_sl': 36.0, 'day_pay_td': None, 'day_pay_tt': None, 'da... (detail_processor.py:218)
2025-05-18 16:00:06 [INFO] Processing SINGLE DAY save for MJA: MJA00322089 (MJR: MJR00243620) (detail_processor.py:278)
2025-05-18 16:00:06 [INFO] Saved/Updated details for booking MJA MJA00322089 (MJR: MJR00243620) (repository.py:189)
2025-05-18 16:00:06 [INFO] Navigating back to list page (Detail -> Secondary -> List)... (detail_processor.py:50)
2025-05-18 16:00:06 [DEBUG] Executing first back() command. (detail_processor.py:51)
2025-05-18 16:00:07 [DEBUG] Executing second back() command. (detail_processor.py:52)
2025-05-18 16:00:09 [INFO] Navigation successful: Confirmed back on list page. (detail_processor.py:55)
2025-05-18 16:00:09 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00322089) (manager.py:111)
2025-05-18 16:00:09 [DEBUG] Processor for DETAIL finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 16:00:09 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 16:00:09 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 16:00:09 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_160009_891664.xml (xml_dumper.py:65)
2025-05-18 16:00:09 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:09 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 16:00:09 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:10 [DEBUG] Found 8 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 16:00:10 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 16:00:10 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 16:00:10 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 16:00:10 [DEBUG] Processing content-desc: 'MJA00302426, 10:00 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:10 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00302426, 10:00 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00302426): Extracted MJA ID. Original full desc: 'MJA00302426, 10:00 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00302426): Parts after MJA ID: ['10:00 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00302426): Found Duration in part '10:00 to 12:00' (mja_parser.py:72)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00302426): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00302426): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:10 [INFO] MJA Parse (MJA00302426): Final parsed data: {'booking_id': 'MJA00302426', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '12:00', 'calculated_duration_str': '02:00', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 12:00'} (mja_parser.py:112)
2025-05-18 16:00:10 [DEBUG] Successfully parsed card: MJA00302426, Status: Normal (list_page.py:83)
2025-05-18 16:00:10 [DEBUG] Processing content-desc: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:10 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:10 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202042): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202042, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202042): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202042): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202042): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202042): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:10 [INFO] MJA Parse (MJA00202042): Final parsed data: {'booking_id': 'MJA00202042', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:10 [DEBUG] Successfully parsed card: MJA00202042, Status: Cancelled (list_page.py:83)
2025-05-18 16:00:10 [DEBUG] Processing content-desc: 'Cancelled, MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:10 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:10 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202043): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202043): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202043): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202043): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202043): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:10 [INFO] MJA Parse (MJA00202043): Final parsed data: {'booking_id': 'MJA00202043', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:10 [DEBUG] Successfully parsed card: MJA00202043, Status: Cancelled (list_page.py:83)
2025-05-18 16:00:10 [DEBUG] Processing content-desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 16:00:10 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00322089): Extracted MJA ID. Original full desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00322089): Parts after MJA ID: ['10:00 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00322089): Found Duration in part '10:00 to 11:30' (mja_parser.py:72)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00322089): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00322089): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:10 [INFO] MJA Parse (MJA00322089): Final parsed data: {'booking_id': 'MJA00322089', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '11:30', 'calculated_duration_str': '01:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 11:30'} (mja_parser.py:112)
2025-05-18 16:00:10 [DEBUG] Successfully parsed card: MJA00322089, Status: Normal (list_page.py:83)
2025-05-18 16:00:10 [DEBUG] Processing content-desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:10 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:10 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202044): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202044): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202044): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202044): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:10 [DEBUG] MJA Parse (MJA00202044): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:10 [INFO] MJA Parse (MJA00202044): Final parsed data: {'booking_id': 'MJA00202044', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:10 [DEBUG] Successfully parsed card: MJA00202044, Status: Cancelled (list_page.py:83)
2025-05-18 16:00:10 [INFO] Successfully extracted data for 5 cards from list page XML source. (list_page.py:100)
2025-05-18 16:00:10 [INFO] Found data for 5 cards on screen via XML. (list_processor.py:150)
2025-05-18 16:00:10 [DEBUG] Evaluating Card MJA: MJA00302426, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:10 [DEBUG] Card MJA00302426 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:10 [DEBUG] Visibility check for element at y=663, h=29: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:10 [DEBUG] Evaluating Card MJA: MJA00202042, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 16:00:10 [DEBUG] Card MJA00202042 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:10 [DEBUG] Visibility check for element at y=773, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:10 [DEBUG] Evaluating Card MJA: MJA00202043, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 16:00:10 [DEBUG] Card MJA00202043 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:10 [DEBUG] Visibility check for element at y=1391, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:10 [DEBUG] Evaluating Card MJA: MJA00322089, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:10 [DEBUG] Card MJA00322089 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:10 [DEBUG] Visibility check for element at y=2009, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:10 [DEBUG] Evaluating Card MJA: MJA00202044, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 16:00:10 [DEBUG] Card MJA00202044 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:10 [DEBUG] Visibility check for element at y=2554, h=202: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:10 [INFO] Found 0 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 16:00:10 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 16:00:10 [DEBUG] Incremented scroll_attempts to 1 as no new processable cards were found. (list_processor.py:277)
2025-05-18 16:00:10 [INFO] Attempting scroll (current attempt: 1/3) (list_processor.py:297)
2025-05-18 16:00:10 [DEBUG] Using anchor 'MJA00322089' for scroll. (list_processor.py:299)
2025-05-18 16:00:10 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 16:00:10 [DEBUG] Found element containing MJA00322089 to use as scroll anchor. (list_page.py:121)
2025-05-18 16:00:12 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001b927 with percent: 0.6 (list_page.py:146)
2025-05-18 16:00:13 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_01_20250518_160013_331134.xml (xml_dumper.py:65)
2025-05-18 16:00:13 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 16:00:13 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 16:00:13 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 16:00:13 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_1.png (crawler_service.py:120)
2025-05-18 16:00:13 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 16:00:13 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (crawler_service.py:127)
2025-05-18 16:00:13 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 16:00:15 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00322089) (manager.py:111)
2025-05-18 16:00:15 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 16:00:16 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 16:00:16 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 16:00:16 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:16 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 16:00:16 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:17 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 16:00:17 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 16:00:17 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 16:00:17 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 16:00:17 [DEBUG] Processing content-desc: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:17 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00202043): Extracted MJA ID. Original full desc: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00202043): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00202043): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00202043): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00202043): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:17 [INFO] MJA Parse (MJA00202043): Final parsed data: {'booking_id': 'MJA00202043', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:17 [DEBUG] Successfully parsed card: MJA00202043, Status: Normal (list_page.py:83)
2025-05-18 16:00:17 [DEBUG] Processing content-desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 16:00:17 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00322089): Extracted MJA ID. Original full desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00322089): Parts after MJA ID: ['10:00 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00322089): Found Duration in part '10:00 to 11:30' (mja_parser.py:72)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00322089): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00322089): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:17 [INFO] MJA Parse (MJA00322089): Final parsed data: {'booking_id': 'MJA00322089', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '11:30', 'calculated_duration_str': '01:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 11:30'} (mja_parser.py:112)
2025-05-18 16:00:17 [DEBUG] Successfully parsed card: MJA00322089, Status: Normal (list_page.py:83)
2025-05-18 16:00:17 [DEBUG] Processing content-desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:17 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:17 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00202044): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00202044): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00202044): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00202044): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00202044): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:17 [INFO] MJA Parse (MJA00202044): Final parsed data: {'booking_id': 'MJA00202044', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:17 [DEBUG] Successfully parsed card: MJA00202044, Status: Cancelled (list_page.py:83)
2025-05-18 16:00:17 [DEBUG] Processing content-desc: 'MJA00308901, 09:45 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:17 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00308901, 09:45 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00308901): Extracted MJA ID. Original full desc: 'MJA00308901, 09:45 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00308901): Parts after MJA ID: ['09:45 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00308901): Found Duration in part '09:45 to 12:00' (mja_parser.py:72)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00308901): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:17 [DEBUG] MJA Parse (MJA00308901): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:17 [INFO] MJA Parse (MJA00308901): Final parsed data: {'booking_id': 'MJA00308901', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '09:45', 'end_time_raw': '12:00', 'calculated_duration_str': '02:15', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '09:45 to 12:00'} (mja_parser.py:112)
2025-05-18 16:00:17 [DEBUG] Successfully parsed card: MJA00308901, Status: Normal (list_page.py:83)
2025-05-18 16:00:17 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 16:00:17 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 16:00:17 [DEBUG] Evaluating Card MJA: MJA00202043, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:17 [DEBUG] Card MJA00202043 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:18 [DEBUG] Visibility check for element at y=663, h=272: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:18 [DEBUG] Evaluating Card MJA: MJA00322089, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:18 [DEBUG] Card MJA00322089 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:19 [DEBUG] Visibility check for element at y=1089, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:19 [DEBUG] Evaluating Card MJA: MJA00202044, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 16:00:19 [DEBUG] Card MJA00202044 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:19 [DEBUG] Visibility check for element at y=1634, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:19 [DEBUG] Evaluating Card MJA: MJA00308901, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:19 [DEBUG] Card MJA00308901 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 16:00:19 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 16:00:19 [INFO] Found 1 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 16:00:20 [DEBUG] Visibility check for element at y=2251, h=465: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:20 [ERROR] Error locating element for MJA00308901: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 16:00:20 [INFO] No suitable (fully visible, clickable) 'Normal' unprocessed cards found. (list_processor.py:125)
2025-05-18 16:00:20 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 16:00:20 [INFO] Attempting scroll (current attempt: 1/3) (list_processor.py:297)
2025-05-18 16:00:20 [DEBUG] Using anchor 'MJA00202044' for scroll. (list_processor.py:299)
2025-05-18 16:00:20 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 16:00:20 [DEBUG] Found element containing MJA00202044 to use as scroll anchor. (list_page.py:121)
2025-05-18 16:00:22 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001b930 with percent: 0.6 (list_page.py:146)
2025-05-18 16:00:23 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_01_20250518_160023_779398.xml (xml_dumper.py:65)
2025-05-18 16:00:23 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 16:00:24 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 16:00:24 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 16:00:24 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_1.png (crawler_service.py:120)
2025-05-18 16:00:24 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 16:00:24 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (crawler_service.py:127)
2025-05-18 16:00:24 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 16:00:26 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00322089) (manager.py:111)
2025-05-18 16:00:26 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 16:00:27 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 16:00:27 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 16:00:27 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:27 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 16:00:27 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:27 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 16:00:27 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 16:00:27 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 16:00:27 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 16:00:27 [DEBUG] Processing content-desc: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:27 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00202043): Extracted MJA ID. Original full desc: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00202043): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00202043): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00202043): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00202043): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:27 [INFO] MJA Parse (MJA00202043): Final parsed data: {'booking_id': 'MJA00202043', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:27 [DEBUG] Successfully parsed card: MJA00202043, Status: Normal (list_page.py:83)
2025-05-18 16:00:27 [DEBUG] Processing content-desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 16:00:27 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00322089): Extracted MJA ID. Original full desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00322089): Parts after MJA ID: ['10:00 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00322089): Found Duration in part '10:00 to 11:30' (mja_parser.py:72)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00322089): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00322089): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:27 [INFO] MJA Parse (MJA00322089): Final parsed data: {'booking_id': 'MJA00322089', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '11:30', 'calculated_duration_str': '01:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 11:30'} (mja_parser.py:112)
2025-05-18 16:00:27 [DEBUG] Successfully parsed card: MJA00322089, Status: Normal (list_page.py:83)
2025-05-18 16:00:27 [DEBUG] Processing content-desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:27 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:27 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00202044): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00202044): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00202044): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00202044): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00202044): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:27 [INFO] MJA Parse (MJA00202044): Final parsed data: {'booking_id': 'MJA00202044', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:27 [DEBUG] Successfully parsed card: MJA00202044, Status: Cancelled (list_page.py:83)
2025-05-18 16:00:27 [DEBUG] Processing content-desc: 'MJA00308901, 09:45 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:27 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00308901, 09:45 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00308901): Extracted MJA ID. Original full desc: 'MJA00308901, 09:45 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00308901): Parts after MJA ID: ['09:45 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00308901): Found Duration in part '09:45 to 12:00' (mja_parser.py:72)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00308901): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:27 [DEBUG] MJA Parse (MJA00308901): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:27 [INFO] MJA Parse (MJA00308901): Final parsed data: {'booking_id': 'MJA00308901', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '09:45', 'end_time_raw': '12:00', 'calculated_duration_str': '02:15', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '09:45 to 12:00'} (mja_parser.py:112)
2025-05-18 16:00:27 [DEBUG] Successfully parsed card: MJA00308901, Status: Normal (list_page.py:83)
2025-05-18 16:00:27 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 16:00:27 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 16:00:27 [DEBUG] Evaluating Card MJA: MJA00202043, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:27 [DEBUG] Card MJA00202043 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:27 [DEBUG] Visibility check for element at y=663, h=301: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:27 [DEBUG] Evaluating Card MJA: MJA00322089, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:27 [DEBUG] Card MJA00322089 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:27 [DEBUG] Visibility check for element at y=1118, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:27 [DEBUG] Evaluating Card MJA: MJA00202044, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 16:00:27 [DEBUG] Card MJA00202044 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:27 [DEBUG] Visibility check for element at y=1663, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:27 [DEBUG] Evaluating Card MJA: MJA00308901, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:27 [DEBUG] Card MJA00308901 already in processed_ids_this_cycle. Not re-adding to click candidates unless forced. (list_processor.py:193)
2025-05-18 16:00:27 [DEBUG] Card MJA00308901 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 16:00:27 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 16:00:27 [INFO] Found 1 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 16:00:28 [DEBUG] Visibility check for element at y=2280, h=465: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:28 [ERROR] Error locating element for MJA00308901: 'BookingCardStatus' object has no attribute 'get' (list_processor.py:122)
2025-05-18 16:00:28 [INFO] No suitable (fully visible, clickable) 'Normal' unprocessed cards found. (list_processor.py:125)
2025-05-18 16:00:28 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 16:00:28 [INFO] Attempting scroll (current attempt: 1/3) (list_processor.py:297)
2025-05-18 16:00:28 [DEBUG] Using anchor 'MJA00202044' for scroll. (list_processor.py:299)
2025-05-18 16:00:28 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 16:00:28 [DEBUG] Found element containing MJA00202044 to use as scroll anchor. (list_page.py:121)
2025-05-18 16:00:29 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001b930 with percent: 0.6 (list_page.py:146)
2025-05-18 16:00:30 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_01_20250518_160030_691567.xml (xml_dumper.py:65)
2025-05-18 16:00:30 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 16:00:31 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 16:00:31 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 16:00:31 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_1.png (crawler_service.py:120)
2025-05-18 16:00:31 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 16:00:31 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (crawler_service.py:127)
2025-05-18 16:00:31 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 16:00:33 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00322089) (manager.py:111)
2025-05-18 16:00:33 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 16:00:33 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 16:00:33 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 16:00:33 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:33 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 16:00:33 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:33 [DEBUG] Found 8 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 16:00:33 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 16:00:33 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 16:00:33 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 16:00:33 [DEBUG] Processing content-desc: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:33 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202043): Extracted MJA ID. Original full desc: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202043): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202043): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202043): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202043): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:33 [INFO] MJA Parse (MJA00202043): Final parsed data: {'booking_id': 'MJA00202043', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:33 [DEBUG] Successfully parsed card: MJA00202043, Status: Normal (list_page.py:83)
2025-05-18 16:00:33 [DEBUG] Processing content-desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 16:00:33 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00322089): Extracted MJA ID. Original full desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00322089): Parts after MJA ID: ['10:00 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00322089): Found Duration in part '10:00 to 11:30' (mja_parser.py:72)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00322089): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00322089): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:33 [INFO] MJA Parse (MJA00322089): Final parsed data: {'booking_id': 'MJA00322089', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '11:30', 'calculated_duration_str': '01:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 11:30'} (mja_parser.py:112)
2025-05-18 16:00:33 [DEBUG] Successfully parsed card: MJA00322089, Status: Normal (list_page.py:83)
2025-05-18 16:00:33 [DEBUG] Processing content-desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:33 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:33 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202044): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202044): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202044): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202044): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202044): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:33 [INFO] MJA Parse (MJA00202044): Final parsed data: {'booking_id': 'MJA00202044', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:33 [DEBUG] Successfully parsed card: MJA00202044, Status: Cancelled (list_page.py:83)
2025-05-18 16:00:33 [DEBUG] Processing content-desc: 'MJA00308901, 09:45 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:33 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00308901, 09:45 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00308901): Extracted MJA ID. Original full desc: 'MJA00308901, 09:45 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00308901): Parts after MJA ID: ['09:45 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00308901): Found Duration in part '09:45 to 12:00' (mja_parser.py:72)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00308901): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00308901): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:33 [INFO] MJA Parse (MJA00308901): Final parsed data: {'booking_id': 'MJA00308901', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '09:45', 'end_time_raw': '12:00', 'calculated_duration_str': '02:15', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '09:45 to 12:00'} (mja_parser.py:112)
2025-05-18 16:00:33 [DEBUG] Successfully parsed card: MJA00308901, Status: Normal (list_page.py:83)
2025-05-18 16:00:33 [DEBUG] Processing content-desc: 'Cancelled, MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:33 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:33 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202045): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202045): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202045): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202045): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:33 [DEBUG] MJA Parse (MJA00202045): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:33 [INFO] MJA Parse (MJA00202045): Final parsed data: {'booking_id': 'MJA00202045', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:33 [DEBUG] Successfully parsed card: MJA00202045, Status: Cancelled (list_page.py:83)
2025-05-18 16:00:33 [INFO] Successfully extracted data for 5 cards from list page XML source. (list_page.py:100)
2025-05-18 16:00:33 [INFO] Found data for 5 cards on screen via XML. (list_processor.py:150)
2025-05-18 16:00:33 [DEBUG] Evaluating Card MJA: MJA00202043, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:33 [DEBUG] Card MJA00202043 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:33 [DEBUG] Visibility check for element at y=663, h=99: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:33 [DEBUG] Evaluating Card MJA: MJA00322089, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:33 [DEBUG] Card MJA00322089 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:34 [DEBUG] Visibility check for element at y=916, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:34 [DEBUG] Evaluating Card MJA: MJA00202044, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 16:00:34 [DEBUG] Card MJA00202044 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:34 [DEBUG] Visibility check for element at y=1461, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:34 [DEBUG] Evaluating Card MJA: MJA00308901, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:34 [DEBUG] Card MJA00308901 already in processed_ids_this_cycle. Not re-adding to click candidates unless forced. (list_processor.py:193)
2025-05-18 16:00:34 [DEBUG] Card MJA00308901 is Normal/Processable. Adding to click candidates. (list_processor.py:228)
2025-05-18 16:00:34 [DEBUG] Evaluating Card MJA: MJA00202045, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 16:00:34 [INFO] Booking MJA00202045 is CANCELLED on list. Saving base info, status, and skipping detail scrape. (list_processor.py:213)
2025-05-18 16:00:34 [INFO] Inserted/Updated base booking record for MJA00202045 with card_status: Cancelled, db_status: cancelled_on_list (repository.py:75)
2025-05-18 16:00:34 [DEBUG] New unprocessed cards (not skipped by session logic) were found on this screen view. Resetting scroll_attempts. (list_processor.py:238)
2025-05-18 16:00:34 [INFO] Found 1 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 16:00:34 [DEBUG] Visibility check for element at y=2078, h=465: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:34 [INFO] Selected card MJA00308901 (Status: Normal) to click. (list_processor.py:130)
2025-05-18 16:00:34 [INFO] Inserted/Updated base booking record for MJA00308901 with card_status: Normal, db_status: pending (repository.py:75)
2025-05-18 16:00:34 [DEBUG] State updated to SECONDARY for session 1 (MJA: MJA00308901, MJR: None, LastProcMJA: MJA00308901) (manager.py:111)
2025-05-18 16:00:34 [INFO] Attempting click on selected card MJA00308901 (list_processor.py:256)
2025-05-18 16:00:34 [INFO] Clicked card MJA00308901 (list_processor.py:258)
2025-05-18 16:00:36 [DEBUG] Processor for LIST finished. State Manager Current State: SECONDARY (crawler_service.py:198)
2025-05-18 16:00:36 [INFO] --- Executing State: SECONDARY (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 16:00:36 [INFO] Processing State: SECONDARY (Display 4619827259835644672, MJA: MJA00308901) (secondary_processor.py:95)
2025-05-18 16:00:36 [DEBUG] Secondary page title is displayed. (secondary_page.py:42)
2025-05-18 16:00:36 [INFO] Confirmed on Secondary Page. (secondary_processor.py:90)
2025-05-18 16:00:36 [DEBUG] --- Parsing Secondary Page XML Targeting Specific Attributes --- (secondary_parser.py:33)
2025-05-18 16:00:36 [DEBUG]   Found MJR content-desc: "MJR00232743, Video Remote Interpreting, Appointments : 1" (secondary_parser.py:48)
2025-05-18 16:00:36 [DEBUG]     Extracted MJR ID: MJR00232743 (secondary_parser.py:49)
2025-05-18 16:00:36 [DEBUG]     Extracted Type Hint: Video Remote Interpreting (secondary_parser.py:61)
2025-05-18 16:00:36 [DEBUG]     Extracted Appt Count: 1 (secondary_parser.py:69)
2025-05-18 16:00:36 [DEBUG]   Found MJB ID in text: MJB00244280 (secondary_parser.py:90)
2025-05-18 16:00:36 [DEBUG] --- Secondary Page Targeted Extraction Finished: {'mjb_id_raw': 'MJB00244280', 'mjr_id_raw': 'MJR00232743', 'appointment_count_hint': 1, 'type_hint_raw': 'Video Remote Interpreting'} --- (secondary_parser.py:98)
2025-05-18 16:00:36 [INFO] Saved XML dump: xml_capture_base/MJA00308901/Secondary/Secondary_MJA00308901_MJB00244280_20250518_160036_728824.xml (xml_dumper.py:65)
2025-05-18 16:00:36 [INFO] Extracted from Secondary XML -> MJB: MJB00244280, MJR: MJR00232743, Appt Count: 1, Type Hint: Video Remote Interpreting (secondary_processor.py:130)
2025-05-18 16:00:36 [INFO] Updated secondary IDs & hints for MJA MJA00308901 (MJR set to MJR00232743) (repository.py:124)
2025-05-18 16:00:36 [DEBUG] Attempting to click MJR link element using XPath: //android.view.ViewGroup[@content-desc and starts-with(@content-desc, "MJR00232743")] (secondary_page.py:99)
2025-05-18 16:00:36 [DEBUG] Clicked MJR link element for MJR00232743. (secondary_page.py:105)
2025-05-18 16:00:38 [DEBUG] State updated to DETAIL for session 1 (MJA: MJA00308901, MJR: MJR00232743, LastProcMJA: MJA00308901) (manager.py:111)
2025-05-18 16:00:38 [DEBUG] Processor for SECONDARY finished. State Manager Current State: DETAIL (crawler_service.py:198)
2025-05-18 16:00:38 [INFO] --- Executing State: DETAIL (Fresh List View Flag for LIST state: N/A) --- (crawler_service.py:151)
2025-05-18 16:00:38 [INFO] Processing State: DETAIL (Display 4619827259835644672, MJA_trigger: MJA00308901, MJR: MJR00232743) (detail_processor.py:94)
2025-05-18 16:00:38 [DEBUG] Waiting up to 10s for detail page title: 'Booking #MJR' (detail_page.py:50)
2025-05-18 16:00:40 [DEBUG] Detail page title is displayed. (detail_page.py:55)
2025-05-18 16:00:40 [INFO] Successfully confirmed on Detail Page for MJR MJR00232743 (detail_processor.py:98)
2025-05-18 16:00:40 [DEBUG] Header Results: MJR='MJR00232743', Total='£ 64.00', MultiDay=False, LangIdx=4, DateTimeTuple='('05-06-2025 At', '09:45 - 12:00')' (detail_parser.py:129)
2025-05-18 16:00:40 [INFO] Processing Detail for MJR: 'MJR00232743', IsMultiday=False (detail_processor.py:144)
2025-05-18 16:00:40 [INFO] Saved XML dump: xml_capture_base/MJR00232743/Detail_MJR/Detail_MJR_MJR00232743_initial_view_00_20250518_160040_542703.xml (xml_dumper.py:65)
2025-05-18 16:00:40 [DEBUG] Info block scan range: 5 to 10. Processing 5 items: ['SSCS Admin Support Centre', 'Meeting Link', 'Tribunals - SSCS | SSCS Substantive hearing', 'undefined undefined', 'undefined'] (detail_parser.py:147)
2025-05-18 16:00:40 [DEBUG]   Client Name: 'SSCS Admin Support Centre' (detail_parser.py:154)
2025-05-18 16:00:40 [DEBUG]   Found 'Meeting Link'. (detail_parser.py:156)
2025-05-18 16:00:40 [DEBUG]   No valid URL after Meeting Link label. Next: Tribunals - SSCS | SSCS Substantive hearing (detail_parser.py:163)
2025-05-18 16:00:40 [DEBUG]   Booking Type: 'Tribunals - SSCS | SSCS Substantive hearing' (detail_parser.py:184)
2025-05-18 16:00:40 [DEBUG]   Contact Name: 'undefined undefined' (detail_parser.py:190)
2025-05-18 16:00:40 [DEBUG]   Contact Phone: 'undefined' (detail_parser.py:196)
2025-05-18 16:00:40 [DEBUG] Sanitized 'contact_name_raw' from 'undefined undefined' to None. (detail_parser.py:207)
2025-05-18 16:00:40 [DEBUG] Sanitized 'contact_phone_raw' from 'undefined' to None. (detail_parser.py:207)
2025-05-18 16:00:40 [DEBUG] Finished parsing info block: {'language_pair_raw': 'English to Polish', 'client_name_raw': 'SSCS Admin Support Centre', 'address_line1_raw': None, 'address_line2_raw': None, 'booking_type_raw': 'Tribunals - SSCS | SSCS Substantive hearing', 'contact_name_raw': None, 'contact_phone_raw': None, 'distance_raw': None, 'meeting_link_raw': None} (detail_parser.py:208)
2025-05-18 16:00:40 [DEBUG] Found 1 MJA references for potential payment blocks. (detail_parser.py:252)
2025-05-18 16:00:40 [DEBUG]   Extracting payments for MJA MJA00308901 (text index 12) up to text index 21 (detail_parser.py:268)
2025-05-18 16:00:40 [DEBUG] Extracted 1 MJA payment blocks in total. (detail_parser.py:294)
2025-05-18 16:00:40 [INFO] Skipping scroll loop: Disclaimer visible initially or all expected MJA blocks for multiday found. (detail_processor.py:196)
2025-05-18 16:00:40 [INFO] Consolidating all extracted data... (detail_processor.py:209)
2025-05-18 16:00:40 [DEBUG] --- Consolidating and Parsing Detail Data --- (detail_parser.py:333)
2025-05-18 16:00:40 [DEBUG] Final Parsed Detail Data (keys: ['is_multiday', 'mjr_id', 'header_total', 'booking_date', 'start_time', 'end_time', 'duration', 'multiday_date_range', 'multiday_appointment_info', 'mja_id', 'language_pair', 'client_name', 'booking_type', 'contact_name', 'contact_phone', 'meeting_link', 'address', 'travel_distance', 'overall_total', 'notes', 'multiday_payments', 'day_pay_sl', 'day_pay_td', 'day_pay_tt', 'day_pay_aep', 'day_pay_ooh', 'day_pay_urg', 'day_total']) for MJR MJR00232743 (detail_parser.py:483)
2025-05-18 16:00:40 [DEBUG] Final Parsed MJR Data for MJR00232743 (is_multiday: False): {'is_multiday': 0, 'mjr_id': 'MJR00232743', 'header_total': 64.0, 'booking_date': '05-06-2025', 'start_time': '09:45:00', 'end_time': '12:00:00', 'duration': '02:15', 'multiday_date_range': None, 'multiday_appointment_info': None, 'mja_id': 'MJA00308901', 'language_pair': 'English to Polish', 'client_name': 'SSCS Admin Support Centre', 'booking_type': 'Tribunals - SSCS | SSCS Substantive hearing', 'contact_name': None, 'contact_phone': None, 'meeting_link': None, 'address': None, 'travel_distance': None, 'overall_total': 64.0, 'notes': 'DO NOT ATTEND ONSITE: this booking is taking place via video. The venue will contact you with the waiting room link.', 'multiday_payments': None, 'day_pay_sl': 54.0, 'day_pay_td': None, 'day_pay_tt': None, 'day_pay_aep': 10.0, 'day_pay_ooh': None, 'day_pay_urg': None, 'day_total': 64.0}... (detail_processor.py:218)
2025-05-18 16:00:40 [INFO] Processing SINGLE DAY save for MJA: MJA00308901 (MJR: MJR00232743) (detail_processor.py:278)
2025-05-18 16:00:40 [INFO] Saved/Updated details for booking MJA MJA00308901 (MJR: MJR00232743) (repository.py:189)
2025-05-18 16:00:40 [INFO] Navigating back to list page (Detail -> Secondary -> List)... (detail_processor.py:50)
2025-05-18 16:00:40 [DEBUG] Executing first back() command. (detail_processor.py:51)
2025-05-18 16:00:41 [DEBUG] Executing second back() command. (detail_processor.py:52)
2025-05-18 16:00:43 [INFO] Navigation successful: Confirmed back on list page. (detail_processor.py:55)
2025-05-18 16:00:43 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00308901) (manager.py:111)
2025-05-18 16:00:43 [DEBUG] Processor for DETAIL finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 16:00:44 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: True) --- (crawler_service.py:151)
2025-05-18 16:00:44 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: True) (list_processor.py:134)
2025-05-18 16:00:44 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_initial_view_00_20250518_160044_546118.xml (xml_dumper.py:65)
2025-05-18 16:00:44 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:44 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 16:00:44 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:44 [DEBUG] Found 8 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 16:00:44 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 16:00:44 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 16:00:44 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 16:00:44 [DEBUG] Processing content-desc: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:44 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202043): Extracted MJA ID. Original full desc: 'MJA00202043, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202043): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202043): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202043): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202043): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:44 [INFO] MJA Parse (MJA00202043): Final parsed data: {'booking_id': 'MJA00202043', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:44 [DEBUG] Successfully parsed card: MJA00202043, Status: Normal (list_page.py:83)
2025-05-18 16:00:44 [DEBUG] Processing content-desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 16:00:44 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00322089): Extracted MJA ID. Original full desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00322089): Parts after MJA ID: ['10:00 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00322089): Found Duration in part '10:00 to 11:30' (mja_parser.py:72)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00322089): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00322089): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:44 [INFO] MJA Parse (MJA00322089): Final parsed data: {'booking_id': 'MJA00322089', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '11:30', 'calculated_duration_str': '01:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 11:30'} (mja_parser.py:112)
2025-05-18 16:00:44 [DEBUG] Successfully parsed card: MJA00322089, Status: Normal (list_page.py:83)
2025-05-18 16:00:44 [DEBUG] Processing content-desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:44 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:44 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202044): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202044): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202044): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202044): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202044): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:44 [INFO] MJA Parse (MJA00202044): Final parsed data: {'booking_id': 'MJA00202044', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:44 [DEBUG] Successfully parsed card: MJA00202044, Status: Cancelled (list_page.py:83)
2025-05-18 16:00:44 [DEBUG] Processing content-desc: 'MJA00308901, 09:45 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:44 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00308901, 09:45 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00308901): Extracted MJA ID. Original full desc: 'MJA00308901, 09:45 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00308901): Parts after MJA ID: ['09:45 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00308901): Found Duration in part '09:45 to 12:00' (mja_parser.py:72)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00308901): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00308901): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:44 [INFO] MJA Parse (MJA00308901): Final parsed data: {'booking_id': 'MJA00308901', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '09:45', 'end_time_raw': '12:00', 'calculated_duration_str': '02:15', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '09:45 to 12:00'} (mja_parser.py:112)
2025-05-18 16:00:44 [DEBUG] Successfully parsed card: MJA00308901, Status: Normal (list_page.py:83)
2025-05-18 16:00:44 [DEBUG] Processing content-desc: 'Cancelled, MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:44 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:44 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202045): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202045): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202045): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202045): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:44 [DEBUG] MJA Parse (MJA00202045): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:44 [INFO] MJA Parse (MJA00202045): Final parsed data: {'booking_id': 'MJA00202045', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:44 [DEBUG] Successfully parsed card: MJA00202045, Status: Cancelled (list_page.py:83)
2025-05-18 16:00:44 [INFO] Successfully extracted data for 5 cards from list page XML source. (list_page.py:100)
2025-05-18 16:00:44 [INFO] Found data for 5 cards on screen via XML. (list_processor.py:150)
2025-05-18 16:00:44 [DEBUG] Evaluating Card MJA: MJA00202043, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:44 [DEBUG] Card MJA00202043 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:45 [DEBUG] Visibility check for element at y=663, h=99: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:45 [DEBUG] Evaluating Card MJA: MJA00322089, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:45 [DEBUG] Card MJA00322089 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:45 [DEBUG] Visibility check for element at y=916, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:45 [DEBUG] Evaluating Card MJA: MJA00202044, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 16:00:45 [DEBUG] Card MJA00202044 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:45 [DEBUG] Visibility check for element at y=1461, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:45 [DEBUG] Evaluating Card MJA: MJA00308901, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:45 [DEBUG] Card MJA00308901 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:45 [DEBUG] Visibility check for element at y=2078, h=465: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:45 [DEBUG] Evaluating Card MJA: MJA00202045, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 16:00:45 [DEBUG] Card MJA00202045 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:45 [DEBUG] Visibility check for element at y=2623, h=133: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:45 [INFO] Found 0 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 16:00:45 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 16:00:45 [DEBUG] Incremented scroll_attempts to 1 as no new processable cards were found. (list_processor.py:277)
2025-05-18 16:00:45 [INFO] Attempting scroll (current attempt: 1/3) (list_processor.py:297)
2025-05-18 16:00:45 [DEBUG] Using anchor 'MJA00308901' for scroll. (list_processor.py:299)
2025-05-18 16:00:45 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 16:00:45 [DEBUG] Found element containing MJA00308901 to use as scroll anchor. (list_page.py:121)
2025-05-18 16:00:47 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001baec with percent: 0.6 (list_page.py:146)
2025-05-18 16:00:48 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_01_20250518_160048_324053.xml (xml_dumper.py:65)
2025-05-18 16:00:48 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 16:00:48 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 16:00:48 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 16:00:48 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_1.png (crawler_service.py:120)
2025-05-18 16:00:49 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 16:00:49 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_1.png (crawler_service.py:127)
2025-05-18 16:00:49 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 16:00:51 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00308901) (manager.py:111)
2025-05-18 16:00:51 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 16:00:51 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 16:00:51 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 16:00:51 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:51 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 16:00:51 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:52 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 16:00:52 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 16:00:52 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 16:00:52 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 16:00:52 [DEBUG] Processing content-desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 16:00:52 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00322089): Extracted MJA ID. Original full desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00322089): Parts after MJA ID: ['10:00 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00322089): Found Duration in part '10:00 to 11:30' (mja_parser.py:72)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00322089): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00322089): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:52 [INFO] MJA Parse (MJA00322089): Final parsed data: {'booking_id': 'MJA00322089', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '11:30', 'calculated_duration_str': '01:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 11:30'} (mja_parser.py:112)
2025-05-18 16:00:52 [DEBUG] Successfully parsed card: MJA00322089, Status: Normal (list_page.py:83)
2025-05-18 16:00:52 [DEBUG] Processing content-desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:52 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:52 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00202044): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00202044): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00202044): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00202044): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00202044): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:52 [INFO] MJA Parse (MJA00202044): Final parsed data: {'booking_id': 'MJA00202044', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:52 [DEBUG] Successfully parsed card: MJA00202044, Status: Cancelled (list_page.py:83)
2025-05-18 16:00:52 [DEBUG] Processing content-desc: 'MJA00308901, 09:45 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:52 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00308901, 09:45 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00308901): Extracted MJA ID. Original full desc: 'MJA00308901, 09:45 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00308901): Parts after MJA ID: ['09:45 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00308901): Found Duration in part '09:45 to 12:00' (mja_parser.py:72)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00308901): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00308901): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:52 [INFO] MJA Parse (MJA00308901): Final parsed data: {'booking_id': 'MJA00308901', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '09:45', 'end_time_raw': '12:00', 'calculated_duration_str': '02:15', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '09:45 to 12:00'} (mja_parser.py:112)
2025-05-18 16:00:52 [DEBUG] Successfully parsed card: MJA00308901, Status: Normal (list_page.py:83)
2025-05-18 16:00:52 [DEBUG] Processing content-desc: 'Cancelled, MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:52 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:52 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00202045): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00202045): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00202045): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00202045): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:52 [DEBUG] MJA Parse (MJA00202045): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:52 [INFO] MJA Parse (MJA00202045): Final parsed data: {'booking_id': 'MJA00202045', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:52 [DEBUG] Successfully parsed card: MJA00202045, Status: Cancelled (list_page.py:83)
2025-05-18 16:00:52 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 16:00:52 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 16:00:52 [DEBUG] Evaluating Card MJA: MJA00322089, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:52 [DEBUG] Card MJA00322089 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:52 [DEBUG] Visibility check for element at y=761, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:52 [DEBUG] Evaluating Card MJA: MJA00202044, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 16:00:52 [DEBUG] Card MJA00202044 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:52 [DEBUG] Visibility check for element at y=1306, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:52 [DEBUG] Evaluating Card MJA: MJA00308901, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:52 [DEBUG] Card MJA00308901 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:52 [DEBUG] Visibility check for element at y=1923, h=465: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:52 [DEBUG] Evaluating Card MJA: MJA00202045, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 16:00:52 [DEBUG] Card MJA00202045 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:52 [DEBUG] Visibility check for element at y=2468, h=288: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:52 [INFO] Found 0 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 16:00:52 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 16:00:52 [DEBUG] Incremented scroll_attempts to 2 as no new processable cards were found. (list_processor.py:277)
2025-05-18 16:00:52 [INFO] Attempting scroll (current attempt: 2/3) (list_processor.py:297)
2025-05-18 16:00:52 [DEBUG] Using anchor 'MJA00308901' for scroll. (list_processor.py:299)
2025-05-18 16:00:52 [DEBUG] Scrolling down... (list_page.py:109)
2025-05-18 16:00:52 [DEBUG] Found element containing MJA00308901 to use as scroll anchor. (list_page.py:121)
2025-05-18 16:00:54 [DEBUG] Scrolled using elementId: 00000000-0000-0163-ffff-ffff0001baec with percent: 0.6 (list_page.py:146)
2025-05-18 16:00:55 [INFO] Saved XML dump: xml_capture_base/session_1/MJA_list/MJA_list_session_1_scroll_02_20250518_160055_736369.xml (xml_dumper.py:65)
2025-05-18 16:00:55 [DEBUG] Attempting screenshot for display 4619827259835644672 to screenshots/after_scroll_2.png (via /sdcard/appium_temp_screenshot_4619827259835644672.png) (crawler_service.py:98)
2025-05-18 16:00:56 [DEBUG] Executed: adb shell screencap -d 4619827259835644672 -p /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:110)
2025-05-18 16:00:56 [DEBUG] Pulling file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:116)
2025-05-18 16:00:56 [DEBUG] Decoding and saving screenshot to: screenshots/after_scroll_2.png (crawler_service.py:120)
2025-05-18 16:00:56 [DEBUG] Removing temporary file from device: /sdcard/appium_temp_screenshot_4619827259835644672.png (crawler_service.py:124)
2025-05-18 16:00:56 [INFO] Successfully saved screenshot for display 4619827259835644672 to screenshots/after_scroll_2.png (crawler_service.py:127)
2025-05-18 16:00:56 [DEBUG] Waiting after scroll... (list_processor.py:303)
2025-05-18 16:00:58 [DEBUG] State updated to LIST for session 1 (MJA: None, MJR: None, LastProcMJA: MJA00308901) (manager.py:111)
2025-05-18 16:00:58 [DEBUG] Processor for LIST finished. State Manager Current State: LIST (crawler_service.py:198)
2025-05-18 16:00:58 [INFO] --- Executing State: LIST (Fresh List View Flag for LIST state: False) --- (crawler_service.py:151)
2025-05-18 16:00:58 [INFO] Processing State: LIST (Display 4619827259835644672, Initial Entry: False) (list_processor.py:134)
2025-05-18 16:00:58 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:58 [INFO] Getting list page cards using XML parsing... (list_page.py:59)
2025-05-18 16:00:58 [DEBUG] List page container is displayed. (list_page.py:39)
2025-05-18 16:00:59 [DEBUG] Found 7 potential card nodes via XPath on XML source (ViewGroup with content-desc). (list_page.py:72)
2025-05-18 16:00:59 [DEBUG] Processing content-desc: 'All' (list_page.py:77)
2025-05-18 16:00:59 [DEBUG] MJA Parse: Starting parsing for desc_str: 'All' (mja_parser.py:26)
2025-05-18 16:00:59 [WARNING] MJA Parse: No MJA ID found in segment: 'All' (Original full desc: 'All') (mja_parser.py:40)
2025-05-18 16:00:59 [DEBUG] Processing content-desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (list_page.py:77)
2025-05-18 16:00:59 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00322089): Extracted MJA ID. Original full desc: 'MJA00322089, 10:00 to 11:30, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00322089): Parts after MJA ID: ['10:00 to 11:30', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00322089): Found Duration in part '10:00 to 11:30' (mja_parser.py:72)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00322089): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00322089): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:59 [INFO] MJA Parse (MJA00322089): Final parsed data: {'booking_id': 'MJA00322089', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '10:00', 'end_time_raw': '11:30', 'calculated_duration_str': '01:30', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '10:00 to 11:30'} (mja_parser.py:112)
2025-05-18 16:00:59 [DEBUG] Successfully parsed card: MJA00322089, Status: Normal (list_page.py:83)
2025-05-18 16:00:59 [DEBUG] Processing content-desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:59 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:59 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00202044): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202044, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00202044): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00202044): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00202044): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00202044): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:59 [INFO] MJA Parse (MJA00202044): Final parsed data: {'booking_id': 'MJA00202044', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:59 [DEBUG] Successfully parsed card: MJA00202044, Status: Cancelled (list_page.py:83)
2025-05-18 16:00:59 [DEBUG] Processing content-desc: 'MJA00308901, 09:45 to 12:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:59 [DEBUG] MJA Parse: Starting parsing for desc_str: 'MJA00308901, 09:45 to 12:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00308901): Extracted MJA ID. Original full desc: 'MJA00308901, 09:45 to 12:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00308901): Parts after MJA ID: ['09:45 to 12:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00308901): Found Duration in part '09:45 to 12:00' (mja_parser.py:72)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00308901): No postcode found, inferred isRemote=1. (mja_parser.py:95)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00308901): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:59 [INFO] MJA Parse (MJA00308901): Final parsed data: {'booking_id': 'MJA00308901', 'card_status': <BookingCardStatus.NORMAL: 'Normal'>, 'postcode': None, 'start_time_raw': '09:45', 'end_time_raw': '12:00', 'calculated_duration_str': '02:15', 'language_pair': 'English to Polish', 'isRemote': 1, 'original_duration_str': '09:45 to 12:00'} (mja_parser.py:112)
2025-05-18 16:00:59 [DEBUG] Successfully parsed card: MJA00308901, Status: Normal (list_page.py:83)
2025-05-18 16:00:59 [DEBUG] Processing content-desc: 'Cancelled, MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (list_page.py:77)
2025-05-18 16:00:59 [DEBUG] MJA Parse: Starting parsing for desc_str: 'Cancelled, MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:26)
2025-05-18 16:00:59 [INFO] MJA Parse: Found card status 'Cancelled' (Prefix: 'Cancelled,'). Remaining desc for MJA ID: 'MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:35)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00202045): Extracted MJA ID. Original full desc: 'Cancelled, MJA00202045, LS1 2RP, 10:00 to 16:00, English to Polish' (mja_parser.py:44)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00202045): Parts after MJA ID: ['LS1 2RP', '10:00 to 16:00', 'English to Polish'] (mja_parser.py:50)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00202045): Found Duration in part '10:00 to 16:00' (mja_parser.py:72)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00202045): Found Postcode in part 'LS1 2RP' -> LS1 2RP (mja_parser.py:90)
2025-05-18 16:00:59 [DEBUG] MJA Parse (MJA00202045): Assigned Language Pair: 'English to Polish' from remaining: ['English to Polish'] (mja_parser.py:100)
2025-05-18 16:00:59 [INFO] MJA Parse (MJA00202045): Final parsed data: {'booking_id': 'MJA00202045', 'card_status': <BookingCardStatus.CANCELLED: 'Cancelled'>, 'postcode': 'LS1 2RP', 'start_time_raw': '10:00', 'end_time_raw': '16:00', 'calculated_duration_str': '06:00', 'language_pair': 'English to Polish', 'isRemote': 0, 'original_duration_str': '10:00 to 16:00'} (mja_parser.py:112)
2025-05-18 16:00:59 [DEBUG] Successfully parsed card: MJA00202045, Status: Cancelled (list_page.py:83)
2025-05-18 16:00:59 [INFO] Successfully extracted data for 4 cards from list page XML source. (list_page.py:100)
2025-05-18 16:00:59 [INFO] Found data for 4 cards on screen via XML. (list_processor.py:150)
2025-05-18 16:00:59 [DEBUG] Evaluating Card MJA: MJA00322089, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:59 [DEBUG] Card MJA00322089 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:59 [DEBUG] Visibility check for element at y=663, h=351: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:59 [DEBUG] Evaluating Card MJA: MJA00202044, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 16:00:59 [DEBUG] Card MJA00202044 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:59 [DEBUG] Visibility check for element at y=1095, h=464: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:59 [DEBUG] Evaluating Card MJA: MJA00308901, Parsed List Status: Normal (list_processor.py:169)
2025-05-18 16:00:59 [DEBUG] Card MJA00308901 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:59 [DEBUG] Visibility check for element at y=1712, h=465: FullyVis=True (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:59 [DEBUG] Evaluating Card MJA: MJA00202045, Parsed List Status: Cancelled (list_processor.py:169)
2025-05-18 16:00:59 [DEBUG] Card MJA00202045 already in session_clicked_mja_ids. Skipping for click. (list_processor.py:175)
2025-05-18 16:00:59 [DEBUG] Visibility check for element at y=2257, h=464: FullyVis=False (Bounds:449-2543) (list_processor.py:79)
2025-05-18 16:00:59 [INFO] Found 0 'Normal' (or processable) cards for potential click. (list_processor.py:241)
2025-05-18 16:00:59 [INFO] No suitable card was selected to click on this screen view. (list_processor.py:273)
2025-05-18 16:00:59 [DEBUG] Incremented scroll_attempts to 3 as no new processable cards were found. (list_processor.py:277)
2025-05-18 16:00:59 [INFO] Max scroll attempts (3) reached without finding new items to click or process. Finishing. (list_processor.py:282)
2025-05-18 16:00:59 [INFO] Scrape session 1 finished with status: error. Total scraped: 13, Total errors: 0. (manager.py:133)
2025-05-18 16:00:59 [DEBUG] Processor for LIST finished. State Manager Current State: ERROR (crawler_service.py:198)
2025-05-18 16:00:59 [ERROR] Processor for LIST set ERROR state. Current booking: None (crawler_service.py:201)
2025-05-18 16:00:59 [INFO] Crawler run loop finished. Final state: ERROR (crawler_service.py:222)
2025-05-18 16:00:59 [INFO] Cleaning up crawler resources... (crawler_service.py:226)
2025-05-18 16:00:59 [INFO] Appium session closed. (crawler_service.py:228)
2025-05-18 16:00:59 [INFO] Database connection closed. (connection.py:98)
2025-05-18 16:00:59 [INFO] Crawler cleanup finished. (crawler_service.py:233)
2025-05-18 16:00:59 [INFO] Ensuring cleanup in main's finally block. (main.py:21)
2025-05-18 16:00:59 [INFO] --- Booking Crawler Application Finished --- (main.py:22)
